!function(factory){"use strict";"function"==typeof define&&(define.cmd||define.cmd)?define("component/dialog/jquery.dialog",["jquery"],factory):factory("undefined"!=typeof jQuery?jQuery:window.Zepto)}(function(){function dialog(content,options){var _self=this;$.isPlainObject(content)&&(options=content)&&(content=null);var _options=$.extend({},dialog._options,options),_cache=dialog.cache.get(_options.cache);if(_cache)_self=_cache,_self._options=_options;else{if(!(this instanceof dialog))return new dialog(content,options);_self._options=_options,_self.frameElement=$(dialog._tpl.frame).addClass(_self._options.style),_self.mainElement=$(dialog._tpl.main).appendTo(_self.frameElement),_self.mixedElement=$(dialog._tpl.mixed).appendTo(_self.frameElement),_self.utilElement=$(dialog._tpl.util).appendTo(_self.mixedElement),_self.borderElement=_self.mainElement.children(".dialog-border"),_self.contElement=$(dialog._tpl.cont).appendTo(_self.borderElement.find(".dialog-border-inner")),_self.headElement=$(dialog._tpl.head).appendTo(_self.contElement),_self.bodyElement=$(dialog._tpl.body).appendTo(_self.contElement),_self.setButton(_self._options.button),_self._appendToElement=docTop.find("body"),_self.frameElement.appendTo(_self._appendToElement),_self.frameElement.mousedown(function(){_self._isToper&&_self.toper(!0)})}return _self.frameElement.css({display:"block",left:-9999,top:-9999}),_self.content(_self._options.content||content),_self.title(_self._options.title),_self._options.close?(_self._closeElement&&_self._closeElement.remove(),_self._closeElement=$(dialog._tpl.close).appendTo(_self.headElement),_self._closeElement.html(_self._options.close),_self._closeElement.click(function(){_self.close()}).mousedown(function(event){event.stopPropagation()})):_self._closeElement&&_self._closeElement.remove(),_self.toper(_self._options.toper),_self.position(_self._options.position),_self.width(_self._options.width),_self.height(_self._options.height),_self.drag(_self._options.drag),_self.mask(_self._options.mask),_self.zIndex(_self._options.zIndex),_self.offset(_self._options.offset[0],_self._options.offset[1]),_self.frameElement.hide()&&_self._options.show&&_self.open(),_cache||(_self._options.cache&&dialog.cache.set(_self._options.cache,_self),$.isFunction(_self._options.onCreate)&&_self._options.onCreate.call(_self),$.isFunction($.dialog.onCreate)&&$.dialog.onCreate.call(_self)),_self}var win=window,winTop=$(win.top||win),docTop=$(win.top.document);dialog.prototype.setButton=function(button){if(button.length){this.footElement||(this.footElement=$('<div class="dialog-foot"></div>'),this.bodyElement.after(this.footElement));for(var i=0;i<button.length;i++)if($.isFunction(button[i])){var _btn=button[i].call(this);this.footElement.append(_btn)}else if($.isPlainObject(button[i])){var _btn=$('<button type="button">'+button[i].text+"</button>").addClass(button[i].cls);this.footElement.append(_btn),$.isFunction(button[i].callback)&&button[i].callback.call(this,_btn)}}},dialog.prototype.content=function(content){return arguments.length?((content||0===content||""===content)&&(content=$.isFunction(content)?content.call(this):content,this._content=this.contentEle=$('<div class="dialog-content"></div>').append(content),this.contentEle.data("dialog",this),this.bodyElement.empty().append(this.contentEle)),this):this.bodyElement},dialog.prototype.title=function(title){return arguments.length?((title||0===title||""===title)&&(this.titleElement||(this.titleElement=$(dialog._tpl.title).appendTo(this.headElement)),this._title=title,this.titleElement.empty().append(this._title)),this):this._title},dialog.prototype.offset=function(x,y){if(!arguments.length)return this._offset;var _x=dialog.translated($.isFunction(x)?x.call(this.frameElement):x),_y=dialog.translated($.isFunction(y)?y.call(this.frameElement):y);return"string"==typeof _x&&(0==_x.indexOf("!")?_x=_x.indexOf("%")>=0?(docTop.width()-this.frameElement.outerWidth())*(Math.max(parseInt(_x.substr(1)),0)/100):Math.max(parseInt(_x),0):(_x.indexOf("%")>=0&&(_x=(winTop.width()-this.frameElement.outerWidth())*(Math.max(parseInt(_x),0)/100)),"absolute"==this._positoin&&(_x=Math.max(parseInt(_x),0)+docTop.scrollLeft()))),"string"==typeof _y&&(0==_y.indexOf("!")?_y=_y.indexOf("%")>=0?(docTop.height()-this.frameElement.outerHeight())*(Math.max(parseInt(_y.substr(1)),0)/100):Math.max(parseInt(_y),0):(_y.indexOf("%")>=0&&(_y=(winTop.height()-this.frameElement.outerHeight())*(Math.max(parseInt(_y),0)/100)),"absolute"==this._positoin&&(_y=Math.max(parseInt(_y),0)+docTop.scrollTop()))),(isNaN(parseInt(_x))||0>_x)&&(_x=this._offset?this._offset.left:0),(isNaN(parseInt(_y))||0>_y)&&(_y=this._offset?this._offset.top:0),this._offset={left:_x,top:_y},this.frameElement.css({left:this._offset.left,top:this._offset.top}),this},dialog.prototype.position=function(){var _positoinType=["absolute","fixed"];return function(position){return arguments.length?($.inArray(position,_positoinType)<=0&&(position=_positoinType[0]),this._positoin=position,this.frameElement.css("position",this._positoin),this):this._positoin}}(),dialog.prototype.drag=function(status){return arguments.length?(this._isDrag=!!status,this._isDrag?(dialog.drag(this),this.frameElement.addClass("think-dialog-drag")):this.frameElement.removeClass("think-dialog-drag"),this):this._isDrag},dialog.prototype.width=function(number){if(!arguments.length)return this.frameElement.width();var _number=parseInt(number);return isNaN(_number)?(this.frameElement.width("auto"),this.borderElement.css("width","auto")):("string"==typeof number&&number.indexOf("%")>=0&&(_number+="%"),this.frameElement.css("width",number),this.borderElement.css("width","100%")),this},dialog.prototype.height=function(number){if(!arguments.length)return this.frameElement.height();var _number=parseInt(number);if(isNaN(_number))this.frameElement.height("auto"),this.contElement.height("auto"),this.bodyElement.height("auto");else{"string"==typeof number&&number.indexOf("%")>=0&&(_number+="%"),this.frameElement.css("height",number);var _contParent=this.contElement.parent(),_contHeight=_contParent.height();this.contElement.add(_contParent).height(_contHeight),this.bodyElement.height(function(i,n){var _h=n;return $(this).siblings().each(function(){_h=_contHeight-$(this).outerHeight()}),_h})}return this},dialog.prototype.zIndex=function(number){if(!arguments.length)return this._zIndex;var _zIndex=parseInt(number);return isNaN(_zIndex)||(this._zIndex=_zIndex,dialog.zIndex=Math.max(this._zIndex,dialog.zIndex)),this.frameElement.css("zIndex",this._zIndex),this._markElement&&this._markElement.css("zIndex",this._zIndex-1),this},dialog.prototype.toper=function(status){return arguments.length?(this._isToper=!!status,this._isToper&&this.zIndex(dialog.zIndex+=2),this):this._isToper},dialog.prototype.mask=function(status){var _self=this;return arguments.length?(status&&!this._markElement&&(this._markElement=$(dialog._tpl.mask).appendTo(this._appendToElement),this._markElement.opacity=this._markElement.css("opacity"),this._markElement.click(function(){_self._options.maskClose&&_self.close()})),this._isMask=!!status,this):this._isMask},dialog.prototype.open=function(action){var _self=this;return this.isOpen||(this.isOpen=!0,$.isFunction(_self._options.onBeforeOpen)&&_self._options.onBeforeOpen.call(_self,action),dialog.effect[this._options.effect].open.call(this,function(){$.isFunction(_self._options.onOpen)&&_self._options.onOpen.call(_self,action)}),this._isMask&&this._markElement&&this._markElement.fadeTo(300,this._markElement.opacity)),this},dialog.prototype.close=function(action){var _self=this,_arguments=arguments;return this.isOpen&&(this.isOpen=!1,dialog.effect[this._options.effect].close.call(this,function(){$.isFunction(_self._options.onClose)&&_self._options.onClose.apply(_self,_arguments),_self._options.cache||_self.destroy(),$.isFunction(action)&&action.call(_self)}),this._isMask&&this._markElement&&this._markElement.fadeTo(300,0,function(){$(this).hide()})),this},dialog.prototype.destroy=function(){dialog.cache.del(this._options.cache),this.content().children("iframe.dialog-iframe").length&&(this._options.content[0].contentWindow.document.write(""),this._options.content[0].contentWindow.close(),this._options.content.remove()),this.frameElement.remove(),this._markElement&&this._markElement.remove();for(var i in this)delete this[i]},dialog.cache=function(){var _cacheList=win.top.__THINKCACHE__=$.isPlainObject(win.top.__THINKCACHE__)?win.top.__THINKCACHE__:{};return{set:function(name,object){"string"==typeof name?_cacheList[name]=object:dialog.isElement(name)&&$(name).data("thinkDialog",object)},del:function(name){"string"==typeof name?delete _cacheList[name]:dialog.isElement(name)&&$(name).removeData("thinkDialog")},get:function(name){return"string"==typeof name?_cacheList[name]:dialog.isElement(name)?$(name).data("thinkDialog"):void 0}}}(),dialog.unselectable=function(element,status){element.each(function(){status?(this.onselectstart=function(){return!1},this.unselectable="on",this.style.MozUserSelect="none",this.style.WebkitUserSelect="none"):(this.onselectstart=function(){return!0},this.unselectable="off",this.style.MozUserSelect="auto",this.style.WebkitUserSelect="auto")})},dialog.drag=function(){var _dragWrap=[];return function(self){var _maxLeft,_maxTop,_x,_y,_mouseX,_mouseY,_self=self,_status=!1;$.inArray(_self,_dragWrap)<0&&(_self.headElement.bind("mousedown.thinkdialog",function(event){_self._isDrag&&(_status=!0,_offset=_self.frameElement.offset(),"fixed"==_self._positoin?(_offset.left-=docTop.scrollLeft(),_offset.top-=docTop.scrollTop(),_maxLeft=Math.max(winTop.width()-_self.frameElement.outerWidth(),0),_maxTop=Math.max(winTop.height()-_self.frameElement.outerHeight(),0)):(_maxLeft=Math.max(docTop[0].documentElement.scrollWidth-_self.frameElement.outerWidth(),0),_maxTop=Math.max(docTop[0].documentElement.scrollHeight-_self.frameElement.outerHeight(),0)),_mouseX=event.pageX-_offset.left,_mouseY=event.pageY-_offset.top,dialog.unselectable(_self._appendToElement.add(_self.frameElement),!0),$.isFunction(_self._options.onDragStart)&&_self._options.onDragStart.call(_self,_mouseX,_mouseY,event))}),docTop.bind("mousemove.thinkdialog",function(event){_self._isDrag&&_status&&(_x=event.pageX-_mouseX,_y=event.pageY-_mouseY,0>_x?_x=0:_x>_maxLeft&&(_x=_maxLeft),0>_y?_y=0:_y>_maxTop&&(_y=_maxTop),_self.frameElement.css({left:_x,top:_y}),$.isFunction(_self._options.onDraging)&&_self._options.onDraging.call(_self,_x,_y,event))}).bind("mouseup.thinkdialog",function(event){_status&&(_status=!1,dialog.unselectable(_self._appendToElement.add(_self.frameElement),!1),$.isFunction(_self._options.onDragEnd)&&_self._options.onDragEnd.call(_self,event))}),_dragWrap.push(dialog))}}(),dialog.isElement=function(element){return!(!element||"object"!=typeof element[0]||!element[0].nodeName)},dialog.translated=function(param){var _table={left:"0%",center:"50%",right:"100%",top:"0%",bottom:"100%"};return"string"==typeof param&&param in _table?_table[param]:param},dialog.zIndex=5555,$.extend($.easing,{easeOutExpo:function(x,t,b,c,d){return t==d?b+c:c*(-Math.pow(2,-10*t/d)+1)+b}}),dialog.effect={visibility:{open:function(callback){return this.frameElement.show(0,callback)},close:function(callback){return this.frameElement.hide(0,callback)}},opacity:{open:function(callback){return this.frameElement.stop(!1,!0).fadeIn(400,callback)},close:function(callback){return this.frameElement.stop(!1,!0).fadeOut(400,callback)}},scroll:{open:function(callback){var _offset=this._offset;if(this.frameElement.css({opacity:1,left:_offset.left,top:_offset.top}).show(),"absolute"==this.position())var _e=this.frameElement.offset().top,_s=$(document).scrollTop()-this.frameElement.outerHeight();else var _e=this.frameElement.offset().top-$(document).scrollTop(),_s=-this.frameElement.outerHeight();this.frameElement.stop(!1,!1).css({top:_s}).animate({top:_e},250,"easeOutExpo",callback)},close:function(callback){var _self=this;if("absolute"==this.position())var _s=this.frameElement.offset().top,_e=$(document).scrollTop()-this.frameElement.outerHeight();else var _s=this.frameElement.offset().top-$(document).scrollTop(),_e=-this.frameElement.outerHeight();this.frameElement.stop(!1,!1).css("top",_s).animate({top:_e,opacity:0},500,"easeOutExpo",function(){_self.isOpen||$(this).hide(),$.isFunction(callback)&&callback()})}}},dialog._options={style:"think-dialog",title:null,content:null,close:"×",drag:!0,width:"auto",height:"auto",position:"absolute",offset:["50%","20%"],mask:!0,maskClose:!0,show:!0,toper:!0,zIndex:null,button:[],cache:null,effect:"scroll",onCreate:null,onOpen:null,onDragStart:null,onDraging:null,onDragEnd:null,onClose:null},dialog._tpl={frame:'<div style="left:0;top:0;"></div>',main:'<div class="dialog-main" style="height: 100%;"><table class="dialog-border" style="border-collapse: collapse; border-spacing:0;height: 100%;"><tr><td class="dialog-border-inner" style="vertical-align: top;"></td></tr></table></div>',mixed:'<div class="dialog-mixed"></div>',util:'<div class="dialog-util"></div>',head:'<div class="dialog-head"></div>',body:'<div class="dialog-body"></div>',cont:'<div class="dialog-wrap"></div>',title:'<strong class="dialog-title"></strong>',close:'<span class="dialog-close"></span>',mask:'<div class="think-dialog-mask" style="display: none;"></div>',loading:"<span><b>&nbsp;</b></span>"},winTop[0].$.dialog||(winTop[0].$.dialog=function(content,options){return new dialog(content,options)},$.extend(winTop[0].$.dialog,{load:function(url,options){var _options=$.extend({style:"think-dialog-load"},options),_dialog=$.dialog.get(_options.cache);if(_dialog)_dialog.open();else{var _content=$(dialog._tpl.loading).addClass("dialog-loading"),_ajax={},_onOpen=_options.onOpen,_isLoaded=!1,_isOpened=!1;_options.onOpen=function(){_isLoaded&&$.isFunction(_options.onComplete)&&_options.onComplete.call(this),_isOpened=!0,$.isFunction(_onOpen)&&_onOpen.call(this)},_dialog=$.dialog(_content,_options),"string"==$.type(url)?_ajax.url=url:$.isPlainObject(url)&&$.extend(_ajax,url);_ajax.success;_ajax.success=function(data){var _data=data;if($.isFunction(_options.praseData)&&(_data=_options.praseData.call(_dialog,_data)),$.isFunction($.dialog.praseData)&&(_data=$.dialog.praseData.call(_dialog,_data)),_data!==!1){_dialog.offset();_dialog.content(_data),_dialog.offset(_dialog._options.offset[0],_dialog._options.offset[1])}$.isFunction(_options.onLoad)&&_options.onLoad.call(_dialog,data),_isOpened&&$.isFunction(_options.onComplete)&&_options.onComplete.call(_dialog),_isLoaded=!0},_ajax.beforeSend=function(){$.isFunction(_options.beforeSend)&&_options.beforeSend.call(_dialog)},$.ajax(_ajax)}return _dialog},iframe:function(src,options){if("string"==$.type(src)){var _dialog=null,_name=(new Date).getTime().toString(),_options=$.extend({style:"think-dialog-iframe"},options),_onDragStart=(_options.onCreate,_options.onDragStart),_onDragEnd=_options.onDragEnd;_options.onCreate;return $.dialog.get(_options.cache)||(_options.content=$('<iframe class="dialog-iframe" name="'+_name+'" src="'+src+'" width="100%" height="100%" frameborder="0" scrolling="no" style="vertical-align: top;"></iframe>'),_options.onCreate=function(){var _self=this;_self.dragMask=$('<div class="dialog-mask" style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; display: none; zIndex: 10; background-color: #fff">&nbsp;</div>').css("opacity",0).appendTo(_self.mixedElement),_self.loading=$(dialog._tpl.loading).addClass("dialog-loading").appendTo(_self.mixedElement),_self._content.load(function(){_self.loading.hide(),$.isFunction(_self._options.onLoad)&&_self._options.onLoad.call(this,_self)})},_options.onDragStart=function(){this.dragMask.css("top",this.headElement.outerHeight()).show(),$.isFunction(_onDragStart)&&_onDragStart.apply(this,arguments)},_options.onDragEnd=function(){this.dragMask.hide(),$.isFunction(_onDragEnd)&&_onDragEnd.apply(this,arguments)}),_dialog=$.dialog(_options),dialog.cache.set(_name,_dialog),_dialog}},success:function(content,callback){var _options={style:"think-dialog-success",content:content,title:null,close:null,time:1500,drag:!1,mask:!1,maskClose:!1,offset:["50%","0"],cache:"success",position:"fixed",onClose:callback,onOpen:function(){var _self=this;setTimeout(function(){_self.close()},_self._options.time)}};return $.isFunction(callback)?_options.onClose=callback:$.extend(_options,callback),$.dialog(_options)},error:function(content,callback){var _options={style:"think-dialog-error",content:content,close:null,title:null,time:1500,drag:!1,mask:!1,maskClose:!1,offset:["50%","0"],cache:"error",position:"fixed",onClose:callback,onOpen:function(){var _self=this;setTimeout(function(){_self.close()},_self._options.time)}};return $.isFunction(callback)?_options.onClose=callback:$.extend(_options,callback),$.dialog(_options)},loading:function(content,callback){return $.dialog({style:"think-dialog-loading",title:null,content:content,close:null,drag:!1,maskClose:!1,mask:!1,cache:"loading",position:"fixed",offset:["50%","0"],onClose:callback})},alert:function(){return function(content,callback){var _callback=callback;return $.dialog({style:"think-dialog-alert",title:"提示",content:content,drag:!1,maskClose:!1,cache:"alert",position:"fixed",onOpen:function(){this.defineElement&&this.defineElement.focus()},onCreate:function(){var _self=this;this.footElement=$('<div class="dialog-foot"></div>'),this.bodyElement.after(this.footElement),this.defineElement=$('<button class="dialog-btn dialog-define" type="button">确定</button>').appendTo(this.footElement),this.defineElement.unbind("click.thinkdialog").bind("click.thinkdialog",function(){_self.close("1"),$.isFunction(_callback)&&_callback(1)})}})}}(),wran:function(){var _callback;return function(content,callback){return _callback=callback,$.dialog({style:"think-dialog-wran",title:"警告",content:content,drag:!1,maskClose:!1,cache:"wran",position:"fixed",onOpen:function(){this.defineElement&&this.defineElement.focus()},onCreate:function(){var _self=this;this.footElement=$('<div class="dialog-foot"></div>'),this.bodyElement.after(this.footElement),this.defineElement=$('<button class="dialog-btn dialog-define" type="button">确定</button>').appendTo(this.footElement),this.defineElement.bind("click.thinkdialog",function(){_self.close("1"),$.isFunction(_callback)&&_callback(1)})}})}}(),confirm:function(){var _callback;return function(content,callback){return _callback=callback,$.dialog(content,{style:"think-dialog-confirm",title:"确定",drag:!1,maskClose:!1,cache:"confirm",position:"fixed",onOpen:function(){this.defineElement&&this.defineElement.focus()},onCreate:function(){var _self=this;this.footElement=$('<div class="dialog-foot"></div>'),this.bodyElement.after(this.footElement),this.defineElement=$('<button class="dialog-btn dialog-define" type="button">确定</button>').appendTo(this.footElement),this.cancelElement=$('<button class="dialog-btn dialog-cancel" type="button">取消</button>').appendTo(this.footElement),this.defineElement.unbind("click.thinkdialog").bind("click.thinkdialog",function(){_self.close("1"),$.isFunction(_callback)&&_callback(1)}),this.cancelElement.unbind("click.thinkdialog").bind("click.thinkdialog",function(){_self.close("2"),$.isFunction(_callback)&&_callback(2)})}})}}(),get:function(param){return dialog.isElement(param)?param.data("dialog"):($.isWindow(param)&&(param=param.name),dialog.cache.get(param))}})),$.dialog=winTop[0].$.dialog,$.fn.dialog=function(options){return this.length?this.each(function(){new dialog($(this),options)}):new dialog(this.selector,options)}}),function(factory){"use strict";"function"==typeof define&&(define.cmd||define.cmd)?define("component/jquery-plugs/jquery.validator",["jquery"],factory):factory("undefined"!=typeof jQuery?jQuery:window.Zepto)}(function(){function validator(options){if(this._options=$.extend(!0,{},validator._config,options),this._validatorRule=$.extend({},validator._rules),validator._bridge(this,"extendRule",this._options.rules),this._validatorData={},this._validatorMap={},this._referQueue={},validator._bridge(this,"createItem",this._options.map),validator._bridge(this,"disabled",this._options.disabled),!validator._instantiation){for(var i in validator)i.indexOf("_")<0&&(validator.prototype[i]=validator[i]);validator._instantiation=!0}$.isFunction(this._options.onCreate)&&this._options.onCreate.call(this),$.isFunction(validator._hook.onCreate)&&validator._hook.onCreate.call(this)}validator._bridge=function(obj,name,param){return name in validator&&$.isFunction(validator[name])?validator[name].apply(obj,Array.prototype.slice.call(arguments,2)):void 0},validator.setRefer=function(item,name){$.isArray(item)||(item=[item]),$.isArray(name)||(name=[name]),name=$.grep(name,function(v,i){return v&&"string"==typeof v});for(var i=0;i<item.length;i++)if(validator._bridge(this,"isItem",item[i])){var _join=item[i].use("get","join");$.isArray(_join)?$.unique(_join,name):_join=name,item[i].use("set","join",name)}},validator.delRefer=function(item,name){$.isArray(item)||(item=[item]),$.isArray(name)||(name=[name]);for(var i=0;i<item.length;i++)if(validator._bridge(this,"isItem",item[i])){var _join=item[i].use("get","join");if($.isArray(_join)){var _arr=$.grep(_join,function(n,i){return $.inArray(n,name)});item[i].use("set","join",_arr)}}},validator.getRefer=function(item){return $.isArray(item)&&(item=item[0]),validator._bridge(this,"isItem",item)?item.use("get","join"):[]},validator.getReferItem=function(item){$.isArray(item)&&(item=item[0]);var _items=[];if(validator._bridge(this,"isItem",item))for(var _joins=validator._bridge(this,"getRefer",item),_jl=_joins.length,j=0;_jl>j;j++)_items=_items.concat(validator._bridge(this,"getItem","."+_joins[j]));return _items},validator.extendRule=function(name,rule){var _obj=name;"string"==typeof _obj&&(_obj={},_obj[name]=rule),$.isPlainObject(_obj)&&$.extend(this._validatorRule,_obj)},validator.createItem=function(item){if(arguments.length){var _list=validator._bridge(this,"_revise",item),_items=[];if($.isArray(_list)){var _length=_list.length;if(_length){this._validatorMap.alone||(this._validatorMap.alone={}),this._validatorMap.many||(this._validatorMap.many={});for(var i=0;_length>i;i++)_list[i]=validator._bridge(this,"_fixture",_list[i]),_list[i].__parent=this,_list[i].__alone={_source:this._validatorMap.alone,_id:_list[i].id},this._validatorMap.alone[_list[i].id]=_list[i],"string"==typeof _list[i].name&&($.isArray(this._validatorMap.many[_list[i].name])||(this._validatorMap.many[_list[i].name]=[]),this._validatorMap.many[_list[i].name].push(_list[i]),_list[i].__many={_source:this._validatorMap.many[_list[i].name],_index:this._validatorMap.many[_list[i].name].length-1}),validator._bridge(this,"setRefer",_list[i],_list[i].join),_items.push(_list[i])}}return _items.length<=1?_items[0]:_items}},validator.removeItem=function(mask){if("string"==typeof mask){var _source=validator._bridge(this,"getItem",mask);if($.isArray(_source)){for(var _length=_source.length,i=_source.length-1;i>=0;i--){var _alone=_source[i].__alone._source,_id=_source[i].__alone._id,_many=_source[i].__many._source,_index=_source[i].__many._index;delete _alone[_id],_many.splice(_index,1)}return _length}}},validator.getItem=function(mask){if("string"==typeof mask){var _source=[];return validator._bridge(this,"_getMaskCallback",mask,function(id){for(var i in this._validatorMap.alone)if(this._validatorMap.alone[i].id==id||this._validatorMap.alone[i].__id==id){_source.push(this._validatorMap.alone[i]);break}},function(name){for(var i in this._validatorMap.many)if(i==name){_source=_source.concat(this._validatorMap.many[name]);break}}),_source}},validator.isItem=function(item){var _result=!0;if($.isArray(item)){for(var i=0;i<item.length;i++)if(!(item[i]instanceof validator._fixture)){_result=!1;break}}else _result=item instanceof validator._fixture;return _result},validator.check=function(data,rule){var _data=validator._bridge(this,"_formatData",data,rule),_rule=rule,_status=!0,_result=!0,_isItem=validator._bridge(this,"isItem",_rule),_refers=[],_items=[],_length=0,_total=0;this._validatorData=$.extend(this._validatorData,_data),_rule=_isItem?validator._bridge(this,"_formatRule",rule):this._validatorMap.many;for(var i in _rule){_length=_rule[i].length,_result=!0;for(var j=0;_length>j;j++){_refers=validator._bridge(this,"getReferItem",_rule[i][j]),_items=_refers.concat(_rule[i][j]),_total=_items.length;for(var k=0;_total>k;k++)if(!_items[k].use("check",_data[_items[k].name]||"")){_result=!1,_status=!1;break}if(!_result)break}}return _status},validator._formatData=function(data,rule){var _data=data,_proxy={},_value="";$.isArray(_data)||(_value=_data,_data=[]);for(var i=0;i<_data.length;i++)$.isPlainObject(_data[i])&&"name"in _data[i]&&(_proxy[_data[i].name]?($.isArray(_proxy[_data[i].name])||(_proxy[_data[i].name]=[_proxy[_data[i].name]]),_proxy[_data[i].name].push(_data[i].value)):_proxy[_data[i].name]=_data[i].value);if($.isArray(rule))for(var i=0;i<rule.length;i++)validator._bridge(this,"isItem",rule[i])&&(rule[i].name in _proxy||(_proxy[rule[i].name]=""));else for(var i in this._validatorMap.many)i in _proxy||(_proxy[i]=_value);return _proxy},validator._formatRule=function(rule){for(var _proxy={},_rule=$.isArray(rule)?rule:[rule],i=0;i<_rule.length;i++)validator._bridge(this,"isItem",rule[i])&&(rule[i].name in _proxy||(_proxy[rule[i].name]=[]),_proxy[rule[i].name].push(rule[i]));return _proxy},validator._disabled=function(mask,status){status="undefined"==typeof status?!0:!!status,$.isArray(mask)||(mask=[mask]);for(var _number=0,i=0;i<mask.length;i++)if("string"==typeof mask[i]){var _source=validator._bridge(this,"getItem",mask[i]);if($.isArray(_source))for(var i=(_source.length,0);i<_source.length;i++)_source[i].use("disabled",status),++_number}return _number},validator.disabled=function(mask){return validator._bridge(this,"_disabled",mask,!0)},validator.enable=function(mask){return validator._bridge(this,"_disabled",mask,!1)},validator._getMaskCallback=function(mask,callback1,callback2){if("string"==typeof mask){var _isId=!1,_mask=mask;0==mask.indexOf("#")?(_isId=!0,_mask=_mask.substr(1)):0==mask.indexOf(".")&&(_mask=_mask.substr(1)),_isId?$.isFunction(callback1)&&callback1.call(this,_mask):$.isFunction(callback2)&&callback2.call(this,_mask)}},validator._cumulation=(new Date).getTime(),validator._revise=function(rule,must,type){var i=0,l=0,info=rule;for($.isPlainObject(info)?info=[info]:$.isArray(info)||(info=[{rule:info,must:"undefined"==typeof must?!0:!!must}]),l=info.length;l>i;i++){var _id="__"+validator._cumulation++ +"__";"undefined"==typeof info[i].rule&&(info[i].rule=null),"undefined"==typeof info[i].must&&(info[i].must=!0),"undefined"==typeof info[i].id&&(info[i].id=_id),"undefined"==typeof info[i]._disabled?info[i]._disabled=!1:info[i]._disabled=!!info[i]._disabled,info[i].__id=_id}return info},validator._fixture=function(item){return this instanceof validator._fixture?($.extend(this,item,{_switch:!0}),"use"in this&&(this._use=this.use,delete this.use),void(this.use=function(name,param){var method=name;return Array.prototype.splice.call(arguments,0,1),Array.prototype.unshift.call(arguments,this,"_fixture_"+method),validator._bridge.apply(null,arguments)})):new validator._fixture(item)},validator._fixture_check=function(data){if(!this.use("get","disabled")){if(!(this.must||data&&data.length))return!0;var _result=validator._bridge(this,"__fixture_callback",this.onBefore,data)&&validator._bridge(this,"__fixture_callback",this.__parent._options.onBefore,data)&&validator._bridge(this,"__fixture_callback",validator._hook.onBefore,data);if(_result!==!1){var _rule=this.rule,_params=[],_neg=!1;if(_result=!1,"string"==typeof _rule){var _pattern=_rule.match(/^(\!)?(\w+)?(?:\((.*)?\)$)?/);$.isArray(_pattern)?(_neg=!!_pattern[1],_rule=_pattern[2],_params=_pattern[3]?_pattern[3].split(","):[],_rule in this.__parent._validatorRule?_rule=this.__parent._validatorRule[_rule]:$.error("获取验证方法失败！")):$.error("解析验证规则失败！")}_params.unshift(data),$.isFunction(_rule)&&(_result=_rule.apply(this,_params),_neg&&(_result=!_result))}else _result=!1;return validator._bridge(this,"__fixture_callback",this.onAfter,_result,data)&&validator._bridge(this,"__fixture_callback",this.__parent._options.onAfter,_result,data)&&validator._bridge(this,"__fixture_callback",validator._hook.onAfter,_result,data),_result}},validator._fixture_disabled=function(){return this._disabled=!0,this},validator._fixture_enable=function(){return this._disabled=!1,this},validator._fixture_get=function(name){return"string"==typeof name&&name.indexOf("_")<0&&(name="_"+name,name in this)?this[name]:void 0},validator._fixture_set=function(name,value){return"string"==typeof name&&name.indexOf("_")<0&&(this["_"+name]=value),this},validator.__fixture_callback=function(callback,params){return!$.isFunction(callback)||callback.apply(this,Array.prototype.slice.call(arguments,1))!==!1},validator._instantiation=!1,validator._config={map:null,disabled:null,onBefore:null,onAfter:null,rules:null},validator._hook={onBefore:null,onAfter:null,onCreate:null},validator._rules={numeric:function(data){return $.isNumeric(data)},require:function(data){return/[^\s]+/.test(data)},empty:function(data){return/^[\s]+$/.test(data)},mobile:function(data){return/^(((13[0-9]{1})|(15[0-9]{1}))+d{8})$/.test(data)},tel:function(data){return/^\d{3,4}-?\d{7,9}$/.test(data)},zipCode:function(data){return/^[0-9]{6}$/.test(data)},cn:function(data){return/^[\u4e00-\u9fa5]+$/.test(data)},email:function(data){return/[\w!#$%&'*+\/=?^_`{|}~-]+(?:\.[\w!#$%&'*+\/=?^_`{|}~-]+)*@(?:[\w](?:[\w-]*[\w])?\.)+[\w](?:[\w-]*[\w])?/.test(data)},url:function(data){return/[a-zA-z]+:\/\/[^\s]*/.test(data)},qq:function(data){return/[1-9][0-9]{4,}/.test(data)},identity:function(data){return/^(\d{6})(\d{4})(\d{2})(\d{2})(\d{3})([0-9]|X)$/.test(data)},ip:function(data){return/\d+\.\d+\.\d+\.\d+/.test(data)},date:function(data){return/([0-9]{3}[1-9]|[0-9]{2}[1-9][0-9]{1}|[0-9]{1}[1-9][0-9]{2}|[1-9][0-9]{3})-(((0[13578]|1[02])-(0[1-9]|[12][0-9]|3[01]))|((0[469]|11)-(0[1-9]|[12][0-9]|30))|(02-(0[1-9]|[1][0-9]|2[0-8])))/.test(data)},positive:function(data){return/^[1-9]\d*$/.test(data)},negative:function(data){return/^-[1-9]\d*$/.test(data)},pfloat:function(data){return/^[1-9]\d*\.\d*|0\.\d*[1-9]\d*$/.test(data)},nfloat:function(data){return/^-[1-9]\d*\.\d*|-0\.\d*[1-9]\d*$/.test(data)},length:function(data,start,end){var _length=data.length;return"null"==start&&(start=0),"null"==end&&(end=_length),end?_length>=start&&end>=_length:_length==start},equal:function(data,value){return data==value},"in":function(data,range){data=$.isArray(data)?data:[data],range=Array.prototype.slice.call(arguments,1);for(var i=0;i<range.length;i++)for(var j=0;j<data.length;j++)if(range[i]==data[j])return!0;return!1},max:function(data,max){return Number(data)<=Number(max)},min:function(data,min){return Number(data)>=Number(min)},field:function(data,field){return data==(this.__parent._validatorData[field]||"")}},$.validator=function(options){return new validator(options)},$.validator.constructor=validator,$.validator.setConfig=function(options){$.extend(validator._config,options)},$.validator.getConfig=function(name){return"string"==typeof name?validator._config[name]:void 0},$.validator.setHook=function(options){$.extend(validator._config,options)},$.validator.getHook=function(name){return"string"==typeof name?validator._config[name]:void 0}}),function(factory){"use strict";"function"==typeof define&&(define.cmd||define.cmd)?define("component/jquery.drop",["jquery"],factory):factory("undefined"!=typeof jQuery?jQuery:window.Zepto)}(function(){function drop(options){var self=this,entertimer=null,leavetimer=null;this.options=$.extend({},drop.options,options),this.element=this.options.element,this.handler=this.element.find(".drop-show"),this.content=this.element.find(".drop-hide"),"toggle"==this.options.eventType?(this.handler.click(function(){
self._isOpen?self.close():self.open()}),this.element.click(function(event){event.stopPropagation()}),$("body").bind("click",function(){self.close()}).delegate(":text,textarea","focus",function(){self.close()})):(this.handler.add(this.content).mouseenter(function(){clearTimeout(leavetimer),entertimer=setTimeout(function(){self.open()},300)}),this.handler.add(this.content).mouseleave(function(){clearTimeout(entertimer),leavetimer=setTimeout(function(){self.close()},300)})),drop.list.push(this)}drop.list=[],drop.prototype.open=function(){if(!this._isOpen){this.element.addClass("drop-active"),this._isOpen=!0;for(var i=0;i<drop.list.length;i++)drop.list[i]!==this&&drop.list[i].close();$.isFunction(this.options.onOpen)&&this.options.onOpen.call(this)}},drop.prototype.close=function(){this._isOpen&&(this.element.removeClass("drop-active"),this._isOpen=!1,$.isFunction(this.options.onClose)&&this.options.onClose.call(this))},drop.prototype.setConfig=function(options){return $.extend(this.options,options),this},drop.options={element:null,eventType:"toggle",onOpen:null,onClose:null},$.fn.drop=function(options){return this.each(function(){var _drop=$(this).data("THINKDROP");_drop?_drop.setConfig(options):$(this).data("THINKDROP",new drop({element:$(this),eventType:$(this).hasClass("drop-hover")?"hover":"toggle"}))})},$(function(){$(".w-drop").drop()})}),function(factory){"use strict";"function"==typeof define&&(define.cmd||define.cmd)?define("component/jquery.form",["jquery"],factory):factory("undefined"!=typeof jQuery?jQuery:window.Zepto)}(function(){function doAjaxSubmit(e){var options=e.data;e.isDefaultPrevented()||(e.preventDefault(),$(e.target).ajaxSubmit(options))}function captureSubmittingElement(e){var target=e.target,$el=$(target);if(!$el.is("[type=submit],[type=image]")){var t=$el.closest("[type=submit]");if(0===t.length)return;target=t[0]}var form=this;if(form.clk=target,"image"==target.type)if(void 0!==e.offsetX)form.clk_x=e.offsetX,form.clk_y=e.offsetY;else if("function"==typeof $.fn.offset){var offset=$el.offset();form.clk_x=e.pageX-offset.left,form.clk_y=e.pageY-offset.top}else form.clk_x=e.pageX-target.offsetLeft,form.clk_y=e.pageY-target.offsetTop;setTimeout(function(){form.clk=form.clk_x=form.clk_y=null},100)}function log(){if($.fn.ajaxSubmit.debug){var msg="[jquery.form] "+Array.prototype.join.call(arguments,"");window.console&&window.console.log?window.console.log(msg):window.opera&&window.opera.postError&&window.opera.postError(msg)}}var feature={};feature.fileapi=void 0!==$("<input type='file'/>").get(0).files,feature.formdata=void 0!==window.FormData;var hasProp=!!$.fn.prop;$.fn.attr2=function(){if(!hasProp)return this.attr.apply(this,arguments);var val=this.prop.apply(this,arguments);return val&&val.jquery||"string"==typeof val?val:this.attr.apply(this,arguments)},$.fn.ajaxSubmit=function(options){function deepSerialize(extraData){var i,part,serialized=$.param(extraData,options.traditional).split("&"),len=serialized.length,result=[];for(i=0;len>i;i++)serialized[i]=serialized[i].replace(/\+/g," "),part=serialized[i].split("="),result.push([decodeURIComponent(part[0]),decodeURIComponent(part[1])]);return result}function fileUploadXhr(a){for(var formdata=new FormData,i=0;i<a.length;i++)formdata.append(a[i].name,a[i].value);if(options.extraData){var serializedData=deepSerialize(options.extraData);for(i=0;i<serializedData.length;i++)serializedData[i]&&formdata.append(serializedData[i][0],serializedData[i][1])}options.data=null;var s=$.extend(!0,{},$.ajaxSettings,options,{contentType:!1,processData:!1,cache:!1,type:method||"POST"});options.uploadProgress&&(s.xhr=function(){var xhr=$.ajaxSettings.xhr();return xhr.upload&&xhr.upload.addEventListener("progress",function(event){var percent=0,position=event.loaded||event.position,total=event.total;event.lengthComputable&&(percent=Math.ceil(position/total*100)),options.uploadProgress(event,position,total,percent)},!1),xhr}),s.data=null;var beforeSend=s.beforeSend;return s.beforeSend=function(xhr,o){options.formData?o.data=options.formData:o.data=formdata,beforeSend&&beforeSend.call(this,xhr,o)},$.ajax(s)}function fileUploadIframe(a){function getDoc(frame){var doc=null;try{frame.contentWindow&&(doc=frame.contentWindow.document)}catch(err){log("cannot get iframe.contentWindow document: "+err)}if(doc)return doc;try{doc=frame.contentDocument?frame.contentDocument:frame.document}catch(err){log("cannot get iframe.contentDocument: "+err),doc=frame.document}return doc}function doSubmit(){function checkState(){try{var state=getDoc(io).readyState;log("state = "+state),state&&"uninitialized"==state.toLowerCase()&&setTimeout(checkState,50)}catch(e){log("Server abort: ",e," (",e.name,")"),cb(SERVER_ABORT),timeoutHandle&&clearTimeout(timeoutHandle),timeoutHandle=void 0}}var t=$form.attr2("target"),a=$form.attr2("action"),mp="multipart/form-data",et=$form.attr("enctype")||$form.attr("encoding")||mp;form.setAttribute("target",id),method&&!/post/i.test(method)||form.setAttribute("method","POST"),a!=s.url&&form.setAttribute("action",s.url),s.skipEncodingOverride||method&&!/post/i.test(method)||$form.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"}),s.timeout&&(timeoutHandle=setTimeout(function(){timedOut=!0,cb(CLIENT_TIMEOUT_ABORT)},s.timeout));var extraInputs=[];try{if(s.extraData)for(var n in s.extraData)s.extraData.hasOwnProperty(n)&&($.isPlainObject(s.extraData[n])&&s.extraData[n].hasOwnProperty("name")&&s.extraData[n].hasOwnProperty("value")?extraInputs.push($('<input type="hidden" name="'+s.extraData[n].name+'">').val(s.extraData[n].value).appendTo(form)[0]):extraInputs.push($('<input type="hidden" name="'+n+'">').val(s.extraData[n]).appendTo(form)[0]));s.iframeTarget||$io.appendTo("body"),io.attachEvent?io.attachEvent("onload",cb):io.addEventListener("load",cb,!1),setTimeout(checkState,15);try{form.submit()}catch(err){var submitFn=document.createElement("form").submit;submitFn.apply(form)}}finally{form.setAttribute("action",a),form.setAttribute("enctype",et),t?form.setAttribute("target",t):$form.removeAttr("target"),$(extraInputs).remove()}}function cb(e){if(!xhr.aborted&&!callbackProcessed){if(doc=getDoc(io),doc||(log("cannot access response document"),e=SERVER_ABORT),e===CLIENT_TIMEOUT_ABORT&&xhr)return xhr.abort("timeout"),void deferred.reject(xhr,"timeout");if(e==SERVER_ABORT&&xhr)return xhr.abort("server abort"),void deferred.reject(xhr,"error","server abort");if(doc&&doc.location.href!=s.iframeSrc||timedOut){io.detachEvent?io.detachEvent("onload",cb):io.removeEventListener("load",cb,!1);var errMsg,status="success";try{if(timedOut)throw"timeout";var isXml="xml"==s.dataType||doc.XMLDocument||$.isXMLDoc(doc);if(log("isXml="+isXml),!isXml&&window.opera&&(null===doc.body||!doc.body.innerHTML)&&--domCheckCount)return log("requeing onLoad callback, DOM not available"),void setTimeout(cb,250);var docRoot=doc.body?doc.body:doc.documentElement;xhr.responseText=docRoot?docRoot.innerHTML:null,xhr.responseXML=doc.XMLDocument?doc.XMLDocument:doc,isXml&&(s.dataType="xml"),xhr.getResponseHeader=function(header){var headers={"content-type":s.dataType};return headers[header.toLowerCase()]},docRoot&&(xhr.status=Number(docRoot.getAttribute("status"))||xhr.status,xhr.statusText=docRoot.getAttribute("statusText")||xhr.statusText);var dt=(s.dataType||"").toLowerCase(),scr=/(json|script|text)/.test(dt);if(scr||s.textarea){var ta=doc.getElementsByTagName("textarea")[0];if(ta)xhr.responseText=ta.value,xhr.status=Number(ta.getAttribute("status"))||xhr.status,xhr.statusText=ta.getAttribute("statusText")||xhr.statusText;else if(scr){var pre=doc.getElementsByTagName("pre")[0],b=doc.getElementsByTagName("body")[0];pre?xhr.responseText=pre.textContent?pre.textContent:pre.innerText:b&&(xhr.responseText=b.textContent?b.textContent:b.innerText)}}else"xml"==dt&&!xhr.responseXML&&xhr.responseText&&(xhr.responseXML=toXml(xhr.responseText));try{data=httpData(xhr,dt,s)}catch(err){status="parsererror",xhr.error=errMsg=err||status}}catch(err){log("error caught: ",err),status="error",xhr.error=errMsg=err||status}xhr.aborted&&(log("upload aborted"),status=null),xhr.status&&(status=xhr.status>=200&&xhr.status<300||304===xhr.status?"success":"error"),"success"===status?(s.success&&s.success.call(s.context,data,"success",xhr),deferred.resolve(xhr.responseText,"success",xhr),g&&$.event.trigger("ajaxSuccess",[xhr,s])):status&&(void 0===errMsg&&(errMsg=xhr.statusText),s.error&&s.error.call(s.context,xhr,status,errMsg),deferred.reject(xhr,"error",errMsg),g&&$.event.trigger("ajaxError",[xhr,s,errMsg])),g&&$.event.trigger("ajaxComplete",[xhr,s]),g&&!--$.active&&$.event.trigger("ajaxStop"),s.complete&&s.complete.call(s.context,xhr,status),callbackProcessed=!0,s.timeout&&clearTimeout(timeoutHandle),setTimeout(function(){s.iframeTarget?$io.attr("src",s.iframeSrc):$io.remove(),xhr.responseXML=null},100)}}}var el,i,s,g,id,$io,io,xhr,sub,n,timedOut,timeoutHandle,form=$form[0],deferred=$.Deferred();if(deferred.abort=function(status){xhr.abort(status)},a)for(i=0;i<elements.length;i++)el=$(elements[i]),hasProp?el.prop("disabled",!1):el.removeAttr("disabled");if(s=$.extend(!0,{},$.ajaxSettings,options),s.context=s.context||s,id="jqFormIO"+(new Date).getTime(),s.iframeTarget?($io=$(s.iframeTarget),n=$io.attr2("name"),n?id=n:$io.attr2("name",id)):($io=$('<iframe name="'+id+'" src="'+s.iframeSrc+'" />'),$io.css({position:"absolute",top:"-1000px",left:"-1000px"})),io=$io[0],xhr={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(status){var e="timeout"===status?"timeout":"aborted";log("aborting upload... "+e),this.aborted=1;try{io.contentWindow.document.execCommand&&io.contentWindow.document.execCommand("Stop")}catch(ignore){}$io.attr("src",s.iframeSrc),xhr.error=e,s.error&&s.error.call(s.context,xhr,e,status),g&&$.event.trigger("ajaxError",[xhr,s,e]),s.complete&&s.complete.call(s.context,xhr,e)}},g=s.global,g&&0===$.active++&&$.event.trigger("ajaxStart"),g&&$.event.trigger("ajaxSend",[xhr,s]),s.beforeSend&&s.beforeSend.call(s.context,xhr,s)===!1)return s.global&&$.active--,deferred.reject(),deferred;if(xhr.aborted)return deferred.reject(),deferred;sub=form.clk,sub&&(n=sub.name,n&&!sub.disabled&&(s.extraData=s.extraData||{},s.extraData[n]=sub.value,"image"==sub.type&&(s.extraData[n+".x"]=form.clk_x,s.extraData[n+".y"]=form.clk_y)));var CLIENT_TIMEOUT_ABORT=1,SERVER_ABORT=2,csrf_token=$("meta[name=csrf-token]").attr("content"),csrf_param=$("meta[name=csrf-param]").attr("content");csrf_param&&csrf_token&&(s.extraData=s.extraData||{},s.extraData[csrf_param]=csrf_token),s.forceSync?doSubmit():setTimeout(doSubmit,10);var data,doc,callbackProcessed,domCheckCount=50,toXml=$.parseXML||function(s,doc){return window.ActiveXObject?(doc=new ActiveXObject("Microsoft.XMLDOM"),doc.async="false",doc.loadXML(s)):doc=(new DOMParser).parseFromString(s,"text/xml"),doc&&doc.documentElement&&"parsererror"!=doc.documentElement.nodeName?doc:null},parseJSON=$.parseJSON||function(s){return window.eval("("+s+")")},httpData=function(xhr,type,s){var ct=xhr.getResponseHeader("content-type")||"",xml="xml"===type||!type&&ct.indexOf("xml")>=0,data=xml?xhr.responseXML:xhr.responseText;return xml&&"parsererror"===data.documentElement.nodeName&&$.error&&$.error("parsererror"),s&&s.dataFilter&&(data=s.dataFilter(data,type)),"string"==typeof data&&("json"===type||!type&&ct.indexOf("json")>=0?data=parseJSON(data):("script"===type||!type&&ct.indexOf("javascript")>=0)&&$.globalEval(data)),data};return deferred}if(!this.length)return log("ajaxSubmit: skipping submit process - no element selected"),this;var method,action,url,$form=this;"function"==typeof options?options={success:options}:void 0===options&&(options={}),method=options.type||this.attr2("method"),action=options.url||this.attr2("action"),url="string"==typeof action?$.trim(action):"",url=url||window.location.href||"",url&&(url=(url.match(/^([^#]+)/)||[])[1]),options=$.extend(!0,{url:url,success:$.ajaxSettings.success,type:method||$.ajaxSettings.type,iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},options);var veto={};if(this.trigger("form-pre-serialize",[this,options,veto]),veto.veto)return log("ajaxSubmit: submit vetoed via form-pre-serialize trigger"),this;if(options.beforeSerialize&&options.beforeSerialize(this,options)===!1)return log("ajaxSubmit: submit aborted via beforeSerialize callback"),this;var traditional=options.traditional;void 0===traditional&&(traditional=$.ajaxSettings.traditional);var qx,elements=[],a=this.formToArray(options.semantic,elements);if(options.data&&(options.extraData=options.data,qx=$.param(options.data,traditional)),options.beforeSubmit&&options.beforeSubmit(a,this,options)===!1)return log("ajaxSubmit: submit aborted via beforeSubmit callback"),this;if(this.trigger("form-submit-validate",[a,this,options,veto]),veto.veto)return log("ajaxSubmit: submit vetoed via form-submit-validate trigger"),this;var q=$.param(a,traditional);qx&&(q=q?q+"&"+qx:qx),"GET"==options.type.toUpperCase()?(options.url+=(options.url.indexOf("?")>=0?"&":"?")+q,options.data=null):options.data=q;var callbacks=[];if(options.resetForm&&callbacks.push(function(){$form.resetForm()}),options.clearForm&&callbacks.push(function(){$form.clearForm(options.includeHidden)}),!options.dataType&&options.target){var oldSuccess=options.success||function(){};callbacks.push(function(data){var fn=options.replaceTarget?"replaceWith":"html";$(options.target)[fn](data).each(oldSuccess,arguments)})}else options.success&&callbacks.push(options.success);if(options.success=function(data,status,xhr){for(var context=options.context||this,i=0,max=callbacks.length;max>i;i++)callbacks[i].apply(context,[data,status,xhr||$form,$form])},options.error){var oldError=options.error;options.error=function(xhr,status,error){var context=options.context||this;oldError.apply(context,[xhr,status,error,$form])}}if(options.complete){var oldComplete=options.complete;options.complete=function(xhr,status){var context=options.context||this;oldComplete.apply(context,[xhr,status,$form])}}var fileInputs=$("input[type=file]:enabled",this).filter(function(){return""!==$(this).val()}),hasFileInputs=fileInputs.length>0,mp="multipart/form-data",multipart=$form.attr("enctype")==mp||$form.attr("encoding")==mp,fileAPI=feature.fileapi&&feature.formdata;log("fileAPI :"+fileAPI);var jqxhr,shouldUseFrame=(hasFileInputs||multipart)&&!fileAPI;options.iframe!==!1&&(options.iframe||shouldUseFrame)?options.closeKeepAlive?$.get(options.closeKeepAlive,function(){jqxhr=fileUploadIframe(a)}):jqxhr=fileUploadIframe(a):jqxhr=(hasFileInputs||multipart)&&fileAPI?fileUploadXhr(a):$.ajax(options),$form.removeData("jqxhr").data("jqxhr",jqxhr);for(var k=0;k<elements.length;k++)elements[k]=null;return this.trigger("form-submit-notify",[this,options]),this},$.fn.ajaxForm=function(options){if(options=options||{},options.delegation=options.delegation&&$.isFunction($.fn.on),!options.delegation&&0===this.length){var o={s:this.selector,c:this.context};return!$.isReady&&o.s?(log("DOM not ready, queuing ajaxForm"),$(function(){$(o.s,o.c).ajaxForm(options)}),this):(log("terminating; zero elements found by selector"+($.isReady?"":" (DOM not ready)")),this)}return options.delegation?($(document).off("submit.form-plugin",this.selector,doAjaxSubmit).off("click.form-plugin",this.selector,captureSubmittingElement).on("submit.form-plugin",this.selector,options,doAjaxSubmit).on("click.form-plugin",this.selector,options,captureSubmittingElement),this):this.ajaxFormUnbind().bind("submit.form-plugin",options,doAjaxSubmit).bind("click.form-plugin",options,captureSubmittingElement)},$.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")},$.fn.formToArray=function(semantic,elements){var a=[];if(0===this.length)return a;var els2,form=this[0],formId=this.attr("id"),els=semantic?form.getElementsByTagName("*"):form.elements;if(els&&!/MSIE [678]/.test(navigator.userAgent)&&(els=$(els).get()),formId&&(els2=$(':input[form="'+formId+'"]').get(),els2.length&&(els=(els||[]).concat(els2))),!els||!els.length)return a;var i,j,n,v,el,max,jmax;for(i=0,max=els.length;max>i;i++)if(el=els[i],n=el.name,n&&!el.disabled)if(semantic&&form.clk&&"image"==el.type)form.clk==el&&(a.push({name:n,value:$(el).val(),type:el.type}),a.push({name:n+".x",value:form.clk_x},{name:n+".y",value:form.clk_y}));else if(v=$.fieldValue(el,!0),v&&v.constructor==Array)for(elements&&elements.push(el),j=0,jmax=v.length;jmax>j;j++)a.push({name:n,value:v[j]});else if(feature.fileapi&&"file"==el.type){elements&&elements.push(el);var files=el.files;if(files.length)for(j=0;j<files.length;j++)a.push({name:n,value:files[j],type:el.type});else a.push({name:n,value:"",type:el.type})}else null!==v&&"undefined"!=typeof v&&(elements&&elements.push(el),a.push({name:n,value:v,type:el.type,required:el.required}));if(!semantic&&form.clk){var $input=$(form.clk),input=$input[0];n=input.name,n&&!input.disabled&&"image"==input.type&&(a.push({name:n,value:$input.val()}),a.push({name:n+".x",value:form.clk_x},{name:n+".y",value:form.clk_y}))}return a},$.fn.formSerialize=function(semantic){return $.param(this.formToArray(semantic))},$.fn.fieldSerialize=function(successful){var a=[];return this.each(function(){var n=this.name;if(n){var v=$.fieldValue(this,successful);if(v&&v.constructor==Array)for(var i=0,max=v.length;max>i;i++)a.push({name:n,value:v[i]});else null!==v&&"undefined"!=typeof v&&a.push({name:this.name,value:v})}}),$.param(a)},$.fn.fieldValue=function(successful){for(var val=[],i=0,max=this.length;max>i;i++){var el=this[i],v=$.fieldValue(el,successful);null===v||"undefined"==typeof v||v.constructor==Array&&!v.length||(v.constructor==Array?$.merge(val,v):val.push(v))}return val},$.fieldValue=function(el,successful){var n=el.name,t=el.type,tag=el.tagName.toLowerCase();if(void 0===successful&&(successful=!0),successful&&(!n||el.disabled||"reset"==t||"button"==t||("checkbox"==t||"radio"==t)&&!el.checked||("submit"==t||"image"==t)&&el.form&&el.form.clk!=el||"select"==tag&&-1==el.selectedIndex))return null;if("select"==tag){var index=el.selectedIndex;if(0>index)return null;for(var a=[],ops=el.options,one="select-one"==t,max=one?index+1:ops.length,i=one?index:0;max>i;i++){var op=ops[i];if(op.selected){var v=op.value;if(v||(v=op.attributes&&op.attributes.value&&!op.attributes.value.specified?op.text:op.value),one)return v;a.push(v)}}return a}return $(el).val()},$.fn.clearForm=function(includeHidden){return this.each(function(){$("input,select,textarea",this).clearFields(includeHidden)})},$.fn.clearFields=$.fn.clearInputs=function(includeHidden){var re=/^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;return this.each(function(){var t=this.type,tag=this.tagName.toLowerCase();re.test(t)||"textarea"==tag?this.value="":"checkbox"==t||"radio"==t?this.checked=!1:"select"==tag?this.selectedIndex=-1:"file"==t?/MSIE/.test(navigator.userAgent)?$(this).replaceWith($(this).clone(!0)):$(this).val(""):includeHidden&&(includeHidden===!0&&/hidden/.test(t)||"string"==typeof includeHidden&&$(this).is(includeHidden))&&(this.value="")})},$.fn.resetForm=function(){return this.each(function(){("function"==typeof this.reset||"object"==typeof this.reset&&!this.reset.nodeType)&&this.reset()})},$.fn.enable=function(b){return void 0===b&&(b=!0),this.each(function(){this.disabled=!b})},$.fn.selected=function(select){return void 0===select&&(select=!0),this.each(function(){var t=this.type;if("checkbox"==t||"radio"==t)this.checked=select;else if("option"==this.tagName.toLowerCase()){var $sel=$(this).parent("select");select&&$sel[0]&&"select-one"==$sel[0].type&&$sel.find("option").selected(!1),this.selected=select}})},$.fn.ajaxSubmit.debug=!1}),function(window,undefined){function isArraylike(obj){var length=obj.length,type=jQuery.type(obj);return jQuery.isWindow(obj)?!1:1===obj.nodeType&&length?!0:"array"===type||"function"!==type&&(0===length||"number"==typeof length&&length>0&&length-1 in obj)}function createOptions(options){var object=optionsCache[options]={};return jQuery.each(options.match(core_rnotwhite)||[],function(_,flag){object[flag]=!0}),object}function internalData(elem,name,data,pvt){if(jQuery.acceptData(elem)){var ret,thisCache,internalKey=jQuery.expando,isNode=elem.nodeType,cache=isNode?jQuery.cache:elem,id=isNode?elem[internalKey]:elem[internalKey]&&internalKey;if(id&&cache[id]&&(pvt||cache[id].data)||data!==undefined||"string"!=typeof name)return id||(id=isNode?elem[internalKey]=core_deletedIds.pop()||jQuery.guid++:internalKey),cache[id]||(cache[id]=isNode?{}:{toJSON:jQuery.noop}),"object"!=typeof name&&"function"!=typeof name||(pvt?cache[id]=jQuery.extend(cache[id],name):cache[id].data=jQuery.extend(cache[id].data,name)),thisCache=cache[id],pvt||(thisCache.data||(thisCache.data={}),thisCache=thisCache.data),data!==undefined&&(thisCache[jQuery.camelCase(name)]=data),"string"==typeof name?(ret=thisCache[name],null==ret&&(ret=thisCache[jQuery.camelCase(name)])):ret=thisCache,ret}}function internalRemoveData(elem,name,pvt){if(jQuery.acceptData(elem)){var thisCache,i,isNode=elem.nodeType,cache=isNode?jQuery.cache:elem,id=isNode?elem[jQuery.expando]:jQuery.expando;if(cache[id]){if(name&&(thisCache=pvt?cache[id]:cache[id].data)){jQuery.isArray(name)?name=name.concat(jQuery.map(name,jQuery.camelCase)):name in thisCache?name=[name]:(name=jQuery.camelCase(name),name=name in thisCache?[name]:name.split(" ")),i=name.length;for(;i--;)delete thisCache[name[i]];if(pvt?!isEmptyDataObject(thisCache):!jQuery.isEmptyObject(thisCache))return}(pvt||(delete cache[id].data,isEmptyDataObject(cache[id])))&&(isNode?jQuery.cleanData([elem],!0):jQuery.support.deleteExpando||cache!=cache.window?delete cache[id]:cache[id]=null)}}}function dataAttr(elem,key,data){if(data===undefined&&1===elem.nodeType){var name="data-"+key.replace(rmultiDash,"-$1").toLowerCase();if(data=elem.getAttribute(name),"string"==typeof data){try{data="true"===data?!0:"false"===data?!1:"null"===data?null:+data+""===data?+data:rbrace.test(data)?jQuery.parseJSON(data):data}catch(e){}jQuery.data(elem,key,data)}else data=undefined}return data}function isEmptyDataObject(obj){var name;for(name in obj)if(("data"!==name||!jQuery.isEmptyObject(obj[name]))&&"toJSON"!==name)return!1;return!0}function returnTrue(){return!0}function returnFalse(){return!1}function safeActiveElement(){try{return document.activeElement}catch(err){}}function sibling(cur,dir){do cur=cur[dir];while(cur&&1!==cur.nodeType);return cur}function winnow(elements,qualifier,not){if(jQuery.isFunction(qualifier))return jQuery.grep(elements,function(elem,i){return!!qualifier.call(elem,i,elem)!==not});if(qualifier.nodeType)return jQuery.grep(elements,function(elem){return elem===qualifier!==not});if("string"==typeof qualifier){if(isSimple.test(qualifier))return jQuery.filter(qualifier,elements,not);qualifier=jQuery.filter(qualifier,elements)}return jQuery.grep(elements,function(elem){return jQuery.inArray(elem,qualifier)>=0!==not})}function createSafeFragment(document){var list=nodeNames.split("|"),safeFrag=document.createDocumentFragment();if(safeFrag.createElement)for(;list.length;)safeFrag.createElement(list.pop());return safeFrag}function manipulationTarget(elem,content){return jQuery.nodeName(elem,"table")&&jQuery.nodeName(1===content.nodeType?content:content.firstChild,"tr")?elem.getElementsByTagName("tbody")[0]||elem.appendChild(elem.ownerDocument.createElement("tbody")):elem}function disableScript(elem){return elem.type=(null!==jQuery.find.attr(elem,"type"))+"/"+elem.type,elem}function restoreScript(elem){var match=rscriptTypeMasked.exec(elem.type);return match?elem.type=match[1]:elem.removeAttribute("type"),elem}function setGlobalEval(elems,refElements){for(var elem,i=0;null!=(elem=elems[i]);i++)jQuery._data(elem,"globalEval",!refElements||jQuery._data(refElements[i],"globalEval"))}function cloneCopyEvent(src,dest){if(1===dest.nodeType&&jQuery.hasData(src)){var type,i,l,oldData=jQuery._data(src),curData=jQuery._data(dest,oldData),events=oldData.events;if(events){delete curData.handle,curData.events={};for(type in events)for(i=0,l=events[type].length;l>i;i++)jQuery.event.add(dest,type,events[type][i])}curData.data&&(curData.data=jQuery.extend({},curData.data))}}function fixCloneNodeIssues(src,dest){var nodeName,e,data;if(1===dest.nodeType){if(nodeName=dest.nodeName.toLowerCase(),!jQuery.support.noCloneEvent&&dest[jQuery.expando]){data=jQuery._data(dest);for(e in data.events)jQuery.removeEvent(dest,e,data.handle);dest.removeAttribute(jQuery.expando)}"script"===nodeName&&dest.text!==src.text?(disableScript(dest).text=src.text,restoreScript(dest)):"object"===nodeName?(dest.parentNode&&(dest.outerHTML=src.outerHTML),jQuery.support.html5Clone&&src.innerHTML&&!jQuery.trim(dest.innerHTML)&&(dest.innerHTML=src.innerHTML)):"input"===nodeName&&manipulation_rcheckableType.test(src.type)?(dest.defaultChecked=dest.checked=src.checked,dest.value!==src.value&&(dest.value=src.value)):"option"===nodeName?dest.defaultSelected=dest.selected=src.defaultSelected:"input"!==nodeName&&"textarea"!==nodeName||(dest.defaultValue=src.defaultValue)}}function getAll(context,tag){var elems,elem,i=0,found=typeof context.getElementsByTagName!==core_strundefined?context.getElementsByTagName(tag||"*"):typeof context.querySelectorAll!==core_strundefined?context.querySelectorAll(tag||"*"):undefined;if(!found)for(found=[],elems=context.childNodes||context;null!=(elem=elems[i]);i++)!tag||jQuery.nodeName(elem,tag)?found.push(elem):jQuery.merge(found,getAll(elem,tag));return tag===undefined||tag&&jQuery.nodeName(context,tag)?jQuery.merge([context],found):found}function fixDefaultChecked(elem){manipulation_rcheckableType.test(elem.type)&&(elem.defaultChecked=elem.checked)}function vendorPropName(style,name){if(name in style)return name;for(var capName=name.charAt(0).toUpperCase()+name.slice(1),origName=name,i=cssPrefixes.length;i--;)if(name=cssPrefixes[i]+capName,name in style)return name;return origName}function isHidden(elem,el){return elem=el||elem,"none"===jQuery.css(elem,"display")||!jQuery.contains(elem.ownerDocument,elem)}function showHide(elements,show){for(var display,elem,hidden,values=[],index=0,length=elements.length;length>index;index++)elem=elements[index],elem.style&&(values[index]=jQuery._data(elem,"olddisplay"),display=elem.style.display,show?(values[index]||"none"!==display||(elem.style.display=""),""===elem.style.display&&isHidden(elem)&&(values[index]=jQuery._data(elem,"olddisplay",css_defaultDisplay(elem.nodeName)))):values[index]||(hidden=isHidden(elem),(display&&"none"!==display||!hidden)&&jQuery._data(elem,"olddisplay",hidden?display:jQuery.css(elem,"display"))));for(index=0;length>index;index++)elem=elements[index],elem.style&&(show&&"none"!==elem.style.display&&""!==elem.style.display||(elem.style.display=show?values[index]||"":"none"));return elements}function setPositiveNumber(elem,value,subtract){var matches=rnumsplit.exec(value);return matches?Math.max(0,matches[1]-(subtract||0))+(matches[2]||"px"):value}function augmentWidthOrHeight(elem,name,extra,isBorderBox,styles){for(var i=extra===(isBorderBox?"border":"content")?4:"width"===name?1:0,val=0;4>i;i+=2)"margin"===extra&&(val+=jQuery.css(elem,extra+cssExpand[i],!0,styles)),isBorderBox?("content"===extra&&(val-=jQuery.css(elem,"padding"+cssExpand[i],!0,styles)),"margin"!==extra&&(val-=jQuery.css(elem,"border"+cssExpand[i]+"Width",!0,styles))):(val+=jQuery.css(elem,"padding"+cssExpand[i],!0,styles),"padding"!==extra&&(val+=jQuery.css(elem,"border"+cssExpand[i]+"Width",!0,styles)));return val}function getWidthOrHeight(elem,name,extra){var valueIsBorderBox=!0,val="width"===name?elem.offsetWidth:elem.offsetHeight,styles=getStyles(elem),isBorderBox=jQuery.support.boxSizing&&"border-box"===jQuery.css(elem,"boxSizing",!1,styles);if(0>=val||null==val){if(val=curCSS(elem,name,styles),(0>val||null==val)&&(val=elem.style[name]),rnumnonpx.test(val))return val;valueIsBorderBox=isBorderBox&&(jQuery.support.boxSizingReliable||val===elem.style[name]),val=parseFloat(val)||0}return val+augmentWidthOrHeight(elem,name,extra||(isBorderBox?"border":"content"),valueIsBorderBox,styles)+"px"}function css_defaultDisplay(nodeName){var doc=document,display=elemdisplay[nodeName];return display||(display=actualDisplay(nodeName,doc),"none"!==display&&display||(iframe=(iframe||jQuery("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(doc.documentElement),doc=(iframe[0].contentWindow||iframe[0].contentDocument).document,doc.write("<!doctype html><html><body>"),doc.close(),display=actualDisplay(nodeName,doc),iframe.detach()),elemdisplay[nodeName]=display),display}function actualDisplay(name,doc){var elem=jQuery(doc.createElement(name)).appendTo(doc.body),display=jQuery.css(elem[0],"display");return elem.remove(),display}function buildParams(prefix,obj,traditional,add){var name;if(jQuery.isArray(obj))jQuery.each(obj,function(i,v){traditional||rbracket.test(prefix)?add(prefix,v):buildParams(prefix+"["+("object"==typeof v?i:"")+"]",v,traditional,add)});else if(traditional||"object"!==jQuery.type(obj))add(prefix,obj);else for(name in obj)buildParams(prefix+"["+name+"]",obj[name],traditional,add)}function addToPrefiltersOrTransports(structure){return function(dataTypeExpression,func){"string"!=typeof dataTypeExpression&&(func=dataTypeExpression,dataTypeExpression="*");var dataType,i=0,dataTypes=dataTypeExpression.toLowerCase().match(core_rnotwhite)||[];if(jQuery.isFunction(func))for(;dataType=dataTypes[i++];)"+"===dataType[0]?(dataType=dataType.slice(1)||"*",(structure[dataType]=structure[dataType]||[]).unshift(func)):(structure[dataType]=structure[dataType]||[]).push(func)}}function inspectPrefiltersOrTransports(structure,options,originalOptions,jqXHR){function inspect(dataType){var selected;return inspected[dataType]=!0,jQuery.each(structure[dataType]||[],function(_,prefilterOrFactory){var dataTypeOrTransport=prefilterOrFactory(options,originalOptions,jqXHR);return"string"!=typeof dataTypeOrTransport||seekingTransport||inspected[dataTypeOrTransport]?seekingTransport?!(selected=dataTypeOrTransport):void 0:(options.dataTypes.unshift(dataTypeOrTransport),inspect(dataTypeOrTransport),!1)}),selected}var inspected={},seekingTransport=structure===transports;return inspect(options.dataTypes[0])||!inspected["*"]&&inspect("*")}function ajaxExtend(target,src){var deep,key,flatOptions=jQuery.ajaxSettings.flatOptions||{};for(key in src)src[key]!==undefined&&((flatOptions[key]?target:deep||(deep={}))[key]=src[key]);return deep&&jQuery.extend(!0,target,deep),target}function ajaxHandleResponses(s,jqXHR,responses){for(var firstDataType,ct,finalDataType,type,contents=s.contents,dataTypes=s.dataTypes;"*"===dataTypes[0];)dataTypes.shift(),ct===undefined&&(ct=s.mimeType||jqXHR.getResponseHeader("Content-Type"));if(ct)for(type in contents)if(contents[type]&&contents[type].test(ct)){dataTypes.unshift(type);break}if(dataTypes[0]in responses)finalDataType=dataTypes[0];else{for(type in responses){if(!dataTypes[0]||s.converters[type+" "+dataTypes[0]]){finalDataType=type;break}firstDataType||(firstDataType=type)}finalDataType=finalDataType||firstDataType}return finalDataType?(finalDataType!==dataTypes[0]&&dataTypes.unshift(finalDataType),responses[finalDataType]):void 0}function ajaxConvert(s,response,jqXHR,isSuccess){var conv2,current,conv,tmp,prev,converters={},dataTypes=s.dataTypes.slice();if(dataTypes[1])for(conv in s.converters)converters[conv.toLowerCase()]=s.converters[conv];for(current=dataTypes.shift();current;)if(s.responseFields[current]&&(jqXHR[s.responseFields[current]]=response),!prev&&isSuccess&&s.dataFilter&&(response=s.dataFilter(response,s.dataType)),prev=current,current=dataTypes.shift())if("*"===current)current=prev;else if("*"!==prev&&prev!==current){if(conv=converters[prev+" "+current]||converters["* "+current],
!conv)for(conv2 in converters)if(tmp=conv2.split(" "),tmp[1]===current&&(conv=converters[prev+" "+tmp[0]]||converters["* "+tmp[0]])){conv===!0?conv=converters[conv2]:converters[conv2]!==!0&&(current=tmp[0],dataTypes.unshift(tmp[1]));break}if(conv!==!0)if(conv&&s["throws"])response=conv(response);else try{response=conv(response)}catch(e){return{state:"parsererror",error:conv?e:"No conversion from "+prev+" to "+current}}}return{state:"success",data:response}}function createStandardXHR(){try{return new window.XMLHttpRequest}catch(e){}}function createActiveXHR(){try{return new window.ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}function createFxNow(){return setTimeout(function(){fxNow=undefined}),fxNow=jQuery.now()}function createTween(value,prop,animation){for(var tween,collection=(tweeners[prop]||[]).concat(tweeners["*"]),index=0,length=collection.length;length>index;index++)if(tween=collection[index].call(animation,prop,value))return tween}function Animation(elem,properties,options){var result,stopped,index=0,length=animationPrefilters.length,deferred=jQuery.Deferred().always(function(){delete tick.elem}),tick=function(){if(stopped)return!1;for(var currentTime=fxNow||createFxNow(),remaining=Math.max(0,animation.startTime+animation.duration-currentTime),temp=remaining/animation.duration||0,percent=1-temp,index=0,length=animation.tweens.length;length>index;index++)animation.tweens[index].run(percent);return deferred.notifyWith(elem,[animation,percent,remaining]),1>percent&&length?remaining:(deferred.resolveWith(elem,[animation]),!1)},animation=deferred.promise({elem:elem,props:jQuery.extend({},properties),opts:jQuery.extend(!0,{specialEasing:{}},options),originalProperties:properties,originalOptions:options,startTime:fxNow||createFxNow(),duration:options.duration,tweens:[],createTween:function(prop,end){var tween=jQuery.Tween(elem,animation.opts,prop,end,animation.opts.specialEasing[prop]||animation.opts.easing);return animation.tweens.push(tween),tween},stop:function(gotoEnd){var index=0,length=gotoEnd?animation.tweens.length:0;if(stopped)return this;for(stopped=!0;length>index;index++)animation.tweens[index].run(1);return gotoEnd?deferred.resolveWith(elem,[animation,gotoEnd]):deferred.rejectWith(elem,[animation,gotoEnd]),this}}),props=animation.props;for(propFilter(props,animation.opts.specialEasing);length>index;index++)if(result=animationPrefilters[index].call(animation,elem,props,animation.opts))return result;return jQuery.map(props,createTween,animation),jQuery.isFunction(animation.opts.start)&&animation.opts.start.call(elem,animation),jQuery.fx.timer(jQuery.extend(tick,{elem:elem,anim:animation,queue:animation.opts.queue})),animation.progress(animation.opts.progress).done(animation.opts.done,animation.opts.complete).fail(animation.opts.fail).always(animation.opts.always)}function propFilter(props,specialEasing){var index,name,easing,value,hooks;for(index in props)if(name=jQuery.camelCase(index),easing=specialEasing[name],value=props[index],jQuery.isArray(value)&&(easing=value[1],value=props[index]=value[0]),index!==name&&(props[name]=value,delete props[index]),hooks=jQuery.cssHooks[name],hooks&&"expand"in hooks){value=hooks.expand(value),delete props[name];for(index in value)index in props||(props[index]=value[index],specialEasing[index]=easing)}else specialEasing[name]=easing}function defaultPrefilter(elem,props,opts){var prop,value,toggle,tween,hooks,oldfire,anim=this,orig={},style=elem.style,hidden=elem.nodeType&&isHidden(elem),dataShow=jQuery._data(elem,"fxshow");opts.queue||(hooks=jQuery._queueHooks(elem,"fx"),null==hooks.unqueued&&(hooks.unqueued=0,oldfire=hooks.empty.fire,hooks.empty.fire=function(){hooks.unqueued||oldfire()}),hooks.unqueued++,anim.always(function(){anim.always(function(){hooks.unqueued--,jQuery.queue(elem,"fx").length||hooks.empty.fire()})})),1===elem.nodeType&&("height"in props||"width"in props)&&(opts.overflow=[style.overflow,style.overflowX,style.overflowY],"inline"===jQuery.css(elem,"display")&&"none"===jQuery.css(elem,"float")&&(jQuery.support.inlineBlockNeedsLayout&&"inline"!==css_defaultDisplay(elem.nodeName)?style.zoom=1:style.display="inline-block")),opts.overflow&&(style.overflow="hidden",jQuery.support.shrinkWrapBlocks||anim.always(function(){style.overflow=opts.overflow[0],style.overflowX=opts.overflow[1],style.overflowY=opts.overflow[2]}));for(prop in props)if(value=props[prop],rfxtypes.exec(value)){if(delete props[prop],toggle=toggle||"toggle"===value,value===(hidden?"hide":"show"))continue;orig[prop]=dataShow&&dataShow[prop]||jQuery.style(elem,prop)}if(!jQuery.isEmptyObject(orig)){dataShow?"hidden"in dataShow&&(hidden=dataShow.hidden):dataShow=jQuery._data(elem,"fxshow",{}),toggle&&(dataShow.hidden=!hidden),hidden?jQuery(elem).show():anim.done(function(){jQuery(elem).hide()}),anim.done(function(){var prop;jQuery._removeData(elem,"fxshow");for(prop in orig)jQuery.style(elem,prop,orig[prop])});for(prop in orig)tween=createTween(hidden?dataShow[prop]:0,prop,anim),prop in dataShow||(dataShow[prop]=tween.start,hidden&&(tween.end=tween.start,tween.start="width"===prop||"height"===prop?1:0))}}function Tween(elem,options,prop,end,easing){return new Tween.prototype.init(elem,options,prop,end,easing)}function genFx(type,includeWidth){var which,attrs={height:type},i=0;for(includeWidth=includeWidth?1:0;4>i;i+=2-includeWidth)which=cssExpand[i],attrs["margin"+which]=attrs["padding"+which]=type;return includeWidth&&(attrs.opacity=attrs.width=type),attrs}function getWindow(elem){return jQuery.isWindow(elem)?elem:9===elem.nodeType?elem.defaultView||elem.parentWindow:!1}var readyList,rootjQuery,core_strundefined=typeof undefined,location=window.location,document=window.document,docElem=document.documentElement,_jQuery=window.jQuery,_$=window.$,class2type={},core_deletedIds=[],core_version="1.10.2",core_concat=core_deletedIds.concat,core_push=core_deletedIds.push,core_slice=core_deletedIds.slice,core_indexOf=core_deletedIds.indexOf,core_toString=class2type.toString,core_hasOwn=class2type.hasOwnProperty,core_trim=core_version.trim,jQuery=function(selector,context){return new jQuery.fn.init(selector,context,rootjQuery)},core_pnum=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,core_rnotwhite=/\S+/g,rtrim=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,rquickExpr=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,rsingleTag=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,rvalidchars=/^[\],:{}\s]*$/,rvalidbraces=/(?:^|:|,)(?:\s*\[)+/g,rvalidescape=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,rvalidtokens=/"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g,rmsPrefix=/^-ms-/,rdashAlpha=/-([\da-z])/gi,fcamelCase=function(all,letter){return letter.toUpperCase()},completed=function(event){(document.addEventListener||"load"===event.type||"complete"===document.readyState)&&(detach(),jQuery.ready())},detach=function(){document.addEventListener?(document.removeEventListener("DOMContentLoaded",completed,!1),window.removeEventListener("load",completed,!1)):(document.detachEvent("onreadystatechange",completed),window.detachEvent("onload",completed))};jQuery.fn=jQuery.prototype={jquery:core_version,constructor:jQuery,init:function(selector,context,rootjQuery){var match,elem;if(!selector)return this;if("string"==typeof selector){if(match="<"===selector.charAt(0)&&">"===selector.charAt(selector.length-1)&&selector.length>=3?[null,selector,null]:rquickExpr.exec(selector),!match||!match[1]&&context)return!context||context.jquery?(context||rootjQuery).find(selector):this.constructor(context).find(selector);if(match[1]){if(context=context instanceof jQuery?context[0]:context,jQuery.merge(this,jQuery.parseHTML(match[1],context&&context.nodeType?context.ownerDocument||context:document,!0)),rsingleTag.test(match[1])&&jQuery.isPlainObject(context))for(match in context)jQuery.isFunction(this[match])?this[match](context[match]):this.attr(match,context[match]);return this}if(elem=document.getElementById(match[2]),elem&&elem.parentNode){if(elem.id!==match[2])return rootjQuery.find(selector);this.length=1,this[0]=elem}return this.context=document,this.selector=selector,this}return selector.nodeType?(this.context=this[0]=selector,this.length=1,this):jQuery.isFunction(selector)?rootjQuery.ready(selector):(selector.selector!==undefined&&(this.selector=selector.selector,this.context=selector.context),jQuery.makeArray(selector,this))},selector:"",length:0,toArray:function(){return core_slice.call(this)},get:function(num){return null==num?this.toArray():0>num?this[this.length+num]:this[num]},pushStack:function(elems){var ret=jQuery.merge(this.constructor(),elems);return ret.prevObject=this,ret.context=this.context,ret},each:function(callback,args){return jQuery.each(this,callback,args)},ready:function(fn){return jQuery.ready.promise().done(fn),this},slice:function(){return this.pushStack(core_slice.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(i){var len=this.length,j=+i+(0>i?len:0);return this.pushStack(j>=0&&len>j?[this[j]]:[])},map:function(callback){return this.pushStack(jQuery.map(this,function(elem,i){return callback.call(elem,i,elem)}))},end:function(){return this.prevObject||this.constructor(null)},push:core_push,sort:[].sort,splice:[].splice},jQuery.fn.init.prototype=jQuery.fn,jQuery.extend=jQuery.fn.extend=function(){var src,copyIsArray,copy,name,options,clone,target=arguments[0]||{},i=1,length=arguments.length,deep=!1;for("boolean"==typeof target&&(deep=target,target=arguments[1]||{},i=2),"object"==typeof target||jQuery.isFunction(target)||(target={}),length===i&&(target=this,--i);length>i;i++)if(null!=(options=arguments[i]))for(name in options)src=target[name],copy=options[name],target!==copy&&(deep&&copy&&(jQuery.isPlainObject(copy)||(copyIsArray=jQuery.isArray(copy)))?(copyIsArray?(copyIsArray=!1,clone=src&&jQuery.isArray(src)?src:[]):clone=src&&jQuery.isPlainObject(src)?src:{},target[name]=jQuery.extend(deep,clone,copy)):copy!==undefined&&(target[name]=copy));return target},jQuery.extend({expando:"jQuery"+(core_version+Math.random()).replace(/\D/g,""),noConflict:function(deep){return window.$===jQuery&&(window.$=_$),deep&&window.jQuery===jQuery&&(window.jQuery=_jQuery),jQuery},isReady:!1,readyWait:1,holdReady:function(hold){hold?jQuery.readyWait++:jQuery.ready(!0)},ready:function(wait){if(wait===!0?!--jQuery.readyWait:!jQuery.isReady){if(!document.body)return setTimeout(jQuery.ready);jQuery.isReady=!0,wait!==!0&&--jQuery.readyWait>0||(readyList.resolveWith(document,[jQuery]),jQuery.fn.trigger&&jQuery(document).trigger("ready").off("ready"))}},isFunction:function(obj){return"function"===jQuery.type(obj)},isArray:Array.isArray||function(obj){return"array"===jQuery.type(obj)},isWindow:function(obj){return null!=obj&&obj==obj.window},isNumeric:function(obj){return!isNaN(parseFloat(obj))&&isFinite(obj)},type:function(obj){return null==obj?String(obj):"object"==typeof obj||"function"==typeof obj?class2type[core_toString.call(obj)]||"object":typeof obj},isPlainObject:function(obj){var key;if(!obj||"object"!==jQuery.type(obj)||obj.nodeType||jQuery.isWindow(obj))return!1;try{if(obj.constructor&&!core_hasOwn.call(obj,"constructor")&&!core_hasOwn.call(obj.constructor.prototype,"isPrototypeOf"))return!1}catch(e){return!1}if(jQuery.support.ownLast)for(key in obj)return core_hasOwn.call(obj,key);for(key in obj);return key===undefined||core_hasOwn.call(obj,key)},isEmptyObject:function(obj){var name;for(name in obj)return!1;return!0},error:function(msg){throw new Error(msg)},parseHTML:function(data,context,keepScripts){if(!data||"string"!=typeof data)return null;"boolean"==typeof context&&(keepScripts=context,context=!1),context=context||document;var parsed=rsingleTag.exec(data),scripts=!keepScripts&&[];return parsed?[context.createElement(parsed[1])]:(parsed=jQuery.buildFragment([data],context,scripts),scripts&&jQuery(scripts).remove(),jQuery.merge([],parsed.childNodes))},parseJSON:function(data){return window.JSON&&window.JSON.parse?window.JSON.parse(data):null===data?data:"string"==typeof data&&(data=jQuery.trim(data),data&&rvalidchars.test(data.replace(rvalidescape,"@").replace(rvalidtokens,"]").replace(rvalidbraces,"")))?new Function("return "+data)():void jQuery.error("Invalid JSON: "+data)},parseXML:function(data){var xml,tmp;if(!data||"string"!=typeof data)return null;try{window.DOMParser?(tmp=new DOMParser,xml=tmp.parseFromString(data,"text/xml")):(xml=new ActiveXObject("Microsoft.XMLDOM"),xml.async="false",xml.loadXML(data))}catch(e){xml=undefined}return xml&&xml.documentElement&&!xml.getElementsByTagName("parsererror").length||jQuery.error("Invalid XML: "+data),xml},noop:function(){},globalEval:function(data){data&&jQuery.trim(data)&&(window.execScript||function(data){window.eval.call(window,data)})(data)},camelCase:function(string){return string.replace(rmsPrefix,"ms-").replace(rdashAlpha,fcamelCase)},nodeName:function(elem,name){return elem.nodeName&&elem.nodeName.toLowerCase()===name.toLowerCase()},each:function(obj,callback,args){var value,i=0,length=obj.length,isArray=isArraylike(obj);if(args){if(isArray)for(;length>i&&(value=callback.apply(obj[i],args),value!==!1);i++);else for(i in obj)if(value=callback.apply(obj[i],args),value===!1)break}else if(isArray)for(;length>i&&(value=callback.call(obj[i],i,obj[i]),value!==!1);i++);else for(i in obj)if(value=callback.call(obj[i],i,obj[i]),value===!1)break;return obj},trim:core_trim&&!core_trim.call("\ufeff ")?function(text){return null==text?"":core_trim.call(text)}:function(text){return null==text?"":(text+"").replace(rtrim,"")},makeArray:function(arr,results){var ret=results||[];return null!=arr&&(isArraylike(Object(arr))?jQuery.merge(ret,"string"==typeof arr?[arr]:arr):core_push.call(ret,arr)),ret},inArray:function(elem,arr,i){var len;if(arr){if(core_indexOf)return core_indexOf.call(arr,elem,i);for(len=arr.length,i=i?0>i?Math.max(0,len+i):i:0;len>i;i++)if(i in arr&&arr[i]===elem)return i}return-1},merge:function(first,second){var l=second.length,i=first.length,j=0;if("number"==typeof l)for(;l>j;j++)first[i++]=second[j];else for(;second[j]!==undefined;)first[i++]=second[j++];return first.length=i,first},grep:function(elems,callback,inv){var retVal,ret=[],i=0,length=elems.length;for(inv=!!inv;length>i;i++)retVal=!!callback(elems[i],i),inv!==retVal&&ret.push(elems[i]);return ret},map:function(elems,callback,arg){var value,i=0,length=elems.length,isArray=isArraylike(elems),ret=[];if(isArray)for(;length>i;i++)value=callback(elems[i],i,arg),null!=value&&(ret[ret.length]=value);else for(i in elems)value=callback(elems[i],i,arg),null!=value&&(ret[ret.length]=value);return core_concat.apply([],ret)},guid:1,proxy:function(fn,context){var args,proxy,tmp;return"string"==typeof context&&(tmp=fn[context],context=fn,fn=tmp),jQuery.isFunction(fn)?(args=core_slice.call(arguments,2),proxy=function(){return fn.apply(context||this,args.concat(core_slice.call(arguments)))},proxy.guid=fn.guid=fn.guid||jQuery.guid++,proxy):undefined},access:function(elems,fn,key,value,chainable,emptyGet,raw){var i=0,length=elems.length,bulk=null==key;if("object"===jQuery.type(key)){chainable=!0;for(i in key)jQuery.access(elems,fn,i,key[i],!0,emptyGet,raw)}else if(value!==undefined&&(chainable=!0,jQuery.isFunction(value)||(raw=!0),bulk&&(raw?(fn.call(elems,value),fn=null):(bulk=fn,fn=function(elem,key,value){return bulk.call(jQuery(elem),value)})),fn))for(;length>i;i++)fn(elems[i],key,raw?value:value.call(elems[i],i,fn(elems[i],key)));return chainable?elems:bulk?fn.call(elems):length?fn(elems[0],key):emptyGet},now:function(){return(new Date).getTime()},swap:function(elem,options,callback,args){var ret,name,old={};for(name in options)old[name]=elem.style[name],elem.style[name]=options[name];ret=callback.apply(elem,args||[]);for(name in options)elem.style[name]=old[name];return ret}}),jQuery.ready.promise=function(obj){if(!readyList)if(readyList=jQuery.Deferred(),"complete"===document.readyState)setTimeout(jQuery.ready);else if(document.addEventListener)document.addEventListener("DOMContentLoaded",completed,!1),window.addEventListener("load",completed,!1);else{document.attachEvent("onreadystatechange",completed),window.attachEvent("onload",completed);var top=!1;try{top=null==window.frameElement&&document.documentElement}catch(e){}top&&top.doScroll&&!function doScrollCheck(){if(!jQuery.isReady){try{top.doScroll("left")}catch(e){return setTimeout(doScrollCheck,50)}detach(),jQuery.ready()}}()}return readyList.promise(obj)},jQuery.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(i,name){class2type["[object "+name+"]"]=name.toLowerCase()}),rootjQuery=jQuery(document),function(window,undefined){function Sizzle(selector,context,results,seed){var match,elem,m,nodeType,i,groups,old,nid,newContext,newSelector;if((context?context.ownerDocument||context:preferredDoc)!==document&&setDocument(context),context=context||document,results=results||[],!selector||"string"!=typeof selector)return results;if(1!==(nodeType=context.nodeType)&&9!==nodeType)return[];if(documentIsHTML&&!seed){if(match=rquickExpr.exec(selector))if(m=match[1]){if(9===nodeType){if(elem=context.getElementById(m),!elem||!elem.parentNode)return results;if(elem.id===m)return results.push(elem),results}else if(context.ownerDocument&&(elem=context.ownerDocument.getElementById(m))&&contains(context,elem)&&elem.id===m)return results.push(elem),results}else{if(match[2])return push.apply(results,context.getElementsByTagName(selector)),results;if((m=match[3])&&support.getElementsByClassName&&context.getElementsByClassName)return push.apply(results,context.getElementsByClassName(m)),results}if(support.qsa&&(!rbuggyQSA||!rbuggyQSA.test(selector))){if(nid=old=expando,newContext=context,newSelector=9===nodeType&&selector,1===nodeType&&"object"!==context.nodeName.toLowerCase()){for(groups=tokenize(selector),(old=context.getAttribute("id"))?nid=old.replace(rescape,"\\$&"):context.setAttribute("id",nid),nid="[id='"+nid+"'] ",i=groups.length;i--;)groups[i]=nid+toSelector(groups[i]);newContext=rsibling.test(selector)&&context.parentNode||context,newSelector=groups.join(",")}if(newSelector)try{return push.apply(results,newContext.querySelectorAll(newSelector)),results}catch(qsaError){}finally{old||context.removeAttribute("id")}}}return select(selector.replace(rtrim,"$1"),context,results,seed)}function createCache(){function cache(key,value){return keys.push(key+=" ")>Expr.cacheLength&&delete cache[keys.shift()],cache[key]=value}var keys=[];return cache}function markFunction(fn){return fn[expando]=!0,fn}function assert(fn){var div=document.createElement("div");try{return!!fn(div)}catch(e){return!1}finally{div.parentNode&&div.parentNode.removeChild(div),div=null}}function addHandle(attrs,handler){for(var arr=attrs.split("|"),i=attrs.length;i--;)Expr.attrHandle[arr[i]]=handler}function siblingCheck(a,b){var cur=b&&a,diff=cur&&1===a.nodeType&&1===b.nodeType&&(~b.sourceIndex||MAX_NEGATIVE)-(~a.sourceIndex||MAX_NEGATIVE);if(diff)return diff;if(cur)for(;cur=cur.nextSibling;)if(cur===b)return-1;return a?1:-1}function createInputPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return"input"===name&&elem.type===type}}function createButtonPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return("input"===name||"button"===name)&&elem.type===type}}function createPositionalPseudo(fn){return markFunction(function(argument){return argument=+argument,markFunction(function(seed,matches){for(var j,matchIndexes=fn([],seed.length,argument),i=matchIndexes.length;i--;)seed[j=matchIndexes[i]]&&(seed[j]=!(matches[j]=seed[j]))})})}function setFilters(){}function tokenize(selector,parseOnly){var matched,match,tokens,type,soFar,groups,preFilters,cached=tokenCache[selector+" "];if(cached)return parseOnly?0:cached.slice(0);for(soFar=selector,groups=[],preFilters=Expr.preFilter;soFar;){matched&&!(match=rcomma.exec(soFar))||(match&&(soFar=soFar.slice(match[0].length)||soFar),groups.push(tokens=[])),matched=!1,(match=rcombinators.exec(soFar))&&(matched=match.shift(),tokens.push({value:matched,type:match[0].replace(rtrim," ")}),soFar=soFar.slice(matched.length));for(type in Expr.filter)!(match=matchExpr[type].exec(soFar))||preFilters[type]&&!(match=preFilters[type](match))||(matched=match.shift(),tokens.push({value:matched,type:type,matches:match}),soFar=soFar.slice(matched.length));if(!matched)break}return parseOnly?soFar.length:soFar?Sizzle.error(selector):tokenCache(selector,groups).slice(0)}function toSelector(tokens){for(var i=0,len=tokens.length,selector="";len>i;i++)selector+=tokens[i].value;return selector}function addCombinator(matcher,combinator,base){var dir=combinator.dir,checkNonElements=base&&"parentNode"===dir,doneName=done++;return combinator.first?function(elem,context,xml){for(;elem=elem[dir];)if(1===elem.nodeType||checkNonElements)return matcher(elem,context,xml)}:function(elem,context,xml){var data,cache,outerCache,dirkey=dirruns+" "+doneName;if(xml){for(;elem=elem[dir];)if((1===elem.nodeType||checkNonElements)&&matcher(elem,context,xml))return!0}else for(;elem=elem[dir];)if(1===elem.nodeType||checkNonElements)if(outerCache=elem[expando]||(elem[expando]={}),(cache=outerCache[dir])&&cache[0]===dirkey){if((data=cache[1])===!0||data===cachedruns)return data===!0}else if(cache=outerCache[dir]=[dirkey],cache[1]=matcher(elem,context,xml)||cachedruns,cache[1]===!0)return!0}}function elementMatcher(matchers){return matchers.length>1?function(elem,context,xml){for(var i=matchers.length;i--;)if(!matchers[i](elem,context,xml))return!1;return!0}:matchers[0]}function condense(unmatched,map,filter,context,xml){for(var elem,newUnmatched=[],i=0,len=unmatched.length,mapped=null!=map;len>i;i++)(elem=unmatched[i])&&(filter&&!filter(elem,context,xml)||(newUnmatched.push(elem),mapped&&map.push(i)));return newUnmatched}function setMatcher(preFilter,selector,matcher,postFilter,postFinder,postSelector){return postFilter&&!postFilter[expando]&&(postFilter=setMatcher(postFilter)),postFinder&&!postFinder[expando]&&(postFinder=setMatcher(postFinder,postSelector)),markFunction(function(seed,results,context,xml){var temp,i,elem,preMap=[],postMap=[],preexisting=results.length,elems=seed||multipleContexts(selector||"*",context.nodeType?[context]:context,[]),matcherIn=!preFilter||!seed&&selector?elems:condense(elems,preMap,preFilter,context,xml),matcherOut=matcher?postFinder||(seed?preFilter:preexisting||postFilter)?[]:results:matcherIn;if(matcher&&matcher(matcherIn,matcherOut,context,xml),postFilter)for(temp=condense(matcherOut,postMap),postFilter(temp,[],context,xml),i=temp.length;i--;)(elem=temp[i])&&(matcherOut[postMap[i]]=!(matcherIn[postMap[i]]=elem));if(seed){if(postFinder||preFilter){if(postFinder){for(temp=[],i=matcherOut.length;i--;)(elem=matcherOut[i])&&temp.push(matcherIn[i]=elem);postFinder(null,matcherOut=[],temp,xml)}for(i=matcherOut.length;i--;)(elem=matcherOut[i])&&(temp=postFinder?indexOf.call(seed,elem):preMap[i])>-1&&(seed[temp]=!(results[temp]=elem))}}else matcherOut=condense(matcherOut===results?matcherOut.splice(preexisting,matcherOut.length):matcherOut),postFinder?postFinder(null,results,matcherOut,xml):push.apply(results,matcherOut)})}function matcherFromTokens(tokens){for(var checkContext,matcher,j,len=tokens.length,leadingRelative=Expr.relative[tokens[0].type],implicitRelative=leadingRelative||Expr.relative[" "],i=leadingRelative?1:0,matchContext=addCombinator(function(elem){return elem===checkContext},implicitRelative,!0),matchAnyContext=addCombinator(function(elem){return indexOf.call(checkContext,elem)>-1},implicitRelative,!0),matchers=[function(elem,context,xml){return!leadingRelative&&(xml||context!==outermostContext)||((checkContext=context).nodeType?matchContext(elem,context,xml):matchAnyContext(elem,context,xml))}];len>i;i++)if(matcher=Expr.relative[tokens[i].type])matchers=[addCombinator(elementMatcher(matchers),matcher)];else{if(matcher=Expr.filter[tokens[i].type].apply(null,tokens[i].matches),matcher[expando]){for(j=++i;len>j&&!Expr.relative[tokens[j].type];j++);return setMatcher(i>1&&elementMatcher(matchers),i>1&&toSelector(tokens.slice(0,i-1).concat({value:" "===tokens[i-2].type?"*":""})).replace(rtrim,"$1"),matcher,j>i&&matcherFromTokens(tokens.slice(i,j)),len>j&&matcherFromTokens(tokens=tokens.slice(j)),len>j&&toSelector(tokens))}matchers.push(matcher)}return elementMatcher(matchers)}function matcherFromGroupMatchers(elementMatchers,setMatchers){var matcherCachedRuns=0,bySet=setMatchers.length>0,byElement=elementMatchers.length>0,superMatcher=function(seed,context,xml,results,expandContext){var elem,j,matcher,setMatched=[],matchedCount=0,i="0",unmatched=seed&&[],outermost=null!=expandContext,contextBackup=outermostContext,elems=seed||byElement&&Expr.find.TAG("*",expandContext&&context.parentNode||context),dirrunsUnique=dirruns+=null==contextBackup?1:Math.random()||.1;for(outermost&&(outermostContext=context!==document&&context,cachedruns=matcherCachedRuns);null!=(elem=elems[i]);i++){if(byElement&&elem){for(j=0;matcher=elementMatchers[j++];)if(matcher(elem,context,xml)){results.push(elem);break}outermost&&(dirruns=dirrunsUnique,cachedruns=++matcherCachedRuns)}bySet&&((elem=!matcher&&elem)&&matchedCount--,seed&&unmatched.push(elem))}if(matchedCount+=i,bySet&&i!==matchedCount){for(j=0;matcher=setMatchers[j++];)matcher(unmatched,setMatched,context,xml);if(seed){if(matchedCount>0)for(;i--;)unmatched[i]||setMatched[i]||(setMatched[i]=pop.call(results));setMatched=condense(setMatched)}push.apply(results,setMatched),outermost&&!seed&&setMatched.length>0&&matchedCount+setMatchers.length>1&&Sizzle.uniqueSort(results)}return outermost&&(dirruns=dirrunsUnique,outermostContext=contextBackup),unmatched};return bySet?markFunction(superMatcher):superMatcher}function multipleContexts(selector,contexts,results){for(var i=0,len=contexts.length;len>i;i++)Sizzle(selector,contexts[i],results);return results}function select(selector,context,results,seed){var i,tokens,token,type,find,match=tokenize(selector);if(!seed&&1===match.length){if(tokens=match[0]=match[0].slice(0),tokens.length>2&&"ID"===(token=tokens[0]).type&&support.getById&&9===context.nodeType&&documentIsHTML&&Expr.relative[tokens[1].type]){if(context=(Expr.find.ID(token.matches[0].replace(runescape,funescape),context)||[])[0],!context)return results;selector=selector.slice(tokens.shift().value.length)}for(i=matchExpr.needsContext.test(selector)?0:tokens.length;i--&&(token=tokens[i],!Expr.relative[type=token.type]);)if((find=Expr.find[type])&&(seed=find(token.matches[0].replace(runescape,funescape),rsibling.test(tokens[0].type)&&context.parentNode||context))){if(tokens.splice(i,1),selector=seed.length&&toSelector(tokens),!selector)return push.apply(results,seed),results;break}}return compile(selector,match)(seed,context,!documentIsHTML,results,rsibling.test(selector)),results}var i,support,cachedruns,Expr,getText,isXML,compile,outermostContext,sortInput,setDocument,document,docElem,documentIsHTML,rbuggyQSA,rbuggyMatches,matches,contains,expando="sizzle"+-new Date,preferredDoc=window.document,dirruns=0,done=0,classCache=createCache(),tokenCache=createCache(),compilerCache=createCache(),hasDuplicate=!1,sortOrder=function(a,b){return a===b?(hasDuplicate=!0,0):0},strundefined=typeof undefined,MAX_NEGATIVE=1<<31,hasOwn={}.hasOwnProperty,arr=[],pop=arr.pop,push_native=arr.push,push=arr.push,slice=arr.slice,indexOf=arr.indexOf||function(elem){for(var i=0,len=this.length;len>i;i++)if(this[i]===elem)return i;return-1},booleans="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",whitespace="[\\x20\\t\\r\\n\\f]",characterEncoding="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",identifier=characterEncoding.replace("w","w#"),attributes="\\["+whitespace+"*("+characterEncoding+")"+whitespace+"*(?:([*^$|!~]?=)"+whitespace+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+identifier+")|)|)"+whitespace+"*\\]",pseudos=":("+characterEncoding+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+attributes.replace(3,8)+")*)|.*)\\)|)",rtrim=new RegExp("^"+whitespace+"+|((?:^|[^\\\\])(?:\\\\.)*)"+whitespace+"+$","g"),rcomma=new RegExp("^"+whitespace+"*,"+whitespace+"*"),rcombinators=new RegExp("^"+whitespace+"*([>+~]|"+whitespace+")"+whitespace+"*"),rsibling=new RegExp(whitespace+"*[+~]"),rattributeQuotes=new RegExp("="+whitespace+"*([^\\]'\"]*)"+whitespace+"*\\]","g"),rpseudo=new RegExp(pseudos),ridentifier=new RegExp("^"+identifier+"$"),matchExpr={ID:new RegExp("^#("+characterEncoding+")"),CLASS:new RegExp("^\\.("+characterEncoding+")"),TAG:new RegExp("^("+characterEncoding.replace("w","w*")+")"),ATTR:new RegExp("^"+attributes),PSEUDO:new RegExp("^"+pseudos),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+whitespace+"*(even|odd|(([+-]|)(\\d*)n|)"+whitespace+"*(?:([+-]|)"+whitespace+"*(\\d+)|))"+whitespace+"*\\)|)","i"),bool:new RegExp("^(?:"+booleans+")$","i"),needsContext:new RegExp("^"+whitespace+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+whitespace+"*((?:-\\d)?\\d*)"+whitespace+"*\\)|)(?=[^-]|$)","i")},rnative=/^[^{]+\{\s*\[native \w/,rquickExpr=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,rinputs=/^(?:input|select|textarea|button)$/i,rheader=/^h\d$/i,rescape=/'|\\/g,runescape=new RegExp("\\\\([\\da-f]{1,6}"+whitespace+"?|("+whitespace+")|.)","ig"),funescape=function(_,escaped,escapedWhitespace){var high="0x"+escaped-65536;return high!==high||escapedWhitespace?escaped:0>high?String.fromCharCode(high+65536):String.fromCharCode(high>>10|55296,1023&high|56320)};try{push.apply(arr=slice.call(preferredDoc.childNodes),preferredDoc.childNodes),arr[preferredDoc.childNodes.length].nodeType}catch(e){push={apply:arr.length?function(target,els){push_native.apply(target,slice.call(els))}:function(target,els){for(var j=target.length,i=0;target[j++]=els[i++];);target.length=j-1}}}isXML=Sizzle.isXML=function(elem){var documentElement=elem&&(elem.ownerDocument||elem).documentElement;return documentElement?"HTML"!==documentElement.nodeName:!1},support=Sizzle.support={},setDocument=Sizzle.setDocument=function(node){var doc=node?node.ownerDocument||node:preferredDoc,parent=doc.defaultView;return doc!==document&&9===doc.nodeType&&doc.documentElement?(document=doc,docElem=doc.documentElement,documentIsHTML=!isXML(doc),parent&&parent.attachEvent&&parent!==parent.top&&parent.attachEvent("onbeforeunload",function(){setDocument()}),support.attributes=assert(function(div){return div.className="i",!div.getAttribute("className")}),support.getElementsByTagName=assert(function(div){return div.appendChild(doc.createComment("")),!div.getElementsByTagName("*").length}),support.getElementsByClassName=assert(function(div){return div.innerHTML="<div class='a'></div><div class='a i'></div>",div.firstChild.className="i",2===div.getElementsByClassName("i").length}),support.getById=assert(function(div){return docElem.appendChild(div).id=expando,!doc.getElementsByName||!doc.getElementsByName(expando).length}),support.getById?(Expr.find.ID=function(id,context){if(typeof context.getElementById!==strundefined&&documentIsHTML){var m=context.getElementById(id);return m&&m.parentNode?[m]:[]}},Expr.filter.ID=function(id){var attrId=id.replace(runescape,funescape);return function(elem){return elem.getAttribute("id")===attrId}}):(delete Expr.find.ID,Expr.filter.ID=function(id){var attrId=id.replace(runescape,funescape);return function(elem){var node=typeof elem.getAttributeNode!==strundefined&&elem.getAttributeNode("id");return node&&node.value===attrId}}),Expr.find.TAG=support.getElementsByTagName?function(tag,context){return typeof context.getElementsByTagName!==strundefined?context.getElementsByTagName(tag):void 0}:function(tag,context){var elem,tmp=[],i=0,results=context.getElementsByTagName(tag);if("*"===tag){for(;elem=results[i++];)1===elem.nodeType&&tmp.push(elem);return tmp}return results},Expr.find.CLASS=support.getElementsByClassName&&function(className,context){return typeof context.getElementsByClassName!==strundefined&&documentIsHTML?context.getElementsByClassName(className):void 0;
},rbuggyMatches=[],rbuggyQSA=[],(support.qsa=rnative.test(doc.querySelectorAll))&&(assert(function(div){div.innerHTML="<select><option selected=''></option></select>",div.querySelectorAll("[selected]").length||rbuggyQSA.push("\\["+whitespace+"*(?:value|"+booleans+")"),div.querySelectorAll(":checked").length||rbuggyQSA.push(":checked")}),assert(function(div){var input=doc.createElement("input");input.setAttribute("type","hidden"),div.appendChild(input).setAttribute("t",""),div.querySelectorAll("[t^='']").length&&rbuggyQSA.push("[*^$]="+whitespace+"*(?:''|\"\")"),div.querySelectorAll(":enabled").length||rbuggyQSA.push(":enabled",":disabled"),div.querySelectorAll("*,:x"),rbuggyQSA.push(",.*:")})),(support.matchesSelector=rnative.test(matches=docElem.webkitMatchesSelector||docElem.mozMatchesSelector||docElem.oMatchesSelector||docElem.msMatchesSelector))&&assert(function(div){support.disconnectedMatch=matches.call(div,"div"),matches.call(div,"[s!='']:x"),rbuggyMatches.push("!=",pseudos)}),rbuggyQSA=rbuggyQSA.length&&new RegExp(rbuggyQSA.join("|")),rbuggyMatches=rbuggyMatches.length&&new RegExp(rbuggyMatches.join("|")),contains=rnative.test(docElem.contains)||docElem.compareDocumentPosition?function(a,b){var adown=9===a.nodeType?a.documentElement:a,bup=b&&b.parentNode;return a===bup||!(!bup||1!==bup.nodeType||!(adown.contains?adown.contains(bup):a.compareDocumentPosition&&16&a.compareDocumentPosition(bup)))}:function(a,b){if(b)for(;b=b.parentNode;)if(b===a)return!0;return!1},sortOrder=docElem.compareDocumentPosition?function(a,b){if(a===b)return hasDuplicate=!0,0;var compare=b.compareDocumentPosition&&a.compareDocumentPosition&&a.compareDocumentPosition(b);return compare?1&compare||!support.sortDetached&&b.compareDocumentPosition(a)===compare?a===doc||contains(preferredDoc,a)?-1:b===doc||contains(preferredDoc,b)?1:sortInput?indexOf.call(sortInput,a)-indexOf.call(sortInput,b):0:4&compare?-1:1:a.compareDocumentPosition?-1:1}:function(a,b){var cur,i=0,aup=a.parentNode,bup=b.parentNode,ap=[a],bp=[b];if(a===b)return hasDuplicate=!0,0;if(!aup||!bup)return a===doc?-1:b===doc?1:aup?-1:bup?1:sortInput?indexOf.call(sortInput,a)-indexOf.call(sortInput,b):0;if(aup===bup)return siblingCheck(a,b);for(cur=a;cur=cur.parentNode;)ap.unshift(cur);for(cur=b;cur=cur.parentNode;)bp.unshift(cur);for(;ap[i]===bp[i];)i++;return i?siblingCheck(ap[i],bp[i]):ap[i]===preferredDoc?-1:bp[i]===preferredDoc?1:0},doc):document},Sizzle.matches=function(expr,elements){return Sizzle(expr,null,null,elements)},Sizzle.matchesSelector=function(elem,expr){if((elem.ownerDocument||elem)!==document&&setDocument(elem),expr=expr.replace(rattributeQuotes,"='$1']"),support.matchesSelector&&documentIsHTML&&(!rbuggyMatches||!rbuggyMatches.test(expr))&&(!rbuggyQSA||!rbuggyQSA.test(expr)))try{var ret=matches.call(elem,expr);if(ret||support.disconnectedMatch||elem.document&&11!==elem.document.nodeType)return ret}catch(e){}return Sizzle(expr,document,null,[elem]).length>0},Sizzle.contains=function(context,elem){return(context.ownerDocument||context)!==document&&setDocument(context),contains(context,elem)},Sizzle.attr=function(elem,name){(elem.ownerDocument||elem)!==document&&setDocument(elem);var fn=Expr.attrHandle[name.toLowerCase()],val=fn&&hasOwn.call(Expr.attrHandle,name.toLowerCase())?fn(elem,name,!documentIsHTML):undefined;return val===undefined?support.attributes||!documentIsHTML?elem.getAttribute(name):(val=elem.getAttributeNode(name))&&val.specified?val.value:null:val},Sizzle.error=function(msg){throw new Error("Syntax error, unrecognized expression: "+msg)},Sizzle.uniqueSort=function(results){var elem,duplicates=[],j=0,i=0;if(hasDuplicate=!support.detectDuplicates,sortInput=!support.sortStable&&results.slice(0),results.sort(sortOrder),hasDuplicate){for(;elem=results[i++];)elem===results[i]&&(j=duplicates.push(i));for(;j--;)results.splice(duplicates[j],1)}return results},getText=Sizzle.getText=function(elem){var node,ret="",i=0,nodeType=elem.nodeType;if(nodeType){if(1===nodeType||9===nodeType||11===nodeType){if("string"==typeof elem.textContent)return elem.textContent;for(elem=elem.firstChild;elem;elem=elem.nextSibling)ret+=getText(elem)}else if(3===nodeType||4===nodeType)return elem.nodeValue}else for(;node=elem[i];i++)ret+=getText(node);return ret},Expr=Sizzle.selectors={cacheLength:50,createPseudo:markFunction,match:matchExpr,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(match){return match[1]=match[1].replace(runescape,funescape),match[3]=(match[4]||match[5]||"").replace(runescape,funescape),"~="===match[2]&&(match[3]=" "+match[3]+" "),match.slice(0,4)},CHILD:function(match){return match[1]=match[1].toLowerCase(),"nth"===match[1].slice(0,3)?(match[3]||Sizzle.error(match[0]),match[4]=+(match[4]?match[5]+(match[6]||1):2*("even"===match[3]||"odd"===match[3])),match[5]=+(match[7]+match[8]||"odd"===match[3])):match[3]&&Sizzle.error(match[0]),match},PSEUDO:function(match){var excess,unquoted=!match[5]&&match[2];return matchExpr.CHILD.test(match[0])?null:(match[3]&&match[4]!==undefined?match[2]=match[4]:unquoted&&rpseudo.test(unquoted)&&(excess=tokenize(unquoted,!0))&&(excess=unquoted.indexOf(")",unquoted.length-excess)-unquoted.length)&&(match[0]=match[0].slice(0,excess),match[2]=unquoted.slice(0,excess)),match.slice(0,3))}},filter:{TAG:function(nodeNameSelector){var nodeName=nodeNameSelector.replace(runescape,funescape).toLowerCase();return"*"===nodeNameSelector?function(){return!0}:function(elem){return elem.nodeName&&elem.nodeName.toLowerCase()===nodeName}},CLASS:function(className){var pattern=classCache[className+" "];return pattern||(pattern=new RegExp("(^|"+whitespace+")"+className+"("+whitespace+"|$)"))&&classCache(className,function(elem){return pattern.test("string"==typeof elem.className&&elem.className||typeof elem.getAttribute!==strundefined&&elem.getAttribute("class")||"")})},ATTR:function(name,operator,check){return function(elem){var result=Sizzle.attr(elem,name);return null==result?"!="===operator:operator?(result+="","="===operator?result===check:"!="===operator?result!==check:"^="===operator?check&&0===result.indexOf(check):"*="===operator?check&&result.indexOf(check)>-1:"$="===operator?check&&result.slice(-check.length)===check:"~="===operator?(" "+result+" ").indexOf(check)>-1:"|="===operator?result===check||result.slice(0,check.length+1)===check+"-":!1):!0}},CHILD:function(type,what,argument,first,last){var simple="nth"!==type.slice(0,3),forward="last"!==type.slice(-4),ofType="of-type"===what;return 1===first&&0===last?function(elem){return!!elem.parentNode}:function(elem,context,xml){var cache,outerCache,node,diff,nodeIndex,start,dir=simple!==forward?"nextSibling":"previousSibling",parent=elem.parentNode,name=ofType&&elem.nodeName.toLowerCase(),useCache=!xml&&!ofType;if(parent){if(simple){for(;dir;){for(node=elem;node=node[dir];)if(ofType?node.nodeName.toLowerCase()===name:1===node.nodeType)return!1;start=dir="only"===type&&!start&&"nextSibling"}return!0}if(start=[forward?parent.firstChild:parent.lastChild],forward&&useCache){for(outerCache=parent[expando]||(parent[expando]={}),cache=outerCache[type]||[],nodeIndex=cache[0]===dirruns&&cache[1],diff=cache[0]===dirruns&&cache[2],node=nodeIndex&&parent.childNodes[nodeIndex];node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop();)if(1===node.nodeType&&++diff&&node===elem){outerCache[type]=[dirruns,nodeIndex,diff];break}}else if(useCache&&(cache=(elem[expando]||(elem[expando]={}))[type])&&cache[0]===dirruns)diff=cache[1];else for(;(node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop())&&((ofType?node.nodeName.toLowerCase()!==name:1!==node.nodeType)||!++diff||(useCache&&((node[expando]||(node[expando]={}))[type]=[dirruns,diff]),node!==elem)););return diff-=last,diff===first||diff%first===0&&diff/first>=0}}},PSEUDO:function(pseudo,argument){var args,fn=Expr.pseudos[pseudo]||Expr.setFilters[pseudo.toLowerCase()]||Sizzle.error("unsupported pseudo: "+pseudo);return fn[expando]?fn(argument):fn.length>1?(args=[pseudo,pseudo,"",argument],Expr.setFilters.hasOwnProperty(pseudo.toLowerCase())?markFunction(function(seed,matches){for(var idx,matched=fn(seed,argument),i=matched.length;i--;)idx=indexOf.call(seed,matched[i]),seed[idx]=!(matches[idx]=matched[i])}):function(elem){return fn(elem,0,args)}):fn}},pseudos:{not:markFunction(function(selector){var input=[],results=[],matcher=compile(selector.replace(rtrim,"$1"));return matcher[expando]?markFunction(function(seed,matches,context,xml){for(var elem,unmatched=matcher(seed,null,xml,[]),i=seed.length;i--;)(elem=unmatched[i])&&(seed[i]=!(matches[i]=elem))}):function(elem,context,xml){return input[0]=elem,matcher(input,null,xml,results),!results.pop()}}),has:markFunction(function(selector){return function(elem){return Sizzle(selector,elem).length>0}}),contains:markFunction(function(text){return function(elem){return(elem.textContent||elem.innerText||getText(elem)).indexOf(text)>-1}}),lang:markFunction(function(lang){return ridentifier.test(lang||"")||Sizzle.error("unsupported lang: "+lang),lang=lang.replace(runescape,funescape).toLowerCase(),function(elem){var elemLang;do if(elemLang=documentIsHTML?elem.lang:elem.getAttribute("xml:lang")||elem.getAttribute("lang"))return elemLang=elemLang.toLowerCase(),elemLang===lang||0===elemLang.indexOf(lang+"-");while((elem=elem.parentNode)&&1===elem.nodeType);return!1}}),target:function(elem){var hash=window.location&&window.location.hash;return hash&&hash.slice(1)===elem.id},root:function(elem){return elem===docElem},focus:function(elem){return elem===document.activeElement&&(!document.hasFocus||document.hasFocus())&&!!(elem.type||elem.href||~elem.tabIndex)},enabled:function(elem){return elem.disabled===!1},disabled:function(elem){return elem.disabled===!0},checked:function(elem){var nodeName=elem.nodeName.toLowerCase();return"input"===nodeName&&!!elem.checked||"option"===nodeName&&!!elem.selected},selected:function(elem){return elem.parentNode&&elem.parentNode.selectedIndex,elem.selected===!0},empty:function(elem){for(elem=elem.firstChild;elem;elem=elem.nextSibling)if(elem.nodeName>"@"||3===elem.nodeType||4===elem.nodeType)return!1;return!0},parent:function(elem){return!Expr.pseudos.empty(elem)},header:function(elem){return rheader.test(elem.nodeName)},input:function(elem){return rinputs.test(elem.nodeName)},button:function(elem){var name=elem.nodeName.toLowerCase();return"input"===name&&"button"===elem.type||"button"===name},text:function(elem){var attr;return"input"===elem.nodeName.toLowerCase()&&"text"===elem.type&&(null==(attr=elem.getAttribute("type"))||attr.toLowerCase()===elem.type)},first:createPositionalPseudo(function(){return[0]}),last:createPositionalPseudo(function(matchIndexes,length){return[length-1]}),eq:createPositionalPseudo(function(matchIndexes,length,argument){return[0>argument?argument+length:argument]}),even:createPositionalPseudo(function(matchIndexes,length){for(var i=0;length>i;i+=2)matchIndexes.push(i);return matchIndexes}),odd:createPositionalPseudo(function(matchIndexes,length){for(var i=1;length>i;i+=2)matchIndexes.push(i);return matchIndexes}),lt:createPositionalPseudo(function(matchIndexes,length,argument){for(var i=0>argument?argument+length:argument;--i>=0;)matchIndexes.push(i);return matchIndexes}),gt:createPositionalPseudo(function(matchIndexes,length,argument){for(var i=0>argument?argument+length:argument;++i<length;)matchIndexes.push(i);return matchIndexes})}},Expr.pseudos.nth=Expr.pseudos.eq;for(i in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})Expr.pseudos[i]=createInputPseudo(i);for(i in{submit:!0,reset:!0})Expr.pseudos[i]=createButtonPseudo(i);setFilters.prototype=Expr.filters=Expr.pseudos,Expr.setFilters=new setFilters,compile=Sizzle.compile=function(selector,group){var i,setMatchers=[],elementMatchers=[],cached=compilerCache[selector+" "];if(!cached){for(group||(group=tokenize(selector)),i=group.length;i--;)cached=matcherFromTokens(group[i]),cached[expando]?setMatchers.push(cached):elementMatchers.push(cached);cached=compilerCache(selector,matcherFromGroupMatchers(elementMatchers,setMatchers))}return cached},support.sortStable=expando.split("").sort(sortOrder).join("")===expando,support.detectDuplicates=hasDuplicate,setDocument(),support.sortDetached=assert(function(div1){return 1&div1.compareDocumentPosition(document.createElement("div"))}),assert(function(div){return div.innerHTML="<a href='#'></a>","#"===div.firstChild.getAttribute("href")})||addHandle("type|href|height|width",function(elem,name,isXML){return isXML?void 0:elem.getAttribute(name,"type"===name.toLowerCase()?1:2)}),support.attributes&&assert(function(div){return div.innerHTML="<input/>",div.firstChild.setAttribute("value",""),""===div.firstChild.getAttribute("value")})||addHandle("value",function(elem,name,isXML){return isXML||"input"!==elem.nodeName.toLowerCase()?void 0:elem.defaultValue}),assert(function(div){return null==div.getAttribute("disabled")})||addHandle(booleans,function(elem,name,isXML){var val;return isXML?void 0:(val=elem.getAttributeNode(name))&&val.specified?val.value:elem[name]===!0?name.toLowerCase():null}),jQuery.find=Sizzle,jQuery.expr=Sizzle.selectors,jQuery.expr[":"]=jQuery.expr.pseudos,jQuery.unique=Sizzle.uniqueSort,jQuery.text=Sizzle.getText,jQuery.isXMLDoc=Sizzle.isXML,jQuery.contains=Sizzle.contains}(window);var optionsCache={};jQuery.Callbacks=function(options){options="string"==typeof options?optionsCache[options]||createOptions(options):jQuery.extend({},options);var firing,memory,fired,firingLength,firingIndex,firingStart,list=[],stack=!options.once&&[],fire=function(data){for(memory=options.memory&&data,fired=!0,firingIndex=firingStart||0,firingStart=0,firingLength=list.length,firing=!0;list&&firingLength>firingIndex;firingIndex++)if(list[firingIndex].apply(data[0],data[1])===!1&&options.stopOnFalse){memory=!1;break}firing=!1,list&&(stack?stack.length&&fire(stack.shift()):memory?list=[]:self.disable())},self={add:function(){if(list){var start=list.length;!function add(args){jQuery.each(args,function(_,arg){var type=jQuery.type(arg);"function"===type?options.unique&&self.has(arg)||list.push(arg):arg&&arg.length&&"string"!==type&&add(arg)})}(arguments),firing?firingLength=list.length:memory&&(firingStart=start,fire(memory))}return this},remove:function(){return list&&jQuery.each(arguments,function(_,arg){for(var index;(index=jQuery.inArray(arg,list,index))>-1;)list.splice(index,1),firing&&(firingLength>=index&&firingLength--,firingIndex>=index&&firingIndex--)}),this},has:function(fn){return fn?jQuery.inArray(fn,list)>-1:!(!list||!list.length)},empty:function(){return list=[],firingLength=0,this},disable:function(){return list=stack=memory=undefined,this},disabled:function(){return!list},lock:function(){return stack=undefined,memory||self.disable(),this},locked:function(){return!stack},fireWith:function(context,args){return!list||fired&&!stack||(args=args||[],args=[context,args.slice?args.slice():args],firing?stack.push(args):fire(args)),this},fire:function(){return self.fireWith(this,arguments),this},fired:function(){return!!fired}};return self},jQuery.extend({Deferred:function(func){var tuples=[["resolve","done",jQuery.Callbacks("once memory"),"resolved"],["reject","fail",jQuery.Callbacks("once memory"),"rejected"],["notify","progress",jQuery.Callbacks("memory")]],state="pending",promise={state:function(){return state},always:function(){return deferred.done(arguments).fail(arguments),this},then:function(){var fns=arguments;return jQuery.Deferred(function(newDefer){jQuery.each(tuples,function(i,tuple){var action=tuple[0],fn=jQuery.isFunction(fns[i])&&fns[i];deferred[tuple[1]](function(){var returned=fn&&fn.apply(this,arguments);returned&&jQuery.isFunction(returned.promise)?returned.promise().done(newDefer.resolve).fail(newDefer.reject).progress(newDefer.notify):newDefer[action+"With"](this===promise?newDefer.promise():this,fn?[returned]:arguments)})}),fns=null}).promise()},promise:function(obj){return null!=obj?jQuery.extend(obj,promise):promise}},deferred={};return promise.pipe=promise.then,jQuery.each(tuples,function(i,tuple){var list=tuple[2],stateString=tuple[3];promise[tuple[1]]=list.add,stateString&&list.add(function(){state=stateString},tuples[1^i][2].disable,tuples[2][2].lock),deferred[tuple[0]]=function(){return deferred[tuple[0]+"With"](this===deferred?promise:this,arguments),this},deferred[tuple[0]+"With"]=list.fireWith}),promise.promise(deferred),func&&func.call(deferred,deferred),deferred},when:function(subordinate){var progressValues,progressContexts,resolveContexts,i=0,resolveValues=core_slice.call(arguments),length=resolveValues.length,remaining=1!==length||subordinate&&jQuery.isFunction(subordinate.promise)?length:0,deferred=1===remaining?subordinate:jQuery.Deferred(),updateFunc=function(i,contexts,values){return function(value){contexts[i]=this,values[i]=arguments.length>1?core_slice.call(arguments):value,values===progressValues?deferred.notifyWith(contexts,values):--remaining||deferred.resolveWith(contexts,values)}};if(length>1)for(progressValues=new Array(length),progressContexts=new Array(length),resolveContexts=new Array(length);length>i;i++)resolveValues[i]&&jQuery.isFunction(resolveValues[i].promise)?resolveValues[i].promise().done(updateFunc(i,resolveContexts,resolveValues)).fail(deferred.reject).progress(updateFunc(i,progressContexts,progressValues)):--remaining;return remaining||deferred.resolveWith(resolveContexts,resolveValues),deferred.promise()}}),jQuery.support=function(support){var all,a,input,select,fragment,opt,eventName,isSupported,i,div=document.createElement("div");if(div.setAttribute("className","t"),div.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",all=div.getElementsByTagName("*")||[],a=div.getElementsByTagName("a")[0],!a||!a.style||!all.length)return support;select=document.createElement("select"),opt=select.appendChild(document.createElement("option")),input=div.getElementsByTagName("input")[0],a.style.cssText="top:1px;float:left;opacity:.5",support.getSetAttribute="t"!==div.className,support.leadingWhitespace=3===div.firstChild.nodeType,support.tbody=!div.getElementsByTagName("tbody").length,support.htmlSerialize=!!div.getElementsByTagName("link").length,support.style=/top/.test(a.getAttribute("style")),support.hrefNormalized="/a"===a.getAttribute("href"),support.opacity=/^0.5/.test(a.style.opacity),support.cssFloat=!!a.style.cssFloat,support.checkOn=!!input.value,support.optSelected=opt.selected,support.enctype=!!document.createElement("form").enctype,support.html5Clone="<:nav></:nav>"!==document.createElement("nav").cloneNode(!0).outerHTML,support.inlineBlockNeedsLayout=!1,support.shrinkWrapBlocks=!1,support.pixelPosition=!1,support.deleteExpando=!0,support.noCloneEvent=!0,support.reliableMarginRight=!0,support.boxSizingReliable=!0,input.checked=!0,support.noCloneChecked=input.cloneNode(!0).checked,select.disabled=!0,support.optDisabled=!opt.disabled;try{delete div.test}catch(e){support.deleteExpando=!1}input=document.createElement("input"),input.setAttribute("value",""),support.input=""===input.getAttribute("value"),input.value="t",input.setAttribute("type","radio"),support.radioValue="t"===input.value,input.setAttribute("checked","t"),input.setAttribute("name","t"),fragment=document.createDocumentFragment(),fragment.appendChild(input),support.appendChecked=input.checked,support.checkClone=fragment.cloneNode(!0).cloneNode(!0).lastChild.checked,div.attachEvent&&(div.attachEvent("onclick",function(){support.noCloneEvent=!1}),div.cloneNode(!0).click());for(i in{submit:!0,change:!0,focusin:!0})div.setAttribute(eventName="on"+i,"t"),support[i+"Bubbles"]=eventName in window||div.attributes[eventName].expando===!1;div.style.backgroundClip="content-box",div.cloneNode(!0).style.backgroundClip="",support.clearCloneStyle="content-box"===div.style.backgroundClip;for(i in jQuery(support))break;return support.ownLast="0"!==i,jQuery(function(){var container,marginDiv,tds,divReset="padding:0;margin:0;border:0;display:block;box-sizing:content-box;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;",body=document.getElementsByTagName("body")[0];body&&(container=document.createElement("div"),container.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",body.appendChild(container).appendChild(div),div.innerHTML="<table><tr><td></td><td>t</td></tr></table>",tds=div.getElementsByTagName("td"),tds[0].style.cssText="padding:0;margin:0;border:0;display:none",isSupported=0===tds[0].offsetHeight,tds[0].style.display="",tds[1].style.display="none",support.reliableHiddenOffsets=isSupported&&0===tds[0].offsetHeight,div.innerHTML="",div.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",jQuery.swap(body,null!=body.style.zoom?{zoom:1}:{},function(){support.boxSizing=4===div.offsetWidth}),window.getComputedStyle&&(support.pixelPosition="1%"!==(window.getComputedStyle(div,null)||{}).top,support.boxSizingReliable="4px"===(window.getComputedStyle(div,null)||{width:"4px"}).width,marginDiv=div.appendChild(document.createElement("div")),marginDiv.style.cssText=div.style.cssText=divReset,marginDiv.style.marginRight=marginDiv.style.width="0",div.style.width="1px",support.reliableMarginRight=!parseFloat((window.getComputedStyle(marginDiv,null)||{}).marginRight)),typeof div.style.zoom!==core_strundefined&&(div.innerHTML="",div.style.cssText=divReset+"width:1px;padding:1px;display:inline;zoom:1",support.inlineBlockNeedsLayout=3===div.offsetWidth,div.style.display="block",div.innerHTML="<div></div>",div.firstChild.style.width="5px",support.shrinkWrapBlocks=3!==div.offsetWidth,support.inlineBlockNeedsLayout&&(body.style.zoom=1)),body.removeChild(container),container=div=tds=marginDiv=null)}),all=select=fragment=opt=a=input=null,support}({});var rbrace=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,rmultiDash=/([A-Z])/g;jQuery.extend({cache:{},noData:{applet:!0,embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(elem){return elem=elem.nodeType?jQuery.cache[elem[jQuery.expando]]:elem[jQuery.expando],!!elem&&!isEmptyDataObject(elem)},data:function(elem,name,data){return internalData(elem,name,data)},removeData:function(elem,name){return internalRemoveData(elem,name)},_data:function(elem,name,data){return internalData(elem,name,data,!0)},_removeData:function(elem,name){return internalRemoveData(elem,name,!0)},acceptData:function(elem){if(elem.nodeType&&1!==elem.nodeType&&9!==elem.nodeType)return!1;var noData=elem.nodeName&&jQuery.noData[elem.nodeName.toLowerCase()];return!noData||noData!==!0&&elem.getAttribute("classid")===noData}}),jQuery.fn.extend({data:function(key,value){var attrs,name,data=null,i=0,elem=this[0];if(key===undefined){if(this.length&&(data=jQuery.data(elem),1===elem.nodeType&&!jQuery._data(elem,"parsedAttrs"))){for(attrs=elem.attributes;i<attrs.length;i++)name=attrs[i].name,0===name.indexOf("data-")&&(name=jQuery.camelCase(name.slice(5)),dataAttr(elem,name,data[name]));jQuery._data(elem,"parsedAttrs",!0)}return data}return"object"==typeof key?this.each(function(){jQuery.data(this,key)}):arguments.length>1?this.each(function(){jQuery.data(this,key,value)}):elem?dataAttr(elem,key,jQuery.data(elem,key)):null},removeData:function(key){return this.each(function(){jQuery.removeData(this,key)})}}),jQuery.extend({queue:function(elem,type,data){var queue;return elem?(type=(type||"fx")+"queue",queue=jQuery._data(elem,type),data&&(!queue||jQuery.isArray(data)?queue=jQuery._data(elem,type,jQuery.makeArray(data)):queue.push(data)),queue||[]):void 0},dequeue:function(elem,type){type=type||"fx";var queue=jQuery.queue(elem,type),startLength=queue.length,fn=queue.shift(),hooks=jQuery._queueHooks(elem,type),next=function(){jQuery.dequeue(elem,type)};"inprogress"===fn&&(fn=queue.shift(),startLength--),fn&&("fx"===type&&queue.unshift("inprogress"),delete hooks.stop,fn.call(elem,next,hooks)),!startLength&&hooks&&hooks.empty.fire()},_queueHooks:function(elem,type){var key=type+"queueHooks";return jQuery._data(elem,key)||jQuery._data(elem,key,{empty:jQuery.Callbacks("once memory").add(function(){jQuery._removeData(elem,type+"queue"),jQuery._removeData(elem,key)})})}}),jQuery.fn.extend({queue:function(type,data){var setter=2;return"string"!=typeof type&&(data=type,type="fx",setter--),arguments.length<setter?jQuery.queue(this[0],type):data===undefined?this:this.each(function(){var queue=jQuery.queue(this,type,data);jQuery._queueHooks(this,type),"fx"===type&&"inprogress"!==queue[0]&&jQuery.dequeue(this,type)})},dequeue:function(type){return this.each(function(){jQuery.dequeue(this,type)})},delay:function(time,type){return time=jQuery.fx?jQuery.fx.speeds[time]||time:time,type=type||"fx",this.queue(type,function(next,hooks){var timeout=setTimeout(next,time);hooks.stop=function(){clearTimeout(timeout)}})},clearQueue:function(type){return this.queue(type||"fx",[])},promise:function(type,obj){var tmp,count=1,defer=jQuery.Deferred(),elements=this,i=this.length,resolve=function(){--count||defer.resolveWith(elements,[elements])};for("string"!=typeof type&&(obj=type,type=undefined),type=type||"fx";i--;)tmp=jQuery._data(elements[i],type+"queueHooks"),tmp&&tmp.empty&&(count++,tmp.empty.add(resolve));return resolve(),defer.promise(obj)}});var nodeHook,boolHook,rclass=/[\t\r\n\f]/g,rreturn=/\r/g,rfocusable=/^(?:input|select|textarea|button|object)$/i,rclickable=/^(?:a|area)$/i,ruseDefault=/^(?:checked|selected)$/i,getSetAttribute=jQuery.support.getSetAttribute,getSetInput=jQuery.support.input;jQuery.fn.extend({attr:function(name,value){return jQuery.access(this,jQuery.attr,name,value,arguments.length>1)},removeAttr:function(name){return this.each(function(){jQuery.removeAttr(this,name)})},prop:function(name,value){return jQuery.access(this,jQuery.prop,name,value,arguments.length>1)},removeProp:function(name){return name=jQuery.propFix[name]||name,this.each(function(){try{this[name]=undefined,delete this[name]}catch(e){}})},addClass:function(value){var classes,elem,cur,clazz,j,i=0,len=this.length,proceed="string"==typeof value&&value;if(jQuery.isFunction(value))return this.each(function(j){jQuery(this).addClass(value.call(this,j,this.className))});if(proceed)for(classes=(value||"").match(core_rnotwhite)||[];len>i;i++)if(elem=this[i],cur=1===elem.nodeType&&(elem.className?(" "+elem.className+" ").replace(rclass," "):" ")){for(j=0;clazz=classes[j++];)cur.indexOf(" "+clazz+" ")<0&&(cur+=clazz+" ");elem.className=jQuery.trim(cur)}return this},removeClass:function(value){var classes,elem,cur,clazz,j,i=0,len=this.length,proceed=0===arguments.length||"string"==typeof value&&value;if(jQuery.isFunction(value))return this.each(function(j){jQuery(this).removeClass(value.call(this,j,this.className))});if(proceed)for(classes=(value||"").match(core_rnotwhite)||[];len>i;i++)if(elem=this[i],cur=1===elem.nodeType&&(elem.className?(" "+elem.className+" ").replace(rclass," "):"")){for(j=0;clazz=classes[j++];)for(;cur.indexOf(" "+clazz+" ")>=0;)cur=cur.replace(" "+clazz+" "," ");elem.className=value?jQuery.trim(cur):""}return this},toggleClass:function(value,stateVal){var type=typeof value;return"boolean"==typeof stateVal&&"string"===type?stateVal?this.addClass(value):this.removeClass(value):jQuery.isFunction(value)?this.each(function(i){jQuery(this).toggleClass(value.call(this,i,this.className,stateVal),stateVal)}):this.each(function(){if("string"===type)for(var className,i=0,self=jQuery(this),classNames=value.match(core_rnotwhite)||[];className=classNames[i++];)self.hasClass(className)?self.removeClass(className):self.addClass(className);else type!==core_strundefined&&"boolean"!==type||(this.className&&jQuery._data(this,"__className__",this.className),this.className=this.className||value===!1?"":jQuery._data(this,"__className__")||"")})},hasClass:function(selector){for(var className=" "+selector+" ",i=0,l=this.length;l>i;i++)if(1===this[i].nodeType&&(" "+this[i].className+" ").replace(rclass," ").indexOf(className)>=0)return!0;return!1},val:function(value){var ret,hooks,isFunction,elem=this[0];{if(arguments.length)return isFunction=jQuery.isFunction(value),this.each(function(i){var val;1===this.nodeType&&(val=isFunction?value.call(this,i,jQuery(this).val()):value,null==val?val="":"number"==typeof val?val+="":jQuery.isArray(val)&&(val=jQuery.map(val,function(value){return null==value?"":value+""})),hooks=jQuery.valHooks[this.type]||jQuery.valHooks[this.nodeName.toLowerCase()],hooks&&"set"in hooks&&hooks.set(this,val,"value")!==undefined||(this.value=val))});if(elem)return hooks=jQuery.valHooks[elem.type]||jQuery.valHooks[elem.nodeName.toLowerCase()],hooks&&"get"in hooks&&(ret=hooks.get(elem,"value"))!==undefined?ret:(ret=elem.value,"string"==typeof ret?ret.replace(rreturn,""):null==ret?"":ret)}}}),jQuery.extend({valHooks:{option:{get:function(elem){var val=jQuery.find.attr(elem,"value");return null!=val?val:elem.text}},select:{get:function(elem){for(var value,option,options=elem.options,index=elem.selectedIndex,one="select-one"===elem.type||0>index,values=one?null:[],max=one?index+1:options.length,i=0>index?max:one?index:0;max>i;i++)if(option=options[i],(option.selected||i===index)&&(jQuery.support.optDisabled?!option.disabled:null===option.getAttribute("disabled"))&&(!option.parentNode.disabled||!jQuery.nodeName(option.parentNode,"optgroup"))){if(value=jQuery(option).val(),one)return value;values.push(value)}return values},set:function(elem,value){for(var optionSet,option,options=elem.options,values=jQuery.makeArray(value),i=options.length;i--;)option=options[i],(option.selected=jQuery.inArray(jQuery(option).val(),values)>=0)&&(optionSet=!0);return optionSet||(elem.selectedIndex=-1),values}}},attr:function(elem,name,value){var hooks,ret,nType=elem.nodeType;if(elem&&3!==nType&&8!==nType&&2!==nType)return typeof elem.getAttribute===core_strundefined?jQuery.prop(elem,name,value):(1===nType&&jQuery.isXMLDoc(elem)||(name=name.toLowerCase(),hooks=jQuery.attrHooks[name]||(jQuery.expr.match.bool.test(name)?boolHook:nodeHook)),value===undefined?hooks&&"get"in hooks&&null!==(ret=hooks.get(elem,name))?ret:(ret=jQuery.find.attr(elem,name),null==ret?undefined:ret):null!==value?hooks&&"set"in hooks&&(ret=hooks.set(elem,value,name))!==undefined?ret:(elem.setAttribute(name,value+""),value):void jQuery.removeAttr(elem,name))},removeAttr:function(elem,value){var name,propName,i=0,attrNames=value&&value.match(core_rnotwhite);if(attrNames&&1===elem.nodeType)for(;name=attrNames[i++];)propName=jQuery.propFix[name]||name,jQuery.expr.match.bool.test(name)?getSetInput&&getSetAttribute||!ruseDefault.test(name)?elem[propName]=!1:elem[jQuery.camelCase("default-"+name)]=elem[propName]=!1:jQuery.attr(elem,name,""),elem.removeAttribute(getSetAttribute?name:propName)},attrHooks:{type:{set:function(elem,value){if(!jQuery.support.radioValue&&"radio"===value&&jQuery.nodeName(elem,"input")){var val=elem.value;return elem.setAttribute("type",value),val&&(elem.value=val),value}}}},propFix:{"for":"htmlFor","class":"className"},prop:function(elem,name,value){var ret,hooks,notxml,nType=elem.nodeType;if(elem&&3!==nType&&8!==nType&&2!==nType)return notxml=1!==nType||!jQuery.isXMLDoc(elem),notxml&&(name=jQuery.propFix[name]||name,hooks=jQuery.propHooks[name]),value!==undefined?hooks&&"set"in hooks&&(ret=hooks.set(elem,value,name))!==undefined?ret:elem[name]=value:hooks&&"get"in hooks&&null!==(ret=hooks.get(elem,name))?ret:elem[name]},propHooks:{tabIndex:{get:function(elem){var tabindex=jQuery.find.attr(elem,"tabindex");return tabindex?parseInt(tabindex,10):rfocusable.test(elem.nodeName)||rclickable.test(elem.nodeName)&&elem.href?0:-1}}}}),boolHook={set:function(elem,value,name){return value===!1?jQuery.removeAttr(elem,name):getSetInput&&getSetAttribute||!ruseDefault.test(name)?elem.setAttribute(!getSetAttribute&&jQuery.propFix[name]||name,name):elem[jQuery.camelCase("default-"+name)]=elem[name]=!0,
name}},jQuery.each(jQuery.expr.match.bool.source.match(/\w+/g),function(i,name){var getter=jQuery.expr.attrHandle[name]||jQuery.find.attr;jQuery.expr.attrHandle[name]=getSetInput&&getSetAttribute||!ruseDefault.test(name)?function(elem,name,isXML){var fn=jQuery.expr.attrHandle[name],ret=isXML?undefined:(jQuery.expr.attrHandle[name]=undefined)!=getter(elem,name,isXML)?name.toLowerCase():null;return jQuery.expr.attrHandle[name]=fn,ret}:function(elem,name,isXML){return isXML?undefined:elem[jQuery.camelCase("default-"+name)]?name.toLowerCase():null}}),getSetInput&&getSetAttribute||(jQuery.attrHooks.value={set:function(elem,value,name){return jQuery.nodeName(elem,"input")?void(elem.defaultValue=value):nodeHook&&nodeHook.set(elem,value,name)}}),getSetAttribute||(nodeHook={set:function(elem,value,name){var ret=elem.getAttributeNode(name);return ret||elem.setAttributeNode(ret=elem.ownerDocument.createAttribute(name)),ret.value=value+="","value"===name||value===elem.getAttribute(name)?value:undefined}},jQuery.expr.attrHandle.id=jQuery.expr.attrHandle.name=jQuery.expr.attrHandle.coords=function(elem,name,isXML){var ret;return isXML?undefined:(ret=elem.getAttributeNode(name))&&""!==ret.value?ret.value:null},jQuery.valHooks.button={get:function(elem,name){var ret=elem.getAttributeNode(name);return ret&&ret.specified?ret.value:undefined},set:nodeHook.set},jQuery.attrHooks.contenteditable={set:function(elem,value,name){nodeHook.set(elem,""===value?!1:value,name)}},jQuery.each(["width","height"],function(i,name){jQuery.attrHooks[name]={set:function(elem,value){return""===value?(elem.setAttribute(name,"auto"),value):void 0}}})),jQuery.support.hrefNormalized||jQuery.each(["href","src"],function(i,name){jQuery.propHooks[name]={get:function(elem){return elem.getAttribute(name,4)}}}),jQuery.support.style||(jQuery.attrHooks.style={get:function(elem){return elem.style.cssText||undefined},set:function(elem,value){return elem.style.cssText=value+""}}),jQuery.support.optSelected||(jQuery.propHooks.selected={get:function(elem){var parent=elem.parentNode;return parent&&(parent.selectedIndex,parent.parentNode&&parent.parentNode.selectedIndex),null}}),jQuery.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){jQuery.propFix[this.toLowerCase()]=this}),jQuery.support.enctype||(jQuery.propFix.enctype="encoding"),jQuery.each(["radio","checkbox"],function(){jQuery.valHooks[this]={set:function(elem,value){return jQuery.isArray(value)?elem.checked=jQuery.inArray(jQuery(elem).val(),value)>=0:void 0}},jQuery.support.checkOn||(jQuery.valHooks[this].get=function(elem){return null===elem.getAttribute("value")?"on":elem.value})});var rformElems=/^(?:input|select|textarea)$/i,rkeyEvent=/^key/,rmouseEvent=/^(?:mouse|contextmenu)|click/,rfocusMorph=/^(?:focusinfocus|focusoutblur)$/,rtypenamespace=/^([^.]*)(?:\.(.+)|)$/;jQuery.event={global:{},add:function(elem,types,handler,data,selector){var tmp,events,t,handleObjIn,special,eventHandle,handleObj,handlers,type,namespaces,origType,elemData=jQuery._data(elem);if(elemData){for(handler.handler&&(handleObjIn=handler,handler=handleObjIn.handler,selector=handleObjIn.selector),handler.guid||(handler.guid=jQuery.guid++),(events=elemData.events)||(events=elemData.events={}),(eventHandle=elemData.handle)||(eventHandle=elemData.handle=function(e){return typeof jQuery===core_strundefined||e&&jQuery.event.triggered===e.type?undefined:jQuery.event.dispatch.apply(eventHandle.elem,arguments)},eventHandle.elem=elem),types=(types||"").match(core_rnotwhite)||[""],t=types.length;t--;)tmp=rtypenamespace.exec(types[t])||[],type=origType=tmp[1],namespaces=(tmp[2]||"").split(".").sort(),type&&(special=jQuery.event.special[type]||{},type=(selector?special.delegateType:special.bindType)||type,special=jQuery.event.special[type]||{},handleObj=jQuery.extend({type:type,origType:origType,data:data,handler:handler,guid:handler.guid,selector:selector,needsContext:selector&&jQuery.expr.match.needsContext.test(selector),namespace:namespaces.join(".")},handleObjIn),(handlers=events[type])||(handlers=events[type]=[],handlers.delegateCount=0,special.setup&&special.setup.call(elem,data,namespaces,eventHandle)!==!1||(elem.addEventListener?elem.addEventListener(type,eventHandle,!1):elem.attachEvent&&elem.attachEvent("on"+type,eventHandle))),special.add&&(special.add.call(elem,handleObj),handleObj.handler.guid||(handleObj.handler.guid=handler.guid)),selector?handlers.splice(handlers.delegateCount++,0,handleObj):handlers.push(handleObj),jQuery.event.global[type]=!0);elem=null}},remove:function(elem,types,handler,selector,mappedTypes){var j,handleObj,tmp,origCount,t,events,special,handlers,type,namespaces,origType,elemData=jQuery.hasData(elem)&&jQuery._data(elem);if(elemData&&(events=elemData.events)){for(types=(types||"").match(core_rnotwhite)||[""],t=types.length;t--;)if(tmp=rtypenamespace.exec(types[t])||[],type=origType=tmp[1],namespaces=(tmp[2]||"").split(".").sort(),type){for(special=jQuery.event.special[type]||{},type=(selector?special.delegateType:special.bindType)||type,handlers=events[type]||[],tmp=tmp[2]&&new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)"),origCount=j=handlers.length;j--;)handleObj=handlers[j],!mappedTypes&&origType!==handleObj.origType||handler&&handler.guid!==handleObj.guid||tmp&&!tmp.test(handleObj.namespace)||selector&&selector!==handleObj.selector&&("**"!==selector||!handleObj.selector)||(handlers.splice(j,1),handleObj.selector&&handlers.delegateCount--,special.remove&&special.remove.call(elem,handleObj));origCount&&!handlers.length&&(special.teardown&&special.teardown.call(elem,namespaces,elemData.handle)!==!1||jQuery.removeEvent(elem,type,elemData.handle),delete events[type])}else for(type in events)jQuery.event.remove(elem,type+types[t],handler,selector,!0);jQuery.isEmptyObject(events)&&(delete elemData.handle,jQuery._removeData(elem,"events"))}},trigger:function(event,data,elem,onlyHandlers){var handle,ontype,cur,bubbleType,special,tmp,i,eventPath=[elem||document],type=core_hasOwn.call(event,"type")?event.type:event,namespaces=core_hasOwn.call(event,"namespace")?event.namespace.split("."):[];if(cur=tmp=elem=elem||document,3!==elem.nodeType&&8!==elem.nodeType&&!rfocusMorph.test(type+jQuery.event.triggered)&&(type.indexOf(".")>=0&&(namespaces=type.split("."),type=namespaces.shift(),namespaces.sort()),ontype=type.indexOf(":")<0&&"on"+type,event=event[jQuery.expando]?event:new jQuery.Event(type,"object"==typeof event&&event),event.isTrigger=onlyHandlers?2:3,event.namespace=namespaces.join("."),event.namespace_re=event.namespace?new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,event.result=undefined,event.target||(event.target=elem),data=null==data?[event]:jQuery.makeArray(data,[event]),special=jQuery.event.special[type]||{},onlyHandlers||!special.trigger||special.trigger.apply(elem,data)!==!1)){if(!onlyHandlers&&!special.noBubble&&!jQuery.isWindow(elem)){for(bubbleType=special.delegateType||type,rfocusMorph.test(bubbleType+type)||(cur=cur.parentNode);cur;cur=cur.parentNode)eventPath.push(cur),tmp=cur;tmp===(elem.ownerDocument||document)&&eventPath.push(tmp.defaultView||tmp.parentWindow||window)}for(i=0;(cur=eventPath[i++])&&!event.isPropagationStopped();)event.type=i>1?bubbleType:special.bindType||type,handle=(jQuery._data(cur,"events")||{})[event.type]&&jQuery._data(cur,"handle"),handle&&handle.apply(cur,data),handle=ontype&&cur[ontype],handle&&jQuery.acceptData(cur)&&handle.apply&&handle.apply(cur,data)===!1&&event.preventDefault();if(event.type=type,!onlyHandlers&&!event.isDefaultPrevented()&&(!special._default||special._default.apply(eventPath.pop(),data)===!1)&&jQuery.acceptData(elem)&&ontype&&elem[type]&&!jQuery.isWindow(elem)){tmp=elem[ontype],tmp&&(elem[ontype]=null),jQuery.event.triggered=type;try{elem[type]()}catch(e){}jQuery.event.triggered=undefined,tmp&&(elem[ontype]=tmp)}return event.result}},dispatch:function(event){event=jQuery.event.fix(event);var i,ret,handleObj,matched,j,handlerQueue=[],args=core_slice.call(arguments),handlers=(jQuery._data(this,"events")||{})[event.type]||[],special=jQuery.event.special[event.type]||{};if(args[0]=event,event.delegateTarget=this,!special.preDispatch||special.preDispatch.call(this,event)!==!1){for(handlerQueue=jQuery.event.handlers.call(this,event,handlers),i=0;(matched=handlerQueue[i++])&&!event.isPropagationStopped();)for(event.currentTarget=matched.elem,j=0;(handleObj=matched.handlers[j++])&&!event.isImmediatePropagationStopped();)event.namespace_re&&!event.namespace_re.test(handleObj.namespace)||(event.handleObj=handleObj,event.data=handleObj.data,ret=((jQuery.event.special[handleObj.origType]||{}).handle||handleObj.handler).apply(matched.elem,args),ret!==undefined&&(event.result=ret)===!1&&(event.preventDefault(),event.stopPropagation()));return special.postDispatch&&special.postDispatch.call(this,event),event.result}},handlers:function(event,handlers){var sel,handleObj,matches,i,handlerQueue=[],delegateCount=handlers.delegateCount,cur=event.target;if(delegateCount&&cur.nodeType&&(!event.button||"click"!==event.type))for(;cur!=this;cur=cur.parentNode||this)if(1===cur.nodeType&&(cur.disabled!==!0||"click"!==event.type)){for(matches=[],i=0;delegateCount>i;i++)handleObj=handlers[i],sel=handleObj.selector+" ",matches[sel]===undefined&&(matches[sel]=handleObj.needsContext?jQuery(sel,this).index(cur)>=0:jQuery.find(sel,this,null,[cur]).length),matches[sel]&&matches.push(handleObj);matches.length&&handlerQueue.push({elem:cur,handlers:matches})}return delegateCount<handlers.length&&handlerQueue.push({elem:this,handlers:handlers.slice(delegateCount)}),handlerQueue},fix:function(event){if(event[jQuery.expando])return event;var i,prop,copy,type=event.type,originalEvent=event,fixHook=this.fixHooks[type];for(fixHook||(this.fixHooks[type]=fixHook=rmouseEvent.test(type)?this.mouseHooks:rkeyEvent.test(type)?this.keyHooks:{}),copy=fixHook.props?this.props.concat(fixHook.props):this.props,event=new jQuery.Event(originalEvent),i=copy.length;i--;)prop=copy[i],event[prop]=originalEvent[prop];return event.target||(event.target=originalEvent.srcElement||document),3===event.target.nodeType&&(event.target=event.target.parentNode),event.metaKey=!!event.metaKey,fixHook.filter?fixHook.filter(event,originalEvent):event},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(event,original){return null==event.which&&(event.which=null!=original.charCode?original.charCode:original.keyCode),event}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(event,original){var body,eventDoc,doc,button=original.button,fromElement=original.fromElement;return null==event.pageX&&null!=original.clientX&&(eventDoc=event.target.ownerDocument||document,doc=eventDoc.documentElement,body=eventDoc.body,event.pageX=original.clientX+(doc&&doc.scrollLeft||body&&body.scrollLeft||0)-(doc&&doc.clientLeft||body&&body.clientLeft||0),event.pageY=original.clientY+(doc&&doc.scrollTop||body&&body.scrollTop||0)-(doc&&doc.clientTop||body&&body.clientTop||0)),!event.relatedTarget&&fromElement&&(event.relatedTarget=fromElement===event.target?original.toElement:fromElement),event.which||button===undefined||(event.which=1&button?1:2&button?3:4&button?2:0),event}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==safeActiveElement()&&this.focus)try{return this.focus(),!1}catch(e){}},delegateType:"focusin"},blur:{trigger:function(){return this===safeActiveElement()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return jQuery.nodeName(this,"input")&&"checkbox"===this.type&&this.click?(this.click(),!1):void 0},_default:function(event){return jQuery.nodeName(event.target,"a")}},beforeunload:{postDispatch:function(event){event.result!==undefined&&(event.originalEvent.returnValue=event.result)}}},simulate:function(type,elem,event,bubble){var e=jQuery.extend(new jQuery.Event,event,{type:type,isSimulated:!0,originalEvent:{}});bubble?jQuery.event.trigger(e,null,elem):jQuery.event.dispatch.call(elem,e),e.isDefaultPrevented()&&event.preventDefault()}},jQuery.removeEvent=document.removeEventListener?function(elem,type,handle){elem.removeEventListener&&elem.removeEventListener(type,handle,!1)}:function(elem,type,handle){var name="on"+type;elem.detachEvent&&(typeof elem[name]===core_strundefined&&(elem[name]=null),elem.detachEvent(name,handle))},jQuery.Event=function(src,props){return this instanceof jQuery.Event?(src&&src.type?(this.originalEvent=src,this.type=src.type,this.isDefaultPrevented=src.defaultPrevented||src.returnValue===!1||src.getPreventDefault&&src.getPreventDefault()?returnTrue:returnFalse):this.type=src,props&&jQuery.extend(this,props),this.timeStamp=src&&src.timeStamp||jQuery.now(),void(this[jQuery.expando]=!0)):new jQuery.Event(src,props)},jQuery.Event.prototype={isDefaultPrevented:returnFalse,isPropagationStopped:returnFalse,isImmediatePropagationStopped:returnFalse,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=returnTrue,e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=returnTrue,e&&(e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=returnTrue,this.stopPropagation()}},jQuery.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(orig,fix){jQuery.event.special[orig]={delegateType:fix,bindType:fix,handle:function(event){var ret,target=this,related=event.relatedTarget,handleObj=event.handleObj;return related&&(related===target||jQuery.contains(target,related))||(event.type=handleObj.origType,ret=handleObj.handler.apply(this,arguments),event.type=fix),ret}}}),jQuery.support.submitBubbles||(jQuery.event.special.submit={setup:function(){return jQuery.nodeName(this,"form")?!1:void jQuery.event.add(this,"click._submit keypress._submit",function(e){var elem=e.target,form=jQuery.nodeName(elem,"input")||jQuery.nodeName(elem,"button")?elem.form:undefined;form&&!jQuery._data(form,"submitBubbles")&&(jQuery.event.add(form,"submit._submit",function(event){event._submit_bubble=!0}),jQuery._data(form,"submitBubbles",!0))})},postDispatch:function(event){event._submit_bubble&&(delete event._submit_bubble,this.parentNode&&!event.isTrigger&&jQuery.event.simulate("submit",this.parentNode,event,!0))},teardown:function(){return jQuery.nodeName(this,"form")?!1:void jQuery.event.remove(this,"._submit")}}),jQuery.support.changeBubbles||(jQuery.event.special.change={setup:function(){return rformElems.test(this.nodeName)?("checkbox"!==this.type&&"radio"!==this.type||(jQuery.event.add(this,"propertychange._change",function(event){"checked"===event.originalEvent.propertyName&&(this._just_changed=!0)}),jQuery.event.add(this,"click._change",function(event){this._just_changed&&!event.isTrigger&&(this._just_changed=!1),jQuery.event.simulate("change",this,event,!0)})),!1):void jQuery.event.add(this,"beforeactivate._change",function(e){var elem=e.target;rformElems.test(elem.nodeName)&&!jQuery._data(elem,"changeBubbles")&&(jQuery.event.add(elem,"change._change",function(event){!this.parentNode||event.isSimulated||event.isTrigger||jQuery.event.simulate("change",this.parentNode,event,!0)}),jQuery._data(elem,"changeBubbles",!0))})},handle:function(event){var elem=event.target;return this!==elem||event.isSimulated||event.isTrigger||"radio"!==elem.type&&"checkbox"!==elem.type?event.handleObj.handler.apply(this,arguments):void 0},teardown:function(){return jQuery.event.remove(this,"._change"),!rformElems.test(this.nodeName)}}),jQuery.support.focusinBubbles||jQuery.each({focus:"focusin",blur:"focusout"},function(orig,fix){var attaches=0,handler=function(event){jQuery.event.simulate(fix,event.target,jQuery.event.fix(event),!0)};jQuery.event.special[fix]={setup:function(){0===attaches++&&document.addEventListener(orig,handler,!0)},teardown:function(){0===--attaches&&document.removeEventListener(orig,handler,!0)}}}),jQuery.fn.extend({on:function(types,selector,data,fn,one){var type,origFn;if("object"==typeof types){"string"!=typeof selector&&(data=data||selector,selector=undefined);for(type in types)this.on(type,selector,data,types[type],one);return this}if(null==data&&null==fn?(fn=selector,data=selector=undefined):null==fn&&("string"==typeof selector?(fn=data,data=undefined):(fn=data,data=selector,selector=undefined)),fn===!1)fn=returnFalse;else if(!fn)return this;return 1===one&&(origFn=fn,fn=function(event){return jQuery().off(event),origFn.apply(this,arguments)},fn.guid=origFn.guid||(origFn.guid=jQuery.guid++)),this.each(function(){jQuery.event.add(this,types,fn,data,selector)})},one:function(types,selector,data,fn){return this.on(types,selector,data,fn,1)},off:function(types,selector,fn){var handleObj,type;if(types&&types.preventDefault&&types.handleObj)return handleObj=types.handleObj,jQuery(types.delegateTarget).off(handleObj.namespace?handleObj.origType+"."+handleObj.namespace:handleObj.origType,handleObj.selector,handleObj.handler),this;if("object"==typeof types){for(type in types)this.off(type,selector,types[type]);return this}return selector!==!1&&"function"!=typeof selector||(fn=selector,selector=undefined),fn===!1&&(fn=returnFalse),this.each(function(){jQuery.event.remove(this,types,fn,selector)})},trigger:function(type,data){return this.each(function(){jQuery.event.trigger(type,data,this)})},triggerHandler:function(type,data){var elem=this[0];return elem?jQuery.event.trigger(type,data,elem,!0):void 0}});var isSimple=/^.[^:#\[\.,]*$/,rparentsprev=/^(?:parents|prev(?:Until|All))/,rneedsContext=jQuery.expr.match.needsContext,guaranteedUnique={children:!0,contents:!0,next:!0,prev:!0};jQuery.fn.extend({find:function(selector){var i,ret=[],self=this,len=self.length;if("string"!=typeof selector)return this.pushStack(jQuery(selector).filter(function(){for(i=0;len>i;i++)if(jQuery.contains(self[i],this))return!0}));for(i=0;len>i;i++)jQuery.find(selector,self[i],ret);return ret=this.pushStack(len>1?jQuery.unique(ret):ret),ret.selector=this.selector?this.selector+" "+selector:selector,ret},has:function(target){var i,targets=jQuery(target,this),len=targets.length;return this.filter(function(){for(i=0;len>i;i++)if(jQuery.contains(this,targets[i]))return!0})},not:function(selector){return this.pushStack(winnow(this,selector||[],!0))},filter:function(selector){return this.pushStack(winnow(this,selector||[],!1))},is:function(selector){return!!winnow(this,"string"==typeof selector&&rneedsContext.test(selector)?jQuery(selector):selector||[],!1).length},closest:function(selectors,context){for(var cur,i=0,l=this.length,ret=[],pos=rneedsContext.test(selectors)||"string"!=typeof selectors?jQuery(selectors,context||this.context):0;l>i;i++)for(cur=this[i];cur&&cur!==context;cur=cur.parentNode)if(cur.nodeType<11&&(pos?pos.index(cur)>-1:1===cur.nodeType&&jQuery.find.matchesSelector(cur,selectors))){cur=ret.push(cur);break}return this.pushStack(ret.length>1?jQuery.unique(ret):ret)},index:function(elem){return elem?"string"==typeof elem?jQuery.inArray(this[0],jQuery(elem)):jQuery.inArray(elem.jquery?elem[0]:elem,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(selector,context){var set="string"==typeof selector?jQuery(selector,context):jQuery.makeArray(selector&&selector.nodeType?[selector]:selector),all=jQuery.merge(this.get(),set);return this.pushStack(jQuery.unique(all))},addBack:function(selector){return this.add(null==selector?this.prevObject:this.prevObject.filter(selector))}}),jQuery.each({parent:function(elem){var parent=elem.parentNode;return parent&&11!==parent.nodeType?parent:null},parents:function(elem){return jQuery.dir(elem,"parentNode")},parentsUntil:function(elem,i,until){return jQuery.dir(elem,"parentNode",until)},next:function(elem){return sibling(elem,"nextSibling")},prev:function(elem){return sibling(elem,"previousSibling")},nextAll:function(elem){return jQuery.dir(elem,"nextSibling")},prevAll:function(elem){return jQuery.dir(elem,"previousSibling")},nextUntil:function(elem,i,until){return jQuery.dir(elem,"nextSibling",until)},prevUntil:function(elem,i,until){return jQuery.dir(elem,"previousSibling",until)},siblings:function(elem){return jQuery.sibling((elem.parentNode||{}).firstChild,elem)},children:function(elem){return jQuery.sibling(elem.firstChild)},contents:function(elem){return jQuery.nodeName(elem,"iframe")?elem.contentDocument||elem.contentWindow.document:jQuery.merge([],elem.childNodes)}},function(name,fn){jQuery.fn[name]=function(until,selector){var ret=jQuery.map(this,fn,until);return"Until"!==name.slice(-5)&&(selector=until),selector&&"string"==typeof selector&&(ret=jQuery.filter(selector,ret)),this.length>1&&(guaranteedUnique[name]||(ret=jQuery.unique(ret)),rparentsprev.test(name)&&(ret=ret.reverse())),this.pushStack(ret)}}),jQuery.extend({filter:function(expr,elems,not){var elem=elems[0];return not&&(expr=":not("+expr+")"),1===elems.length&&1===elem.nodeType?jQuery.find.matchesSelector(elem,expr)?[elem]:[]:jQuery.find.matches(expr,jQuery.grep(elems,function(elem){return 1===elem.nodeType}))},dir:function(elem,dir,until){for(var matched=[],cur=elem[dir];cur&&9!==cur.nodeType&&(until===undefined||1!==cur.nodeType||!jQuery(cur).is(until));)1===cur.nodeType&&matched.push(cur),cur=cur[dir];return matched},sibling:function(n,elem){for(var r=[];n;n=n.nextSibling)1===n.nodeType&&n!==elem&&r.push(n);return r}});var nodeNames="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",rinlinejQuery=/ jQuery\d+="(?:null|\d+)"/g,rnoshimcache=new RegExp("<(?:"+nodeNames+")[\\s/>]","i"),rleadingWhitespace=/^\s+/,rxhtmlTag=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,rtagName=/<([\w:]+)/,rtbody=/<tbody/i,rhtml=/<|&#?\w+;/,rnoInnerhtml=/<(?:script|style|link)/i,manipulation_rcheckableType=/^(?:checkbox|radio)$/i,rchecked=/checked\s*(?:[^=]|=\s*.checked.)/i,rscriptType=/^$|\/(?:java|ecma)script/i,rscriptTypeMasked=/^true\/(.*)/,rcleanScript=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,wrapMap={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:jQuery.support.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},safeFragment=createSafeFragment(document),fragmentDiv=safeFragment.appendChild(document.createElement("div"));wrapMap.optgroup=wrapMap.option,wrapMap.tbody=wrapMap.tfoot=wrapMap.colgroup=wrapMap.caption=wrapMap.thead,wrapMap.th=wrapMap.td,jQuery.fn.extend({text:function(value){return jQuery.access(this,function(value){return value===undefined?jQuery.text(this):this.empty().append((this[0]&&this[0].ownerDocument||document).createTextNode(value))},null,value,arguments.length)},append:function(){return this.domManip(arguments,function(elem){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var target=manipulationTarget(this,elem);target.appendChild(elem)}})},prepend:function(){return this.domManip(arguments,function(elem){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var target=manipulationTarget(this,elem);target.insertBefore(elem,target.firstChild)}})},before:function(){return this.domManip(arguments,function(elem){this.parentNode&&this.parentNode.insertBefore(elem,this)})},after:function(){return this.domManip(arguments,function(elem){this.parentNode&&this.parentNode.insertBefore(elem,this.nextSibling)})},remove:function(selector,keepData){for(var elem,elems=selector?jQuery.filter(selector,this):this,i=0;null!=(elem=elems[i]);i++)keepData||1!==elem.nodeType||jQuery.cleanData(getAll(elem)),elem.parentNode&&(keepData&&jQuery.contains(elem.ownerDocument,elem)&&setGlobalEval(getAll(elem,"script")),elem.parentNode.removeChild(elem));return this},empty:function(){for(var elem,i=0;null!=(elem=this[i]);i++){for(1===elem.nodeType&&jQuery.cleanData(getAll(elem,!1));elem.firstChild;)elem.removeChild(elem.firstChild);elem.options&&jQuery.nodeName(elem,"select")&&(elem.options.length=0)}return this},clone:function(dataAndEvents,deepDataAndEvents){return dataAndEvents=null==dataAndEvents?!1:dataAndEvents,deepDataAndEvents=null==deepDataAndEvents?dataAndEvents:deepDataAndEvents,this.map(function(){return jQuery.clone(this,dataAndEvents,deepDataAndEvents)})},html:function(value){return jQuery.access(this,function(value){var elem=this[0]||{},i=0,l=this.length;if(value===undefined)return 1===elem.nodeType?elem.innerHTML.replace(rinlinejQuery,""):undefined;if("string"==typeof value&&!rnoInnerhtml.test(value)&&(jQuery.support.htmlSerialize||!rnoshimcache.test(value))&&(jQuery.support.leadingWhitespace||!rleadingWhitespace.test(value))&&!wrapMap[(rtagName.exec(value)||["",""])[1].toLowerCase()]){value=value.replace(rxhtmlTag,"<$1></$2>");try{for(;l>i;i++)elem=this[i]||{},1===elem.nodeType&&(jQuery.cleanData(getAll(elem,!1)),elem.innerHTML=value);elem=0}catch(e){}}elem&&this.empty().append(value)},null,value,arguments.length)},replaceWith:function(){var args=jQuery.map(this,function(elem){return[elem.nextSibling,elem.parentNode]}),i=0;return this.domManip(arguments,function(elem){var next=args[i++],parent=args[i++];parent&&(next&&next.parentNode!==parent&&(next=this.nextSibling),jQuery(this).remove(),parent.insertBefore(elem,next))},!0),i?this:this.remove()},detach:function(selector){return this.remove(selector,!0)},domManip:function(args,callback,allowIntersection){args=core_concat.apply([],args);var first,node,hasScripts,scripts,doc,fragment,i=0,l=this.length,set=this,iNoClone=l-1,value=args[0],isFunction=jQuery.isFunction(value);if(isFunction||!(1>=l||"string"!=typeof value||jQuery.support.checkClone)&&rchecked.test(value))return this.each(function(index){var self=set.eq(index);isFunction&&(args[0]=value.call(this,index,self.html())),self.domManip(args,callback,allowIntersection)});if(l&&(fragment=jQuery.buildFragment(args,this[0].ownerDocument,!1,!allowIntersection&&this),first=fragment.firstChild,1===fragment.childNodes.length&&(fragment=first),first)){for(scripts=jQuery.map(getAll(fragment,"script"),disableScript),hasScripts=scripts.length;l>i;i++)node=fragment,i!==iNoClone&&(node=jQuery.clone(node,!0,!0),hasScripts&&jQuery.merge(scripts,getAll(node,"script"))),callback.call(this[i],node,i);if(hasScripts)for(doc=scripts[scripts.length-1].ownerDocument,jQuery.map(scripts,restoreScript),i=0;hasScripts>i;i++)node=scripts[i],rscriptType.test(node.type||"")&&!jQuery._data(node,"globalEval")&&jQuery.contains(doc,node)&&(node.src?jQuery._evalUrl(node.src):jQuery.globalEval((node.text||node.textContent||node.innerHTML||"").replace(rcleanScript,"")));fragment=first=null}return this}}),jQuery.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(name,original){jQuery.fn[name]=function(selector){for(var elems,i=0,ret=[],insert=jQuery(selector),last=insert.length-1;last>=i;i++)elems=i===last?this:this.clone(!0),jQuery(insert[i])[original](elems),core_push.apply(ret,elems.get());return this.pushStack(ret)}}),jQuery.extend({clone:function(elem,dataAndEvents,deepDataAndEvents){var destElements,node,clone,i,srcElements,inPage=jQuery.contains(elem.ownerDocument,elem);if(jQuery.support.html5Clone||jQuery.isXMLDoc(elem)||!rnoshimcache.test("<"+elem.nodeName+">")?clone=elem.cloneNode(!0):(fragmentDiv.innerHTML=elem.outerHTML,fragmentDiv.removeChild(clone=fragmentDiv.firstChild)),!(jQuery.support.noCloneEvent&&jQuery.support.noCloneChecked||1!==elem.nodeType&&11!==elem.nodeType||jQuery.isXMLDoc(elem)))for(destElements=getAll(clone),srcElements=getAll(elem),i=0;null!=(node=srcElements[i]);++i)destElements[i]&&fixCloneNodeIssues(node,destElements[i]);if(dataAndEvents)if(deepDataAndEvents)for(srcElements=srcElements||getAll(elem),destElements=destElements||getAll(clone),i=0;null!=(node=srcElements[i]);i++)cloneCopyEvent(node,destElements[i]);else cloneCopyEvent(elem,clone);return destElements=getAll(clone,"script"),destElements.length>0&&setGlobalEval(destElements,!inPage&&getAll(elem,"script")),destElements=srcElements=node=null,clone},buildFragment:function(elems,context,scripts,selection){for(var j,elem,contains,tmp,tag,tbody,wrap,l=elems.length,safe=createSafeFragment(context),nodes=[],i=0;l>i;i++)if(elem=elems[i],elem||0===elem)if("object"===jQuery.type(elem))jQuery.merge(nodes,elem.nodeType?[elem]:elem);else if(rhtml.test(elem)){for(tmp=tmp||safe.appendChild(context.createElement("div")),tag=(rtagName.exec(elem)||["",""])[1].toLowerCase(),wrap=wrapMap[tag]||wrapMap._default,tmp.innerHTML=wrap[1]+elem.replace(rxhtmlTag,"<$1></$2>")+wrap[2],j=wrap[0];j--;)tmp=tmp.lastChild;if(!jQuery.support.leadingWhitespace&&rleadingWhitespace.test(elem)&&nodes.push(context.createTextNode(rleadingWhitespace.exec(elem)[0])),!jQuery.support.tbody)for(elem="table"!==tag||rtbody.test(elem)?"<table>"!==wrap[1]||rtbody.test(elem)?0:tmp:tmp.firstChild,j=elem&&elem.childNodes.length;j--;)jQuery.nodeName(tbody=elem.childNodes[j],"tbody")&&!tbody.childNodes.length&&elem.removeChild(tbody);for(jQuery.merge(nodes,tmp.childNodes),tmp.textContent="";tmp.firstChild;)tmp.removeChild(tmp.firstChild);tmp=safe.lastChild}else nodes.push(context.createTextNode(elem));for(tmp&&safe.removeChild(tmp),jQuery.support.appendChecked||jQuery.grep(getAll(nodes,"input"),fixDefaultChecked),i=0;elem=nodes[i++];)if((!selection||-1===jQuery.inArray(elem,selection))&&(contains=jQuery.contains(elem.ownerDocument,elem),tmp=getAll(safe.appendChild(elem),"script"),contains&&setGlobalEval(tmp),scripts))for(j=0;elem=tmp[j++];)rscriptType.test(elem.type||"")&&scripts.push(elem);return tmp=null,safe},cleanData:function(elems,acceptData){for(var elem,type,id,data,i=0,internalKey=jQuery.expando,cache=jQuery.cache,deleteExpando=jQuery.support.deleteExpando,special=jQuery.event.special;null!=(elem=elems[i]);i++)if((acceptData||jQuery.acceptData(elem))&&(id=elem[internalKey],data=id&&cache[id])){if(data.events)for(type in data.events)special[type]?jQuery.event.remove(elem,type):jQuery.removeEvent(elem,type,data.handle);cache[id]&&(delete cache[id],deleteExpando?delete elem[internalKey]:typeof elem.removeAttribute!==core_strundefined?elem.removeAttribute(internalKey):elem[internalKey]=null,core_deletedIds.push(id))}},_evalUrl:function(url){return jQuery.ajax({url:url,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})}}),jQuery.fn.extend({wrapAll:function(html){if(jQuery.isFunction(html))return this.each(function(i){jQuery(this).wrapAll(html.call(this,i))});if(this[0]){var wrap=jQuery(html,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&wrap.insertBefore(this[0]),wrap.map(function(){for(var elem=this;elem.firstChild&&1===elem.firstChild.nodeType;)elem=elem.firstChild;return elem}).append(this)}return this},wrapInner:function(html){return jQuery.isFunction(html)?this.each(function(i){jQuery(this).wrapInner(html.call(this,i))}):this.each(function(){var self=jQuery(this),contents=self.contents();contents.length?contents.wrapAll(html):self.append(html)})},wrap:function(html){var isFunction=jQuery.isFunction(html);return this.each(function(i){jQuery(this).wrapAll(isFunction?html.call(this,i):html)})},unwrap:function(){return this.parent().each(function(){jQuery.nodeName(this,"body")||jQuery(this).replaceWith(this.childNodes)}).end()}});var iframe,getStyles,curCSS,ralpha=/alpha\([^)]*\)/i,ropacity=/opacity\s*=\s*([^)]*)/,rposition=/^(top|right|bottom|left)$/,rdisplayswap=/^(none|table(?!-c[ea]).+)/,rmargin=/^margin/,rnumsplit=new RegExp("^("+core_pnum+")(.*)$","i"),rnumnonpx=new RegExp("^("+core_pnum+")(?!px)[a-z%]+$","i"),rrelNum=new RegExp("^([+-])=("+core_pnum+")","i"),elemdisplay={
BODY:"block"},cssShow={position:"absolute",visibility:"hidden",display:"block"},cssNormalTransform={letterSpacing:0,fontWeight:400},cssExpand=["Top","Right","Bottom","Left"],cssPrefixes=["Webkit","O","Moz","ms"];jQuery.fn.extend({css:function(name,value){return jQuery.access(this,function(elem,name,value){var len,styles,map={},i=0;if(jQuery.isArray(name)){for(styles=getStyles(elem),len=name.length;len>i;i++)map[name[i]]=jQuery.css(elem,name[i],!1,styles);return map}return value!==undefined?jQuery.style(elem,name,value):jQuery.css(elem,name)},name,value,arguments.length>1)},show:function(){return showHide(this,!0)},hide:function(){return showHide(this)},toggle:function(state){return"boolean"==typeof state?state?this.show():this.hide():this.each(function(){isHidden(this)?jQuery(this).show():jQuery(this).hide()})}}),jQuery.extend({cssHooks:{opacity:{get:function(elem,computed){if(computed){var ret=curCSS(elem,"opacity");return""===ret?"1":ret}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":jQuery.support.cssFloat?"cssFloat":"styleFloat"},style:function(elem,name,value,extra){if(elem&&3!==elem.nodeType&&8!==elem.nodeType&&elem.style){var ret,type,hooks,origName=jQuery.camelCase(name),style=elem.style;if(name=jQuery.cssProps[origName]||(jQuery.cssProps[origName]=vendorPropName(style,origName)),hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName],value===undefined)return hooks&&"get"in hooks&&(ret=hooks.get(elem,!1,extra))!==undefined?ret:style[name];if(type=typeof value,"string"===type&&(ret=rrelNum.exec(value))&&(value=(ret[1]+1)*ret[2]+parseFloat(jQuery.css(elem,name)),type="number"),!(null==value||"number"===type&&isNaN(value)||("number"!==type||jQuery.cssNumber[origName]||(value+="px"),jQuery.support.clearCloneStyle||""!==value||0!==name.indexOf("background")||(style[name]="inherit"),hooks&&"set"in hooks&&(value=hooks.set(elem,value,extra))===undefined)))try{style[name]=value}catch(e){}}},css:function(elem,name,extra,styles){var num,val,hooks,origName=jQuery.camelCase(name);return name=jQuery.cssProps[origName]||(jQuery.cssProps[origName]=vendorPropName(elem.style,origName)),hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName],hooks&&"get"in hooks&&(val=hooks.get(elem,!0,extra)),val===undefined&&(val=curCSS(elem,name,styles)),"normal"===val&&name in cssNormalTransform&&(val=cssNormalTransform[name]),""===extra||extra?(num=parseFloat(val),extra===!0||jQuery.isNumeric(num)?num||0:val):val}}),window.getComputedStyle?(getStyles=function(elem){return window.getComputedStyle(elem,null)},curCSS=function(elem,name,_computed){var width,minWidth,maxWidth,computed=_computed||getStyles(elem),ret=computed?computed.getPropertyValue(name)||computed[name]:undefined,style=elem.style;return computed&&(""!==ret||jQuery.contains(elem.ownerDocument,elem)||(ret=jQuery.style(elem,name)),rnumnonpx.test(ret)&&rmargin.test(name)&&(width=style.width,minWidth=style.minWidth,maxWidth=style.maxWidth,style.minWidth=style.maxWidth=style.width=ret,ret=computed.width,style.width=width,style.minWidth=minWidth,style.maxWidth=maxWidth)),ret}):document.documentElement.currentStyle&&(getStyles=function(elem){return elem.currentStyle},curCSS=function(elem,name,_computed){var left,rs,rsLeft,computed=_computed||getStyles(elem),ret=computed?computed[name]:undefined,style=elem.style;return null==ret&&style&&style[name]&&(ret=style[name]),rnumnonpx.test(ret)&&!rposition.test(name)&&(left=style.left,rs=elem.runtimeStyle,rsLeft=rs&&rs.left,rsLeft&&(rs.left=elem.currentStyle.left),style.left="fontSize"===name?"1em":ret,ret=style.pixelLeft+"px",style.left=left,rsLeft&&(rs.left=rsLeft)),""===ret?"auto":ret}),jQuery.each(["height","width"],function(i,name){jQuery.cssHooks[name]={get:function(elem,computed,extra){return computed?0===elem.offsetWidth&&rdisplayswap.test(jQuery.css(elem,"display"))?jQuery.swap(elem,cssShow,function(){return getWidthOrHeight(elem,name,extra)}):getWidthOrHeight(elem,name,extra):void 0},set:function(elem,value,extra){var styles=extra&&getStyles(elem);return setPositiveNumber(elem,value,extra?augmentWidthOrHeight(elem,name,extra,jQuery.support.boxSizing&&"border-box"===jQuery.css(elem,"boxSizing",!1,styles),styles):0)}}}),jQuery.support.opacity||(jQuery.cssHooks.opacity={get:function(elem,computed){return ropacity.test((computed&&elem.currentStyle?elem.currentStyle.filter:elem.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":computed?"1":""},set:function(elem,value){var style=elem.style,currentStyle=elem.currentStyle,opacity=jQuery.isNumeric(value)?"alpha(opacity="+100*value+")":"",filter=currentStyle&&currentStyle.filter||style.filter||"";style.zoom=1,(value>=1||""===value)&&""===jQuery.trim(filter.replace(ralpha,""))&&style.removeAttribute&&(style.removeAttribute("filter"),""===value||currentStyle&&!currentStyle.filter)||(style.filter=ralpha.test(filter)?filter.replace(ralpha,opacity):filter+" "+opacity)}}),jQuery(function(){jQuery.support.reliableMarginRight||(jQuery.cssHooks.marginRight={get:function(elem,computed){return computed?jQuery.swap(elem,{display:"inline-block"},curCSS,[elem,"marginRight"]):void 0}}),!jQuery.support.pixelPosition&&jQuery.fn.position&&jQuery.each(["top","left"],function(i,prop){jQuery.cssHooks[prop]={get:function(elem,computed){return computed?(computed=curCSS(elem,prop),rnumnonpx.test(computed)?jQuery(elem).position()[prop]+"px":computed):void 0}}})}),jQuery.expr&&jQuery.expr.filters&&(jQuery.expr.filters.hidden=function(elem){return elem.offsetWidth<=0&&elem.offsetHeight<=0||!jQuery.support.reliableHiddenOffsets&&"none"===(elem.style&&elem.style.display||jQuery.css(elem,"display"))},jQuery.expr.filters.visible=function(elem){return!jQuery.expr.filters.hidden(elem)}),jQuery.each({margin:"",padding:"",border:"Width"},function(prefix,suffix){jQuery.cssHooks[prefix+suffix]={expand:function(value){for(var i=0,expanded={},parts="string"==typeof value?value.split(" "):[value];4>i;i++)expanded[prefix+cssExpand[i]+suffix]=parts[i]||parts[i-2]||parts[0];return expanded}},rmargin.test(prefix)||(jQuery.cssHooks[prefix+suffix].set=setPositiveNumber)});var r20=/%20/g,rbracket=/\[\]$/,rCRLF=/\r?\n/g,rsubmitterTypes=/^(?:submit|button|image|reset|file)$/i,rsubmittable=/^(?:input|select|textarea|keygen)/i;jQuery.fn.extend({serialize:function(){return jQuery.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var elements=jQuery.prop(this,"elements");return elements?jQuery.makeArray(elements):this}).filter(function(){var type=this.type;return this.name&&!jQuery(this).is(":disabled")&&rsubmittable.test(this.nodeName)&&!rsubmitterTypes.test(type)&&(this.checked||!manipulation_rcheckableType.test(type))}).map(function(i,elem){var val=jQuery(this).val();return null==val?null:jQuery.isArray(val)?jQuery.map(val,function(val){return{name:elem.name,value:val.replace(rCRLF,"\r\n")}}):{name:elem.name,value:val.replace(rCRLF,"\r\n")}}).get()}}),jQuery.param=function(a,traditional){var prefix,s=[],add=function(key,value){value=jQuery.isFunction(value)?value():null==value?"":value,s[s.length]=encodeURIComponent(key)+"="+encodeURIComponent(value)};if(traditional===undefined&&(traditional=jQuery.ajaxSettings&&jQuery.ajaxSettings.traditional),jQuery.isArray(a)||a.jquery&&!jQuery.isPlainObject(a))jQuery.each(a,function(){add(this.name,this.value)});else for(prefix in a)buildParams(prefix,a[prefix],traditional,add);return s.join("&").replace(r20,"+")},jQuery.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(i,name){jQuery.fn[name]=function(data,fn){return arguments.length>0?this.on(name,null,data,fn):this.trigger(name)}}),jQuery.fn.extend({hover:function(fnOver,fnOut){return this.mouseenter(fnOver).mouseleave(fnOut||fnOver)},bind:function(types,data,fn){return this.on(types,null,data,fn)},unbind:function(types,fn){return this.off(types,null,fn)},delegate:function(selector,types,data,fn){return this.on(types,selector,data,fn)},undelegate:function(selector,types,fn){return 1===arguments.length?this.off(selector,"**"):this.off(types,selector||"**",fn)}});var ajaxLocParts,ajaxLocation,ajax_nonce=jQuery.now(),ajax_rquery=/\?/,rhash=/#.*$/,rts=/([?&])_=[^&]*/,rheaders=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,rlocalProtocol=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,rnoContent=/^(?:GET|HEAD)$/,rprotocol=/^\/\//,rurl=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,_load=jQuery.fn.load,prefilters={},transports={},allTypes="*/".concat("*");try{ajaxLocation=location.href}catch(e){ajaxLocation=document.createElement("a"),ajaxLocation.href="",ajaxLocation=ajaxLocation.href}ajaxLocParts=rurl.exec(ajaxLocation.toLowerCase())||[],jQuery.fn.load=function(url,params,callback){if("string"!=typeof url&&_load)return _load.apply(this,arguments);var selector,response,type,self=this,off=url.indexOf(" ");return off>=0&&(selector=url.slice(off,url.length),url=url.slice(0,off)),jQuery.isFunction(params)?(callback=params,params=undefined):params&&"object"==typeof params&&(type="POST"),self.length>0&&jQuery.ajax({url:url,type:type,dataType:"html",data:params}).done(function(responseText){response=arguments,self.html(selector?jQuery("<div>").append(jQuery.parseHTML(responseText)).find(selector):responseText)}).complete(callback&&function(jqXHR,status){self.each(callback,response||[jqXHR.responseText,status,jqXHR])}),this},jQuery.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(i,type){jQuery.fn[type]=function(fn){return this.on(type,fn)}}),jQuery.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:ajaxLocation,type:"GET",isLocal:rlocalProtocol.test(ajaxLocParts[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":allTypes,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":jQuery.parseJSON,"text xml":jQuery.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(target,settings){return settings?ajaxExtend(ajaxExtend(target,jQuery.ajaxSettings),settings):ajaxExtend(jQuery.ajaxSettings,target)},ajaxPrefilter:addToPrefiltersOrTransports(prefilters),ajaxTransport:addToPrefiltersOrTransports(transports),ajax:function(url,options){function done(status,nativeStatusText,responses,headers){var isSuccess,success,error,response,modified,statusText=nativeStatusText;2!==state&&(state=2,timeoutTimer&&clearTimeout(timeoutTimer),transport=undefined,responseHeadersString=headers||"",jqXHR.readyState=status>0?4:0,isSuccess=status>=200&&300>status||304===status,responses&&(response=ajaxHandleResponses(s,jqXHR,responses)),response=ajaxConvert(s,response,jqXHR,isSuccess),isSuccess?(s.ifModified&&(modified=jqXHR.getResponseHeader("Last-Modified"),modified&&(jQuery.lastModified[cacheURL]=modified),modified=jqXHR.getResponseHeader("etag"),modified&&(jQuery.etag[cacheURL]=modified)),204===status||"HEAD"===s.type?statusText="nocontent":304===status?statusText="notmodified":(statusText=response.state,success=response.data,error=response.error,isSuccess=!error)):(error=statusText,!status&&statusText||(statusText="error",0>status&&(status=0))),jqXHR.status=status,jqXHR.statusText=(nativeStatusText||statusText)+"",isSuccess?deferred.resolveWith(callbackContext,[success,statusText,jqXHR]):deferred.rejectWith(callbackContext,[jqXHR,statusText,error]),jqXHR.statusCode(statusCode),statusCode=undefined,fireGlobals&&globalEventContext.trigger(isSuccess?"ajaxSuccess":"ajaxError",[jqXHR,s,isSuccess?success:error]),completeDeferred.fireWith(callbackContext,[jqXHR,statusText]),fireGlobals&&(globalEventContext.trigger("ajaxComplete",[jqXHR,s]),--jQuery.active||jQuery.event.trigger("ajaxStop")))}"object"==typeof url&&(options=url,url=undefined),options=options||{};var parts,i,cacheURL,responseHeadersString,timeoutTimer,fireGlobals,transport,responseHeaders,s=jQuery.ajaxSetup({},options),callbackContext=s.context||s,globalEventContext=s.context&&(callbackContext.nodeType||callbackContext.jquery)?jQuery(callbackContext):jQuery.event,deferred=jQuery.Deferred(),completeDeferred=jQuery.Callbacks("once memory"),statusCode=s.statusCode||{},requestHeaders={},requestHeadersNames={},state=0,strAbort="canceled",jqXHR={readyState:0,getResponseHeader:function(key){var match;if(2===state){if(!responseHeaders)for(responseHeaders={};match=rheaders.exec(responseHeadersString);)responseHeaders[match[1].toLowerCase()]=match[2];match=responseHeaders[key.toLowerCase()]}return null==match?null:match},getAllResponseHeaders:function(){return 2===state?responseHeadersString:null},setRequestHeader:function(name,value){var lname=name.toLowerCase();return state||(name=requestHeadersNames[lname]=requestHeadersNames[lname]||name,requestHeaders[name]=value),this},overrideMimeType:function(type){return state||(s.mimeType=type),this},statusCode:function(map){var code;if(map)if(2>state)for(code in map)statusCode[code]=[statusCode[code],map[code]];else jqXHR.always(map[jqXHR.status]);return this},abort:function(statusText){var finalText=statusText||strAbort;return transport&&transport.abort(finalText),done(0,finalText),this}};if(deferred.promise(jqXHR).complete=completeDeferred.add,jqXHR.success=jqXHR.done,jqXHR.error=jqXHR.fail,s.url=((url||s.url||ajaxLocation)+"").replace(rhash,"").replace(rprotocol,ajaxLocParts[1]+"//"),s.type=options.method||options.type||s.method||s.type,s.dataTypes=jQuery.trim(s.dataType||"*").toLowerCase().match(core_rnotwhite)||[""],null==s.crossDomain&&(parts=rurl.exec(s.url.toLowerCase()),s.crossDomain=!(!parts||parts[1]===ajaxLocParts[1]&&parts[2]===ajaxLocParts[2]&&(parts[3]||("http:"===parts[1]?"80":"443"))===(ajaxLocParts[3]||("http:"===ajaxLocParts[1]?"80":"443")))),s.data&&s.processData&&"string"!=typeof s.data&&(s.data=jQuery.param(s.data,s.traditional)),inspectPrefiltersOrTransports(prefilters,s,options,jqXHR),2===state)return jqXHR;fireGlobals=s.global,fireGlobals&&0===jQuery.active++&&jQuery.event.trigger("ajaxStart"),s.type=s.type.toUpperCase(),s.hasContent=!rnoContent.test(s.type),cacheURL=s.url,s.hasContent||(s.data&&(cacheURL=s.url+=(ajax_rquery.test(cacheURL)?"&":"?")+s.data,delete s.data),s.cache===!1&&(s.url=rts.test(cacheURL)?cacheURL.replace(rts,"$1_="+ajax_nonce++):cacheURL+(ajax_rquery.test(cacheURL)?"&":"?")+"_="+ajax_nonce++)),s.ifModified&&(jQuery.lastModified[cacheURL]&&jqXHR.setRequestHeader("If-Modified-Since",jQuery.lastModified[cacheURL]),jQuery.etag[cacheURL]&&jqXHR.setRequestHeader("If-None-Match",jQuery.etag[cacheURL])),(s.data&&s.hasContent&&s.contentType!==!1||options.contentType)&&jqXHR.setRequestHeader("Content-Type",s.contentType),jqXHR.setRequestHeader("Accept",s.dataTypes[0]&&s.accepts[s.dataTypes[0]]?s.accepts[s.dataTypes[0]]+("*"!==s.dataTypes[0]?", "+allTypes+"; q=0.01":""):s.accepts["*"]);for(i in s.headers)jqXHR.setRequestHeader(i,s.headers[i]);if(s.beforeSend&&(s.beforeSend.call(callbackContext,jqXHR,s)===!1||2===state))return jqXHR.abort();strAbort="abort";for(i in{success:1,error:1,complete:1})jqXHR[i](s[i]);if(transport=inspectPrefiltersOrTransports(transports,s,options,jqXHR)){jqXHR.readyState=1,fireGlobals&&globalEventContext.trigger("ajaxSend",[jqXHR,s]),s.async&&s.timeout>0&&(timeoutTimer=setTimeout(function(){jqXHR.abort("timeout")},s.timeout));try{state=1,transport.send(requestHeaders,done)}catch(e){if(!(2>state))throw e;done(-1,e)}}else done(-1,"No Transport");return jqXHR},getJSON:function(url,data,callback){return jQuery.get(url,data,callback,"json")},getScript:function(url,callback){return jQuery.get(url,undefined,callback,"script")}}),jQuery.each(["get","post"],function(i,method){jQuery[method]=function(url,data,callback,type){return jQuery.isFunction(data)&&(type=type||callback,callback=data,data=undefined),jQuery.ajax({url:url,type:method,dataType:type,data:data,success:callback})}}),jQuery.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(text){return jQuery.globalEval(text),text}}}),jQuery.ajaxPrefilter("script",function(s){s.cache===undefined&&(s.cache=!1),s.crossDomain&&(s.type="GET",s.global=!1)}),jQuery.ajaxTransport("script",function(s){if(s.crossDomain){var script,head=document.head||jQuery("head")[0]||document.documentElement;return{send:function(_,callback){script=document.createElement("script"),script.async=!0,s.scriptCharset&&(script.charset=s.scriptCharset),script.src=s.url,script.onload=script.onreadystatechange=function(_,isAbort){(isAbort||!script.readyState||/loaded|complete/.test(script.readyState))&&(script.onload=script.onreadystatechange=null,script.parentNode&&script.parentNode.removeChild(script),script=null,isAbort||callback(200,"success"))},head.insertBefore(script,head.firstChild)},abort:function(){script&&script.onload(undefined,!0)}}}});var oldCallbacks=[],rjsonp=/(=)\?(?=&|$)|\?\?/;jQuery.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var callback=oldCallbacks.pop()||jQuery.expando+"_"+ajax_nonce++;return this[callback]=!0,callback}}),jQuery.ajaxPrefilter("json jsonp",function(s,originalSettings,jqXHR){var callbackName,overwritten,responseContainer,jsonProp=s.jsonp!==!1&&(rjsonp.test(s.url)?"url":"string"==typeof s.data&&!(s.contentType||"").indexOf("application/x-www-form-urlencoded")&&rjsonp.test(s.data)&&"data");return jsonProp||"jsonp"===s.dataTypes[0]?(callbackName=s.jsonpCallback=jQuery.isFunction(s.jsonpCallback)?s.jsonpCallback():s.jsonpCallback,jsonProp?s[jsonProp]=s[jsonProp].replace(rjsonp,"$1"+callbackName):s.jsonp!==!1&&(s.url+=(ajax_rquery.test(s.url)?"&":"?")+s.jsonp+"="+callbackName),s.converters["script json"]=function(){return responseContainer||jQuery.error(callbackName+" was not called"),responseContainer[0]},s.dataTypes[0]="json",overwritten=window[callbackName],window[callbackName]=function(){responseContainer=arguments},jqXHR.always(function(){window[callbackName]=overwritten,s[callbackName]&&(s.jsonpCallback=originalSettings.jsonpCallback,oldCallbacks.push(callbackName)),responseContainer&&jQuery.isFunction(overwritten)&&overwritten(responseContainer[0]),responseContainer=overwritten=undefined}),"script"):void 0});var xhrCallbacks,xhrSupported,xhrId=0,xhrOnUnloadAbort=window.ActiveXObject&&function(){var key;for(key in xhrCallbacks)xhrCallbacks[key](undefined,!0)};jQuery.ajaxSettings.xhr=window.ActiveXObject?function(){return!this.isLocal&&createStandardXHR()||createActiveXHR()}:createStandardXHR,xhrSupported=jQuery.ajaxSettings.xhr(),jQuery.support.cors=!!xhrSupported&&"withCredentials"in xhrSupported,xhrSupported=jQuery.support.ajax=!!xhrSupported,xhrSupported&&jQuery.ajaxTransport(function(s){if(!s.crossDomain||jQuery.support.cors){var callback;return{send:function(headers,complete){var handle,i,xhr=s.xhr();if(s.username?xhr.open(s.type,s.url,s.async,s.username,s.password):xhr.open(s.type,s.url,s.async),s.xhrFields)for(i in s.xhrFields)xhr[i]=s.xhrFields[i];s.mimeType&&xhr.overrideMimeType&&xhr.overrideMimeType(s.mimeType),s.crossDomain||headers["X-Requested-With"]||(headers["X-Requested-With"]="XMLHttpRequest");try{for(i in headers)xhr.setRequestHeader(i,headers[i])}catch(err){}xhr.send(s.hasContent&&s.data||null),callback=function(_,isAbort){var status,responseHeaders,statusText,responses;try{if(callback&&(isAbort||4===xhr.readyState))if(callback=undefined,handle&&(xhr.onreadystatechange=jQuery.noop,xhrOnUnloadAbort&&delete xhrCallbacks[handle]),isAbort)4!==xhr.readyState&&xhr.abort();else{responses={},status=xhr.status,responseHeaders=xhr.getAllResponseHeaders(),"string"==typeof xhr.responseText&&(responses.text=xhr.responseText);try{statusText=xhr.statusText}catch(e){statusText=""}status||!s.isLocal||s.crossDomain?1223===status&&(status=204):status=responses.text?200:404}}catch(firefoxAccessException){isAbort||complete(-1,firefoxAccessException)}responses&&complete(status,statusText,responses,responseHeaders)},s.async?4===xhr.readyState?setTimeout(callback):(handle=++xhrId,xhrOnUnloadAbort&&(xhrCallbacks||(xhrCallbacks={},jQuery(window).unload(xhrOnUnloadAbort)),xhrCallbacks[handle]=callback),xhr.onreadystatechange=callback):callback()},abort:function(){callback&&callback(undefined,!0)}}}});var fxNow,timerId,rfxtypes=/^(?:toggle|show|hide)$/,rfxnum=new RegExp("^(?:([+-])=|)("+core_pnum+")([a-z%]*)$","i"),rrun=/queueHooks$/,animationPrefilters=[defaultPrefilter],tweeners={"*":[function(prop,value){var tween=this.createTween(prop,value),target=tween.cur(),parts=rfxnum.exec(value),unit=parts&&parts[3]||(jQuery.cssNumber[prop]?"":"px"),start=(jQuery.cssNumber[prop]||"px"!==unit&&+target)&&rfxnum.exec(jQuery.css(tween.elem,prop)),scale=1,maxIterations=20;if(start&&start[3]!==unit){unit=unit||start[3],parts=parts||[],start=+target||1;do scale=scale||".5",start/=scale,jQuery.style(tween.elem,prop,start+unit);while(scale!==(scale=tween.cur()/target)&&1!==scale&&--maxIterations)}return parts&&(start=tween.start=+start||+target||0,tween.unit=unit,tween.end=parts[1]?start+(parts[1]+1)*parts[2]:+parts[2]),tween}]};jQuery.Animation=jQuery.extend(Animation,{tweener:function(props,callback){jQuery.isFunction(props)?(callback=props,props=["*"]):props=props.split(" ");for(var prop,index=0,length=props.length;length>index;index++)prop=props[index],tweeners[prop]=tweeners[prop]||[],tweeners[prop].unshift(callback)},prefilter:function(callback,prepend){prepend?animationPrefilters.unshift(callback):animationPrefilters.push(callback)}}),jQuery.Tween=Tween,Tween.prototype={constructor:Tween,init:function(elem,options,prop,end,easing,unit){this.elem=elem,this.prop=prop,this.easing=easing||"swing",this.options=options,this.start=this.now=this.cur(),this.end=end,this.unit=unit||(jQuery.cssNumber[prop]?"":"px")},cur:function(){var hooks=Tween.propHooks[this.prop];return hooks&&hooks.get?hooks.get(this):Tween.propHooks._default.get(this)},run:function(percent){var eased,hooks=Tween.propHooks[this.prop];return this.options.duration?this.pos=eased=jQuery.easing[this.easing](percent,this.options.duration*percent,0,1,this.options.duration):this.pos=eased=percent,this.now=(this.end-this.start)*eased+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),hooks&&hooks.set?hooks.set(this):Tween.propHooks._default.set(this),this}},Tween.prototype.init.prototype=Tween.prototype,Tween.propHooks={_default:{get:function(tween){var result;return null==tween.elem[tween.prop]||tween.elem.style&&null!=tween.elem.style[tween.prop]?(result=jQuery.css(tween.elem,tween.prop,""),result&&"auto"!==result?result:0):tween.elem[tween.prop]},set:function(tween){jQuery.fx.step[tween.prop]?jQuery.fx.step[tween.prop](tween):tween.elem.style&&(null!=tween.elem.style[jQuery.cssProps[tween.prop]]||jQuery.cssHooks[tween.prop])?jQuery.style(tween.elem,tween.prop,tween.now+tween.unit):tween.elem[tween.prop]=tween.now}}},Tween.propHooks.scrollTop=Tween.propHooks.scrollLeft={set:function(tween){tween.elem.nodeType&&tween.elem.parentNode&&(tween.elem[tween.prop]=tween.now)}},jQuery.each(["toggle","show","hide"],function(i,name){var cssFn=jQuery.fn[name];jQuery.fn[name]=function(speed,easing,callback){return null==speed||"boolean"==typeof speed?cssFn.apply(this,arguments):this.animate(genFx(name,!0),speed,easing,callback)}}),jQuery.fn.extend({fadeTo:function(speed,to,easing,callback){return this.filter(isHidden).css("opacity",0).show().end().animate({opacity:to},speed,easing,callback)},animate:function(prop,speed,easing,callback){var empty=jQuery.isEmptyObject(prop),optall=jQuery.speed(speed,easing,callback),doAnimation=function(){var anim=Animation(this,jQuery.extend({},prop),optall);(empty||jQuery._data(this,"finish"))&&anim.stop(!0)};return doAnimation.finish=doAnimation,empty||optall.queue===!1?this.each(doAnimation):this.queue(optall.queue,doAnimation)},stop:function(type,clearQueue,gotoEnd){var stopQueue=function(hooks){var stop=hooks.stop;delete hooks.stop,stop(gotoEnd)};return"string"!=typeof type&&(gotoEnd=clearQueue,clearQueue=type,type=undefined),clearQueue&&type!==!1&&this.queue(type||"fx",[]),this.each(function(){var dequeue=!0,index=null!=type&&type+"queueHooks",timers=jQuery.timers,data=jQuery._data(this);if(index)data[index]&&data[index].stop&&stopQueue(data[index]);else for(index in data)data[index]&&data[index].stop&&rrun.test(index)&&stopQueue(data[index]);for(index=timers.length;index--;)timers[index].elem!==this||null!=type&&timers[index].queue!==type||(timers[index].anim.stop(gotoEnd),dequeue=!1,timers.splice(index,1));!dequeue&&gotoEnd||jQuery.dequeue(this,type)})},finish:function(type){return type!==!1&&(type=type||"fx"),this.each(function(){var index,data=jQuery._data(this),queue=data[type+"queue"],hooks=data[type+"queueHooks"],timers=jQuery.timers,length=queue?queue.length:0;for(data.finish=!0,jQuery.queue(this,type,[]),hooks&&hooks.stop&&hooks.stop.call(this,!0),index=timers.length;index--;)timers[index].elem===this&&timers[index].queue===type&&(timers[index].anim.stop(!0),timers.splice(index,1));for(index=0;length>index;index++)queue[index]&&queue[index].finish&&queue[index].finish.call(this);delete data.finish})}}),jQuery.each({slideDown:genFx("show"),slideUp:genFx("hide"),slideToggle:genFx("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(name,props){jQuery.fn[name]=function(speed,easing,callback){return this.animate(props,speed,easing,callback)}}),jQuery.speed=function(speed,easing,fn){var opt=speed&&"object"==typeof speed?jQuery.extend({},speed):{complete:fn||!fn&&easing||jQuery.isFunction(speed)&&speed,duration:speed,easing:fn&&easing||easing&&!jQuery.isFunction(easing)&&easing};return opt.duration=jQuery.fx.off?0:"number"==typeof opt.duration?opt.duration:opt.duration in jQuery.fx.speeds?jQuery.fx.speeds[opt.duration]:jQuery.fx.speeds._default,null!=opt.queue&&opt.queue!==!0||(opt.queue="fx"),opt.old=opt.complete,opt.complete=function(){jQuery.isFunction(opt.old)&&opt.old.call(this),opt.queue&&jQuery.dequeue(this,opt.queue)},opt},jQuery.easing={linear:function(p){return p},swing:function(p){return.5-Math.cos(p*Math.PI)/2}},jQuery.timers=[],jQuery.fx=Tween.prototype.init,jQuery.fx.tick=function(){var timer,timers=jQuery.timers,i=0;for(fxNow=jQuery.now();i<timers.length;i++)timer=timers[i],timer()||timers[i]!==timer||timers.splice(i--,1);timers.length||jQuery.fx.stop(),fxNow=undefined},jQuery.fx.timer=function(timer){timer()&&jQuery.timers.push(timer)&&jQuery.fx.start()},jQuery.fx.interval=13,jQuery.fx.start=function(){timerId||(timerId=setInterval(jQuery.fx.tick,jQuery.fx.interval))},jQuery.fx.stop=function(){clearInterval(timerId),timerId=null},jQuery.fx.speeds={slow:600,fast:200,_default:400},jQuery.fx.step={},jQuery.expr&&jQuery.expr.filters&&(jQuery.expr.filters.animated=function(elem){return jQuery.grep(jQuery.timers,function(fn){return elem===fn.elem}).length}),jQuery.fn.offset=function(options){if(arguments.length)return options===undefined?this:this.each(function(i){jQuery.offset.setOffset(this,options,i)});var docElem,win,box={top:0,left:0},elem=this[0],doc=elem&&elem.ownerDocument;if(doc)return docElem=doc.documentElement,jQuery.contains(docElem,elem)?(typeof elem.getBoundingClientRect!==core_strundefined&&(box=elem.getBoundingClientRect()),win=getWindow(doc),{top:box.top+(win.pageYOffset||docElem.scrollTop)-(docElem.clientTop||0),left:box.left+(win.pageXOffset||docElem.scrollLeft)-(docElem.clientLeft||0)}):box},jQuery.offset={setOffset:function(elem,options,i){var position=jQuery.css(elem,"position");"static"===position&&(elem.style.position="relative");var curTop,curLeft,curElem=jQuery(elem),curOffset=curElem.offset(),curCSSTop=jQuery.css(elem,"top"),curCSSLeft=jQuery.css(elem,"left"),calculatePosition=("absolute"===position||"fixed"===position)&&jQuery.inArray("auto",[curCSSTop,curCSSLeft])>-1,props={},curPosition={};calculatePosition?(curPosition=curElem.position(),curTop=curPosition.top,curLeft=curPosition.left):(curTop=parseFloat(curCSSTop)||0,curLeft=parseFloat(curCSSLeft)||0),jQuery.isFunction(options)&&(options=options.call(elem,i,curOffset)),null!=options.top&&(props.top=options.top-curOffset.top+curTop),null!=options.left&&(props.left=options.left-curOffset.left+curLeft),"using"in options?options.using.call(elem,props):curElem.css(props)}},jQuery.fn.extend({position:function(){if(this[0]){var offsetParent,offset,parentOffset={top:0,left:0},elem=this[0];return"fixed"===jQuery.css(elem,"position")?offset=elem.getBoundingClientRect():(offsetParent=this.offsetParent(),offset=this.offset(),jQuery.nodeName(offsetParent[0],"html")||(parentOffset=offsetParent.offset()),parentOffset.top+=jQuery.css(offsetParent[0],"borderTopWidth",!0),parentOffset.left+=jQuery.css(offsetParent[0],"borderLeftWidth",!0)),{top:offset.top-parentOffset.top-jQuery.css(elem,"marginTop",!0),left:offset.left-parentOffset.left-jQuery.css(elem,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var offsetParent=this.offsetParent||docElem;offsetParent&&!jQuery.nodeName(offsetParent,"html")&&"static"===jQuery.css(offsetParent,"position");)offsetParent=offsetParent.offsetParent;return offsetParent||docElem})}}),jQuery.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(method,prop){var top=/Y/.test(prop);jQuery.fn[method]=function(val){return jQuery.access(this,function(elem,method,val){var win=getWindow(elem);return val===undefined?win?prop in win?win[prop]:win.document.documentElement[method]:elem[method]:void(win?win.scrollTo(top?jQuery(win).scrollLeft():val,top?val:jQuery(win).scrollTop()):elem[method]=val)},method,val,arguments.length,null)}}),jQuery.each({Height:"height",Width:"width"},function(name,type){jQuery.each({padding:"inner"+name,content:type,"":"outer"+name},function(defaultExtra,funcName){jQuery.fn[funcName]=function(margin,value){var chainable=arguments.length&&(defaultExtra||"boolean"!=typeof margin),extra=defaultExtra||(margin===!0||value===!0?"margin":"border");return jQuery.access(this,function(elem,type,value){var doc;return jQuery.isWindow(elem)?elem.document.documentElement["client"+name]:9===elem.nodeType?(doc=elem.documentElement,Math.max(elem.body["scroll"+name],doc["scroll"+name],elem.body["offset"+name],doc["offset"+name],doc["client"+name])):value===undefined?jQuery.css(elem,type,extra):jQuery.style(elem,type,value,extra)},type,chainable?margin:undefined,chainable,null)}})}),jQuery.fn.size=function(){return this.length},jQuery.fn.andSelf=jQuery.fn.addBack,"object"==typeof module&&module&&"object"==typeof module.exports?module.exports=jQuery:(window.jQuery=window.$=jQuery,"function"==typeof define&&(define.amd||define.cmd)&&define("jquery",[],function(){return jQuery}))}(window),function(factory){"use strict";"function"==typeof define&&(define.amd||define.cmd)?define("component/jquery.loading",["jquery"],factory):factory("undefined"!=typeof jQuery?jQuery:window.Zepto)}(function(){var config={cls:null,text:"数据加载中..."};$.fn.loading=function(text,cls,hide){var _loading=$(this).data("jquery-loading");return _loading||(_loading=$('<div class="think-loading"><span class="loading-inner"><i class="loading-image"></i><b class="loading-text"></b></span></div>'),$(this).data("jquery-loading",_loading)),"hide"==text?_loading.removeClass("loading-active"):(text="undefined"==typeof text?config.text:text,cls=cls||config.cls,_loading.find(".loading-text").html(text),_loading.addClass(cls),_loading.addClass("loading-active")),$(this).find("."+cls).length||$(this).append(_loading),$(this)},$.loading=function(text,cls){},$.loading.setConfig=function(){return config[name]=data}}),function(factory){"use strict";
"function"==typeof define&&(define.amd||define.cmd)?define("component/jquery.tree",["jquery"],factory):factory("undefined"!=typeof jQuery?jQuery:window.Zepto)}(function(){function node(options){this._options=$.extend({id:null,pid:null,data:null},options),this.id=this._options.id,this.pid=this._options.pid,Extend(this,Event)}function nodeManage(data,options){this._options=$.extend({},{parentField:"pid",childField:"id",onCreateItem:null},options),this._nodeUpdateStatus=!0,this.setParentField(this._options.parentField),this.setChildField(this._options.childField),this._nodeData=nodeManage.serialize.call(this,data,this._parentField,this._childField,function(main,proxy){this._proxyData=proxy}),this._faceData=this.childrens()}function combobox(options){var self=this;this.options=$.extend({},combobox.options,options),this._isOpen=!1,this.content=$('<div class="think-combobox"></div>'),this.handler=$('<span class="think-handler"></span>'),this.options.content instanceof jQuery&&(this.options.content.after(this.content),this.content.append(this.options.content)),this.options.handler instanceof jQuery&&(this.options.handler.after(this.handler),this.handler.append(this.options.handler)),this.handler.click(function(){self.open(!self._isOpen)}),$.isFunction(this.options.onCreate)&&this.options.onCreate.call(this)}function tree(data,options){var self=this;this.options=$.extend({},tree.options,options),Extend(this,Event),this._selectedList={},this.setSelectMode(this.options.selectMode),this.setSelectMust(this.options.selectMust),this.nodes=new nodeManage(data,{parentField:this.options.parentField,childField:this.options.childField,onCreateItem:function(node){node.tree=self}}),Extend(node.prototype,tree.node),this.root=new node,this.root.element=$("<ul></ul>"),this.root.tree=this,this.root.isRoot=!0,this.setParseTemp(this.options.parseTemp),this.tree=tree.createHtml.call(this,this.nodes.getData(),this.root.element),this.on("onSelect",this.options.onSelect),this.on("onSwitch",function(event,node){node.isOpen()?node.close():node.open()}),this.tree.addClass(this.options.cls),this.options.combobox&&this.tree.addClass("combobox-content"),this.options.appendTo&&this.options.appendTo.append(this.tree),this.options.combobox&&(this.combobox=new combobox({handler:this.options.combobox,content:this.tree,onCreate:function(){}})),$.isFunction(this.options.onCreate)&&this.options.onCreate.call(this)}var Event={on:function(name,data,fun){return $(this).on(Event._getName(name),data||{},fun),this},off:function(name){return $(this).off(Event._getName(name)),this},trigger:function(name,data){var _n1=Event._getName(name),_n2=Event._getName(name,!0);return $(this).trigger(_n2,data),$(this).trigger(_n1,data),this},_getName:function(name,pr){return pr?"__on"+name+"__":"on"+name}},Extend=function(o1,o2){for(var i in o2)i in o1&&(o1["__"+i]=o1[i]),o1[i]=o2[i];o1.callParent=function(name,param){name="__"+name,name in o1&&$.isFunction(o1[name])&&o1[name].apply(o1,Array.prototype.slice.call(arguments,1))}};node.prototype.destroy=function(){for(var i in this)this[i]instanceof jQuery&&this[i].remove(),delete this[i]},node.prototype.set=function(name,data){return"string"==typeof name?this._options.data[name]=data:void 0},node.prototype.get=function(name){return"string"==typeof name&&name in this._options.data?this._options.data[name]:void 0},node.prototype.setLevel=function(level){$.isNumeric(level)&&(this._level=level)},node.prototype.getLevel=function(){return this._level||0},node.prototype.hasChildren=function(){return!!this._children},node.prototype.getChildren=function(){return this._children||[]},nodeManage.prototype.getTotal=function(){return this._faceData.length||0},nodeManage.prototype.getIndex=function(node){for(var _id=node.id,i=0;i<this._faceData.length;i++)if(this._faceData[i].id==_id)return i;return-1},nodeManage.prototype.serializeNodeData=function(data){var _nodes=nodeManage.serialize.call(this,data,this._parentField,this._childField,$.noop,this._proxyData,this._nodeData);return this._nodeUpdateStatus=!0,this._faceData=this.childrens(),_nodes},nodeManage.prototype.updateNodeData=function(data){},nodeManage.prototype.getData=function(data){return this._nodeData||[]},nodeManage.prototype.exportData=function(){for(var data=[],i=0,l=this._faceData.length;l>i;i++)data.push(this._faceData[i]._options.data);return data},nodeManage.prototype.setParentField=function(field){return this._parentField=field||"pid",this},nodeManage.prototype.setChildField=function(field){return this._childField=field||"id",this},nodeManage.prototype.find=function(id){for(var _length=this._faceData.length,_i=0;_length>_i;_i++)if(this._faceData[_i].id==id)return this._faceData[_i]},nodeManage.prototype.childrens=function(node){function recursion(node){for(var _children=_self.children(node),_length=_children.length,i=0;_length>i;i++)_childrens.push(_children[i]),arguments.callee(_children[i])}var _childrens=[],_self=this;if(nodeManage.isNode(node))recursion(node);else if(this._nodeUpdateStatus){for(var _childs=this.children(),i=0;i<_childs.length;i++)_childrens.push(_childs[i]),recursion(_childs[i]);this._nodeUpdateStatus=!1}else _childrens=this._faceData;return _childrens},nodeManage.prototype.children=function(node){var _children=[],_proxy={};_proxy=nodeManage.isNode(node)?node._children||[]:this._nodeData;for(var i in _proxy)_children.push(_proxy[i]);return _children},nodeManage.prototype.parent=function(node){var _parent;if(nodeManage.isNode(node)){var _pid=node.pid;for(var i in this._faceData)if(this._faceData[i].id==_pid){_parent=this._faceData[i];break}}return _parent},nodeManage.prototype.parents=function(node){var _parents=[];if(nodeManage.isNode(node)){var _nodes=this._faceData;!function(_node,_nodes){for(var i in _nodes)if(_node.pid&&_node.pid==_nodes[i].id)return _parents.push(_nodes[i]),void arguments.callee(_nodes[i],_nodes)}(node,_nodes)}return _parents},nodeManage.prototype.siblings=function(node,nodes){var _siblings=[];if(nodeManage.isNode(node)){var _parent=this.parent(node);if(_parent){var _children=this.children(_parent);for(var i in _children)_children[i]!==node&&_siblings.push(_children[i])}}return _siblings},nodeManage.prototype.next=function(node,nodes){var _next;if(nodeManage.isNode(node)){var _parent=this.parent(node),_chldrens=nodes||this.children(_parent),_status=!1;for(var i in _chldrens){if(_status){_next=_chldrens[i];break}_chldrens[i]===node&&(_status=!0)}}return _next},nodeManage.prototype.nextAll=function(id){},nodeManage.prototype.prev=function(node,nodes){var _prev,_node;if(nodeManage.isNode(node)){var _parent=this.parent(node),_chldrens=nodes||this.children(_parent);for(var i in _chldrens){if(_chldrens[i]===node){_prev=_node;break}_node=_chldrens[i]}}return _prev},nodeManage.prototype.first=function(node){return"undefined"==typeof node?this._faceData[0]:nodeManage.isNode(node)?this.children(node)[0]:void 0},nodeManage.prototype.last=function(node){if("undefined"==typeof node)return this._faceData[this._faceData.length-1];if(nodeManage.isNode(node)){var _children=this.children(node);return _children[_children.length-1]}},nodeManage.prototype.prevAll=function(id){},nodeManage.prototype.remove=function(node){var _parent=this.parent(node),_removes=this.childrens(node),_length=0;if(_removes.push(node),_length=_removes.length,_parent){var _children=_parent._children;for(var m in _children)_children[m]===node&&delete _children[m]}else for(var i in this._nodeData)this._nodeData[i]===node&&delete this._nodeData[i];if(_length){node._children=[];for(var i=0;_length>i;i++){for(var j=0;j<this._faceData.length;j++)if(this._faceData[j]===node){this._faceData.slice(j,1);break}_removes[i].destroy()}}this._nodeUpdateStatus=!0,this._faceData=this.childrens()},nodeManage.isNode=function(id){return id instanceof node},nodeManage.prefix="tree-",nodeManage.serialize=function(data,parentField,childField,callback,proxyData,rootData){var _self=this,_data=$.isFunction(data)?data():data,_main={},_proxy=proxyData||{},_proxyResult={},_parentField="string"==$.type(parentField)?parentField:"pid",_childField="string"==$.type(childField)?childField:"id",_length=0;_data=$.isArray(_data)?_data:[_data],_length=_data.length;for(var i=0;_length>i;i++){var _mask=nodeManage.prefix+_data[i][_childField].toString();_proxy[_mask]=new node({data:_data[i],id:_data[i][_childField],pid:_data[i][_parentField]}),proxyData&&(_proxyResult[_mask]=_proxy[_mask])}for(var i=0;_length>i;i++)_proxy[nodeManage.prefix+_data[i][_parentField].toString()]?(_proxy[nodeManage.prefix+_data[i][_parentField].toString()]._children||(_proxy[nodeManage.prefix+_data[i][_parentField].toString()]._children={}),_proxy[nodeManage.prefix+_data[i].pid.toString()]._children[nodeManage.prefix+_data[i].id.toString()]=_proxy[nodeManage.prefix+_data[i].id.toString()]):_main[nodeManage.prefix+_data[i][_childField].toString()]=_proxy[nodeManage.prefix+_data[i][_childField].toString()];if(proxyData)for(var i in _proxyResult){var _parent=this.parent(_proxyResult[i]);_parent?_proxyResult[i]._level=_parent.getLevel()+1:(_proxyResult[i]._level=1,rootData[i]=_proxyResult[i]),$.isFunction(_self._options.onCreateItem)&&_self._options.onCreateItem.call(this,_proxyResult[i])}else!function(data,level){var _data=data,_level=level+1;for(var i in _data)_data[i]._level=_level,_data[i]._children&&arguments.callee(_data[i]._children,_level),$.isFunction(_self._options.onCreateItem)&&_self._options.onCreateItem.call(this,_data[i])}(_main,0);return $.isFunction(callback)&&callback.call(this,_main,_proxy),proxyData?_proxyResult:_main},combobox.prototype.open=function(){this._isOpen=!0,this.content.addClass("combobox-open"),this.handler.addClass("combobox-open")},combobox.prototype.close=function(){this._isOpen=!1,this.content.removeClass("combobox-open"),this.handler.removeClass("combobox-open")},combobox.prototype.setValue=function(){},combobox.prototype.getValue=function(){},combobox.prototype.disabled=function(){},combobox.prototype.focus=function(){},combobox.prototype.blur=function(){},combobox.createHtml=function(){},combobox.options={handler:null,content:null,onOpen:null,onClose:null},tree.cacheMask="THINKTREE",tree.node={_isSelected:!1,_isOpen:!1,release:function(status,lockEvent,isOpen){function define(node,name){node.element.addClass("tree-selected"),node._isSelected=!0,tree._selectedList[name]=node}function cancel(node,name){node.element.removeClass("tree-selected"),node._isSelected=!1,delete tree._selectedList[name]}var tree=this.tree,status="undefined"==typeof status?!0:!!status,name=this.id.toString(),isSelected=this._isSelected;if("single"==tree._selectMode){for(var i in tree._selectedList)cancel(tree._selectedList[i],i);status=tree._selectMust?!0:status,status&&(this._isSelected||name in tree._selectedList||define("component/jquery.tree",["jquery"],name))}else status?this._isSelected||name in tree._selectedList||define("component/jquery.tree",["jquery"],name):this._isSelected||name in tree._selectedList||cancel(this,name);isOpen!==!1&&(this._isOpen&&isSelected?this.close():this.open()),lockEvent||(this.trigger("onSelect",this),this.tree.trigger("onSelect",this))},selected:function(status,lockEvent,isOpen){var tree=this.tree;return lockEvent!==!0&&$.isFunction(tree.options.onBeforeSelect)&&tree.options.onBeforeSelect.call(this)===!1?!1:void this.release.apply(this,arguments)},isSelected:function(){return this._isSelected},open:function(){var _parents=this.tree.nodes.parents(this);return _parents.push(this),$.each(_parents,function(i,v){v._isOpen||(v.element.parent().addClass("tree-open"),v._isOpen=!0,v.trigger("onOpen",node))}),this},close:function(){return this._isOpen&&(this.element.parent().removeClass("tree-open"),this._isOpen=!1,this.trigger("onClose",node)),this},isOpen:function(){return this._isOpen},updateSwitch:function(){var _children=this.tree.nodes.children(this);return _children.length?this.element.children(".tree-switch").addClass("tree-switch-active"):this.element.children(".tree-switch").removeClass("tree-switch-active"),this},disabled:function(){},setText:function(text){this.set("text",text),this.element.children(".tree-text").html(text)},remove:function(){var _parent=this.tree.nodes.parent(this),_removes=this.tree.nodes.childrens(this);_removes.push(this);for(var _length=_removes.length,i=0;_length>i;i++){var _id=_removes[i].id.toString();_id in this.tree._selectedList&&delete this.tree._selectedList[_id]}this.tree.nodes.remove(this),_parent&&_parent.updateSwitch()}},tree.prototype.getNode=function(selector){var _type=$.type(selector);return $.isNumeric(selector)||"string"==_type?this.nodes.find(selector):nodeManage.isNode(selector)?selector:selector instanceof jQuery?selector.data(tree.cacheMask):"object"==_type&&"nodeName"in selector?$(selector).data(tree.cacheMask):void 0},tree.prototype.createNode=function(data,temp){var _nodes=this.nodes.serializeNodeData(data)||{};for(var i in _nodes){var _parent=this.nodes.parent(_nodes[i])||this.root;tree.createHtml.call(this,_nodes[i],_parent,temp),_parent.updateSwitch()}return this},tree.prototype.open=function(selector){var node=this.getNode(node);return nodeManage.isNode(node)&&node.open(status),this},tree.prototype.close=function(selector){var node=this.getNode(node);return nodeManage.isNode(node)&&node.close(status),this},tree.prototype.setSelectMode=function(mode){var _modes=["single","multiple"],_mode=$.inArray(mode,_modes)>=0?mode:_modes[0];return this._selectMode=_mode,this},tree.prototype.getSelectMode=function(){return this._selectMode},tree.prototype.setSelectMust=function(status){return this._selectMust="undefined"==typeof status?!0:!!status,this},tree.prototype.getSelectMust=function(){return this._selectMust},tree.prototype.selected=function(node,status,lockEvent){var node=this.getNode(node);return nodeManage.isNode(node)&&node.selected(status,lockEvent),this},tree.prototype.getSelected=function(){var _selected=[];for(var i in this._selectedList)_selected.push(this._selectedList[i]);return"single"==this._selectMode?_selected[0]:_selected},tree.prototype.setParseTemp=function(temp){var _temp=temp,_self=this;$.isFunction(_temp)||(_temp=function(node){return'<span class="tree-text">'+tree.HTMLEnCode(node.get(_self.options.displayField))+"</span>"}),this._parseTemp=_temp},tree.prototype.getParseTemp=function(){return this._parseTemp},tree.HTMLEnCode=function(str){var s="";return 0==str.length?"":(s=str.replace(/&/g,"&gt;"),s=s.replace(/</g,"&lt;"),s=s.replace(/>/g,"&gt;"),s=s.replace(/ /g,"&nbsp;"),s=s.replace(/\'/g,"'"),s=s.replace(/\"/g,"&quot;"))},tree.HTMLDeCode=function(str){var s="";return 0==str.length?"":(s=str.replace(/&gt;/g,"&"),s=s.replace(/&lt;/g," <"),s=s.replace(/&gt;/g,">"),s=s.replace(/&nbsp;/g,"    "),s=s.replace(/'/g,"'"),s=s.replace(/&quot;/g,'"'))},tree.createHtml=function(nodes,parent,temp){function createItem(node){var _item="",_li=$("<li/>");_item+='<span class="tree-item">';for(var j=0;j<node.getLevel();j++)_item+='<i class="tree-block"></i>';return _item+='<b class="tree-switch',_item+=_hasChildren?" tree-switch-active":"",_item+='"><i>开关</i></b>',_item+="</span>",_item=$(_item),_item.append(_temp(node)),_item.appendTo(_li),_item.data(tree.cacheMask,node),node.element=_item,function(node,element){element.click(function(){node.selected()}),element.find(".tree-switch").click(function(event){node.tree.trigger("onSwitch",node),event.stopPropagation()})}(node,_item),_li}var _nodes=nodes,_temp=(nodes.length,$.isFunction(temp)?temp:this.getParseTemp());if(nodeManage.isNode(nodes)){var _li=createItem.call(this,nodes);parent.isRoot?parent.childrenElement=parent.element:parent.childrenElement||(parent.childrenElement=$("<ul></ul>"),parent.element.parent().append(parent.childrenElement)),_li.appendTo(parent.childrenElement)}else for(var i in _nodes){var _li=_nodes[i].element,_hasChildren=_nodes[i].hasChildren();_li||(_li=createItem.call(this,_nodes[i]),_hasChildren&&(_nodes[i].childrenElement=$("<ul></ul>"),_li.append(arguments.callee.call(this,_nodes[i].getChildren(),_nodes[i].childrenElement)))),_li.appendTo(parent)}return parent},tree.options={cls:"think-tree",combobox:null,selectMode:"single",selectMust:!1,parentField:"pid",childField:"id",displayField:"text",appendTo:null,onSelect:null,parseData:null,parseTemp:null,onCreate:null},$.tree=function(data,options){return new tree(data,options)},$.serializeTree=node.serialize}),function(){function a(a){"use strict";var b={omitExtraWLInCodeBlocks:{"default":!1,describe:"Omit the default extra whiteline added to code blocks",type:"boolean"},noHeaderId:{"default":!1,describe:"Turn on/off generated header id",type:"boolean"},prefixHeaderId:{"default":!1,describe:"Specify a prefix to generated header ids",type:"string"},headerLevelStart:{"default":!1,describe:"The header blocks level start",type:"integer"},parseImgDimensions:{"default":!1,describe:"Turn on/off image dimension parsing",type:"boolean"},simplifiedAutoLink:{"default":!1,describe:"Turn on/off GFM autolink style",type:"boolean"},literalMidWordUnderscores:{"default":!1,describe:"Parse midword underscores as literal underscores",type:"boolean"},strikethrough:{"default":!1,describe:"Turn on/off strikethrough support",type:"boolean"},tables:{"default":!1,describe:"Turn on/off tables support",type:"boolean"},tablesHeaderId:{"default":!1,describe:"Add an id to table headers",type:"boolean"},ghCodeBlocks:{"default":!0,describe:"Turn on/off GFM fenced code blocks support",type:"boolean"},tasklists:{"default":!1,describe:"Turn on/off GFM tasklist support",type:"boolean"},catelists:{"default":!1,describe:"",type:"array"}};if(a===!1)return JSON.parse(JSON.stringify(b));var c={};for(var d in b)b.hasOwnProperty(d)&&(c[d]=b[d]["default"]);return c}function b(a,b){"use strict";var c=b?"Error in "+b+" extension->":"Error in unnamed extension",e={valid:!0,error:""};d.helper.isArray(a)||(a=[a]);for(var f=0;f<a.length;++f){var g=c+" sub-extension "+f+": ",h=a[f];if("object"!=typeof h)return e.valid=!1,e.error=g+"must be an object, but "+typeof h+" given",e;if(!d.helper.isString(h.type))return e.valid=!1,e.error=g+'property "type" must be a string, but '+typeof h.type+" given",e;var i=h.type=h.type.toLowerCase();if("language"===i&&(i=h.type="lang"),"html"===i&&(i=h.type="output"),"lang"!==i&&"output"!==i&&"line"!==i&&"super"!==i)return e.valid=!1,e.error=g+"type "+i+' is not recognized. Valid values: "lang" or "output"',e;if(h.filter){if("function"!=typeof h.filter)return e.valid=!1,e.error=g+'"filter" must be a function, but '+typeof h.filter+" given",e}else{if(!h.regex)return e.valid=!1,e.error=g+'extensions must define either a "regex" property or a "filter" method',e;if(d.helper.isString(h.regex)&&(h.regex=new RegExp(h.regex,"g")),!h.regex instanceof RegExp)return e.valid=!1,e.error=g+'"regex" property must either be a string or a RegExp object, but '+typeof h.regex+" given",e;if(d.helper.isUndefined(h.replace))return e.valid=!1,e.error=g+'"regex" extensions must implement a replace string or function',e}if(d.helper.isUndefined(h.filter)&&d.helper.isUndefined(h.regex))return e.valid=!1,e.error=g+"output extensions must define a filter property",e}return e}function c(a,b){"use strict";var c=b.charCodeAt(0);return"~E"+c+"E"}var d={},e={},f={},g=a(!0),h={github:{omitExtraWLInCodeBlocks:!0,prefixHeaderId:"user-content-",simplifiedAutoLink:!0,literalMidWordUnderscores:!0,strikethrough:!0,tables:!0,tablesHeaderId:!0,ghCodeBlocks:!0,tasklists:!0},vanilla:a(!0)};d.helper={},d.extensions={},d.setOption=function(a,b){"use strict";return g[a]=b,this},d.getOption=function(a){"use strict";return g[a]},d.getOptions=function(){"use strict";return g},d.resetOptions=function(){"use strict";g=a(!0)},d.setFlavor=function(a){"use strict";if(h.hasOwnProperty(a)){var b=h[a];for(var c in b)b.hasOwnProperty(c)&&(g[c]=b[c])}},d.getDefaultOptions=function(b){"use strict";return a(b)},d.subParser=function(a,b){"use strict";if(d.helper.isString(a)){if("undefined"==typeof b){if(e.hasOwnProperty(a))return e[a];throw Error("SubParser named "+a+" not registered!")}e[a]=b}},d.extension=function(a,c){"use strict";if(!d.helper.isString(a))throw Error("Extension 'name' must be a string");if(a=d.helper.stdExtName(a),d.helper.isUndefined(c)){if(!f.hasOwnProperty(a))throw Error("Extension named "+a+" is not registered!");return f[a]}"function"==typeof c&&(c=c()),d.helper.isArray(c)||(c=[c]);var e=b(c,a);if(!e.valid)throw Error(e.error);f[a]=c},d.getAllExtensions=function(){"use strict";return f},d.removeExtension=function(a){"use strict";delete f[a]},d.resetExtensions=function(){"use strict";f={}},d.validateExtension=function(a){"use strict";var c=b(a,null);return c.valid?!0:(console.warn(c.error),!1)},d.hasOwnProperty("helper")||(d.helper={}),d.helper.isString=function(a){"use strict";return"string"==typeof a||a instanceof String},d.helper.forEach=function(a,b){"use strict";if("function"==typeof a.forEach)a.forEach(b);else for(var c=0;c<a.length;c++)b(a[c],c,a)},d.helper.isArray=function(a){"use strict";return a.constructor===Array},d.helper.isUndefined=function(a){"use strict";return"undefined"==typeof a},d.helper.stdExtName=function(a){"use strict";return a.replace(/[_-]||\s/g,"").toLowerCase()},d.helper.escapeCharactersCallback=c,d.helper.escapeCharacters=function(a,b,d){"use strict";var e="(["+b.replace(/([\[\]\\])/g,"\\$1")+"])";d&&(e="\\\\"+e);var f=new RegExp(e,"g");return a=a.replace(f,c)},d.helper.matchRecursiveRegExp=function(a,b,c,d){"use strict";var e,f,g,h,i,j=d||"",k=j.indexOf("g")>-1,l=new RegExp(b+"|"+c,j),m=new RegExp(b,j.replace(/g/g,"")),n=[];do for(e=0;g=l.exec(a);)if(m.test(g[0]))e++||(h=g[0],f=l.lastIndex);else if(e&&!--e){i=g[0];var o=a.slice(f,g.index);if(n.push([h+o+i,o]),!k)return n}while(e&&(l.lastIndex=f));return n},d.helper.isUndefined(console)&&(console={warn:function(a){"use strict";alert(a)},log:function(a){"use strict";alert(a)}}),d.Converter=function(a){"use strict";function c(){a=a||{};for(var b in g)g.hasOwnProperty(b)&&(k[b]=g[b]);if("object"!=typeof a)throw Error("Converter expects the passed parameter to be an object, but "+typeof a+" was passed instead.");for(var c in a)a.hasOwnProperty(c)&&(k[c]=a[c]);k.extensions&&d.helper.forEach(k.extensions,i)}function i(a,c){if(c=c||null,d.helper.isString(a)){if(a=d.helper.stdExtName(a),c=a,d.extensions[a])return console.warn("DEPRECATION WARNING: "+a+" is an old extension that uses a deprecated loading method.Please inform the developer that the extension should be updated!"),void j(d.extensions[a],a);if(d.helper.isUndefined(f[a]))throw Error('Extension "'+a+'" could not be loaded. It was either not found or is not a valid extension.');a=f[a]}"function"==typeof a&&(a=a()),d.helper.isArray(a)||(a=[a]);var e=b(a,c);if(!e.valid)throw Error(e.error);for(var g=0;g<a.length;++g)switch(a[g].type){case"super":l.push(a[g]);break;case"line":m.push(a[g]);break;case"lang":n.push(a[g]);break;case"output":o.push(a[g]);break;default:throw Error("Extension loader error: Type unrecognized!!!")}}function j(a,c){"function"==typeof a&&(a=a(new d.Converter)),d.helper.isArray(a)||(a=[a]);var e=b(a,c);if(!e.valid)throw Error(e.error);for(var f=0;f<a.length;++f)switch(a[f].type){case"super":l.push(a[f]);break;case"line":m.push(a[f]);break;case"lang":n.push(a[f]);break;case"output":o.push(a[f]);break;default:throw Error("Extension loader error: Type unrecognized!!!")}}var k={},l=[],m=[],n=[],o=[],p=["hashHTMLBlocks","hashHTMLSpans","stripLinkDefinitions","blockGamut","unhashHTMLSpans","unescapeSpecialChars"];c(),this.makeHtml=function(a){if(!a)return a;var b={gHtmlSpans:[],gHtmlBlocks:[],gUrls:{},gTitles:{},gDimensions:{},gListLevel:0,hashLinkCounts:{},superExtensions:l,langExtensions:n,lineExtensions:m,outputModifiers:o,converter:this};d.helper.forEach(l,function(c){a=d.subParser("runExtension")(c,a,k,b)}),a=a.replace(/~/g,"~T"),a=a.replace(/\$/g,"~D"),a=a.replace(/\r\n/g,"\n"),a=a.replace(/\r/g,"\n"),a="\n\n"+a+"\n\n",a=d.subParser("detab")(a,k,b),a=d.subParser("stripBlankLines")(a,k,b),a=d.subParser("fencedCodeBlocks")(a,k,b),a=d.subParser("githubCodeBlocks")(a,k,b),d.helper.forEach(n,function(c){a=d.subParser("runExtension")(c,a,k,b)});for(var c=0;c<p.length;++c){var f=p[c];a=e[f](a,k,b)}return a=a.replace(/~D/g,"$$"),a=a.replace(/~T/g,"~"),d.helper.forEach(o,function(c){a=d.subParser("runExtension")(c,a,k,b)}),a=a.replace(/<br \/>(?=<\/?(p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math|style|section|slide|header|footer|nav|article|aside|address|audio|canvas|figure|hgroup|output|video|li)(\b|>))/g,"")},this.setOption=function(a,b){k[a]=b},this.getOption=function(a){return k[a]},this.getOptions=function(){return k},this.addExtension=function(a,b){b=b||null,i(a,b)},this.useExtension=function(a){i(a)},this.setFlavor=function(a){if(h.hasOwnProperty(a)){var b=h[a];for(var c in b)b.hasOwnProperty(c)&&(k[c]=b[c])}},this.removeExtension=function(a){d.helper.isArray(a)||(a=[a]);for(var b=0;b<a.length;++b){for(var c=a[b],e=0;e<superExtensions.length;++e)superExtensions[e]===c&&superExtensions[e].splice(e,1);for(var f=0;f<m.length;++f)m[f]===c&&m[f].splice(f,1);for(var g=0;g<n.length;++g)n[g]===c&&n[g].splice(g,1);for(var h=0;h<o.length;++h)o[h]===c&&o[h].splice(h,1)}},this.getAllExtensions=function(){return{"super":l,line:m,language:n,output:o}}},d.subParser("anchors",function(a,b,c){"use strict";var e=function(a,b,e,f,g,h,i,j){d.helper.isUndefined(j)&&(j=""),a=b;var k=e,l=f.toLowerCase(),m=g,n=j;if(!m)if(l||(l=k.toLowerCase().replace(/ ?\n/g," ")),m="#"+l,d.helper.isUndefined(c.gUrls[l])){if(!(a.search(/\(\s*\)$/m)>-1))return a;m=""}else m=c.gUrls[l],d.helper.isUndefined(c.gTitles[l])||(n=c.gTitles[l]);m=d.helper.escapeCharacters(m,"*_",!1);var o='<a href="'+m+'"';return""!==n&&null!==n&&(n=n.replace(/"/g,"&quot;"),n=d.helper.escapeCharacters(n,"*_",!1),o+=' title="'+n+'"'),o+=">"+k+"</a>"};return a=a.replace(/(\[((?:\[[^\]]*\]|[^\[\]])*)\][ ]?(?:\n[ ]*)?\[(.*?)\])()()()()/g,e),a=a.replace(/(\[((?:\[[^\]]*\]|[^\[\]])*)\]\([ \t]*()<?(.*?(?:\(.*?\).*?)?)>?[ \t]*((['"])(.*?)\6[ \t]*)?\))/g,e),a=a.replace(/(\[([^\[\]]+)\])()()()()()/g,e)}),d.subParser("autoLinks",function(a,b){"use strict";function c(a,b){var c=d.subParser("unescapeSpecialChars")(b);return d.subParser("encodeEmailAddress")(c)}var e=/\b(((https?|ftp|dict):\/\/|www\.)[^'">\s]+\.[^'">\s\]\)]+)(?=\)|]|\s|$)(?!["<>])/gi,f=/<(((https?|ftp|dict):\/\/|www\.)[^'">\s]+)>/gi,g=/\b(?:mailto:)?([-.\w]+@[-a-z0-9]+(\.[-a-z0-9]+)*\.[a-z]+)\b(?!["<>])/gi,h=/<(?:mailto:)?([-.\w]+@[-a-z0-9]+(\.[-a-z0-9]+)*\.[a-z]+)>/gi;return a=a.replace(f,'<a href="$1">$1</a>'),a=a.replace(h,c),b.simplifiedAutoLink&&(a=a.replace(e,'<a href="$1">$1</a>'),a=a.replace(g,c)),a}),d.subParser("blockGamut",function(a,b,c){"use strict";var e=d.subParser("hashBlock")("<hr />",b,c);return a=a.replace(/^[ ]{0,2}([ ]?\*[ ]?){3,}[ \t]*$/gm,e),a=a.replace(/^[ ]{0,2}([ ]?\-[ ]?){3,}[ \t]*$/gm,e),a=a.replace(/^[ ]{0,2}([ ]?_[ ]?){3,}[ \t]*$/gm,e),a=d.subParser("lists")(a,b,c),a=d.subParser("fencedCodeBlocks")(a,b,c),a=d.subParser("githubCodeBlocks")(a,b,c),a=d.subParser("codeBlocks")(a,b,c),a=d.subParser("blockQuotes")(a,b,c),a=d.subParser("tables")(a,b,c),a=d.subParser("headers")(a,b,c),a=d.subParser("hashHTMLBlocks")(a,b,c),a=d.subParser("paragraphs")(a,b,c)}),d.subParser("blockQuotes",function(a,b,c){"use strict";return a=a.replace(/((^[ \t]*>(?:\[(\S+?)\])?[ \t]?.+\n(.+\n)*\n*)+)/gm,function(a,e,f,g){var h=e;return g=g||"default",h=h.replace(/^[ \t]*>(?:\[(\S+?)\])?[ \t]?/gm,"~0"),h=h.replace(/~0/g,""),h=h.replace(/^[ \t]+$/gm,""),h=d.subParser("blockGamut")(h,b,c),h=h.replace(/(^|\n)/g,"$1  "),h=h.replace(/(\s*<pre>[^\r]+?<\/pre>)/gm,function(a,b){var c=b;return c=c.replace(/^  /gm,"~0"),c=c.replace(/~0/g,"")}),d.subParser("hashBlock")('<blockquote class="'+g+'">\n'+h+"\n</blockquote>",b,c)})}),d.subParser("catelog",function(a){"use strict";return options.catelists?a=a.replace(/!([a-z][a-z0-9-_]*)\s/g,function(a,b){var c=null;return $.each(options.catelists,function(a,d){return d.name===b?(c=d,!1):void 0}),c?'<a href="'+c.name+'" title="'+c.title+'" >'+c.title+"</a>":a}):a}),d.subParser("codeBlocks",function(a,b,c){"use strict";a+="~0";var e=/(?:\n\n|^)((?:(?:[ ]{4}|\t).*\n+)+)(\n*[ ]{0,3}[^ \t\n]|(?=~0))/g;return a=a.replace(e,function(a,e,f){var g=e,h=f,i="\n";return g=d.subParser("outdent")(g),g=d.subParser("encodeCode")(g),g=d.subParser("detab")(g),g=g.replace(/^\n+/g,""),g=g.replace(/\n+$/g,""),b.omitExtraWLInCodeBlocks&&(i=""),g="<pre><code>"+g+i+"</code></pre>",d.subParser("hashBlock")(g,b,c)+h}),a=a.replace(/~0/,"")}),d.subParser("codeSpans",function(a){"use strict";return a=a.replace(/(^|[^\\])(`+)([^\r]*?[^`])\2(?!`)/gm,function(a,b,c,e){var f=e;return f=f.replace(/^([ \t]*)/g,""),f=f.replace(/[ \t]*$/g,""),f=d.subParser("encodeCode")(f),b+"<code>"+f+"</code>"})}),d.subParser("detab",function(a){"use strict";return a=a.replace(/\t(?=\t)/g,"    "),a=a.replace(/\t/g,"~A~B"),a=a.replace(/~B(.+?)~A/g,function(a,b){for(var c=b,d=4-c.length%4,e=0;d>e;e++)c+=" ";return c}),a=a.replace(/~A/g,"    "),a=a.replace(/~B/g,"")}),d.subParser("encodeAmpsAndAngles",function(a){"use strict";return a=a.replace(/&(?!#?[xX]?(?:[0-9a-fA-F]+|\w+);)/g,"&amp;"),a=a.replace(/<(?![a-z\/?\$!])/gi,"&lt;")}),d.subParser("encodeBackslashEscapes",function(a){"use strict";return a=a.replace(/\\(\\)/g,d.helper.escapeCharactersCallback),a=a.replace(/\\([`*_{}\[\]()>#+-.!])/g,d.helper.escapeCharactersCallback)}),d.subParser("encodeCode",function(a){"use strict";return a=a.replace(/&/g,"&amp;"),a=a.replace(/</g,"&lt;"),a=a.replace(/>/g,"&gt;"),a=d.helper.escapeCharacters(a,"*_{}[]\\~",!1)}),d.subParser("encodeEmailAddress",function(a){"use strict";var b=[function(a){return"&#"+a.charCodeAt(0)+";"},function(a){return"&#x"+a.charCodeAt(0).toString(16)+";"},function(a){return a}];return a="mailto:"+a,a=a.replace(/./g,function(a){if("@"===a)a=b[Math.floor(2*Math.random())](a);else if(":"!==a){var c=Math.random();a=c>.9?b[2](a):c>.45?b[1](a):b[0](a)}return a}),a='<a href="'+a+'">'+a+"</a>",a=a.replace(/">.+:/g,'">')}),d.subParser("escapeSpecialCharsWithinTagAttributes",function(a){"use strict";var b=/(<[a-z\/!$]("[^"]*"|'[^']*'|[^'">])*>|<!(--.*?--\s*)+>)/gi;return a=a.replace(b,function(a){var b=a.replace(/(.)<\/?code>(?=.)/g,"$1`");return b=d.helper.escapeCharacters(b,"\\`*_",!1)})}),d.subParser("fencedCodeBlocks",function(a,b,c){"use strict";return b.ghCodeBlocks?(a+="~0",a=a.replace(/(?:^|\n)(?:~T){3}(.*)\n([\s\S]*?)\n(?:~T){3}/g,function(a,e,f){var g=e,h=f,i="\n";return b.omitExtraWLInCodeBlocks&&(i=""),h=d.subParser("encodeCode")(h),h=d.subParser("detab")(h),h=h.replace(/^\n+/g,""),h=h.replace(/\n+$/g,""),h="<pre><code"+(g?' class="'+g+'"':"")+">"+h+i+"</code></pre>",d.subParser("hashBlock")(h,b,c)}),a=a.replace(/~0/,"")):a}),d.subParser("githubCodeBlocks",function(a,b,c){"use strict";return b.ghCodeBlocks?(a+="~0",a=a.replace(/(?:^|\n)```(.*)\n([\s\S]*?)\n```/g,function(a,e,f){var g=b.omitExtraWLInCodeBlocks?"":"\n";return f=d.subParser("encodeCode")(f),f=d.subParser("detab")(f),f=f.replace(/^\n+/g,""),f=f.replace(/\n+$/g,""),f="<pre><code"+(e?' class="'+e+" language-"+e+'"':"")+">"+f+g+"</code></pre>",d.subParser("hashBlock")(f,b,c)}),a=a.replace(/~0/,"")):a}),d.subParser("hashBlock",function(a,b,c){"use strict";return a=a.replace(/(^\n+|\n+$)/g,""),"\n\n~K"+(c.gHtmlBlocks.push(a)-1)+"K\n\n"}),d.subParser("hashElement",function(a,b,c){"use strict";return function(a,b){var d=b;return d=d.replace(/\n\n/g,"\n"),d=d.replace(/^\n/,""),d=d.replace(/\n+$/g,""),d="\n\n~K"+(c.gHtmlBlocks.push(d)-1)+"K\n\n"}}),d.subParser("hashHTMLBlocks",function(a,b,c){"use strict";return a=a.replace(/\n/g,"\n\n"),a=a.replace(/^(<(slide|p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math|ins|del)\b[^\r]*?\n<\/\2>[ \t]*(?=\n+))/gm,d.subParser("hashElement")(a,b,c)),a=a.replace(/^(<(slide|p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math|style|section|header|footer|nav|article|aside|address|audio|canvas|figure|hgroup|output|video)\b[^\r]*?<\/\2>[ \t]*(?=\n+)\n)/gm,d.subParser("hashElement")(a,b,c)),
a=a.replace(/(\n[ ]{0,3}(<(hr)\b([^<>])*?\/?>)[ \t]*(?=\n{2,}))/g,d.subParser("hashElement")(a,b,c)),a=a.replace(/(\n\n[ ]{0,3}<!(--[^\r]*?--\s*)+>[ \t]*(?=\n{2,}))/g,d.subParser("hashElement")(a,b,c)),a=a.replace(/(?:\n\n)([ ]{0,3}(?:<([?%])[^\r]*?\2>)[ \t]*(?=\n{2,}))/g,d.subParser("hashElement")(a,b,c)),a=a.replace(/\n\n/g,"\n")}),d.subParser("hashHTMLSpans",function(a,b,c){"use strict";for(var e=d.helper.matchRecursiveRegExp(a,"<code\\b[^>]*>","</code>","gi"),f=0;f<e.length;++f)a=a.replace(e[f][0],"~L"+(c.gHtmlSpans.push(e[f][0])-1)+"L");return a}),d.subParser("unhashHTMLSpans",function(a,b,c){"use strict";for(var d=0;d<c.gHtmlSpans.length;++d)a=a.replace("~L"+d+"L",c.gHtmlSpans[d]);return a}),d.subParser("headers",function(a,b,c){"use strict";function e(a){var b=a.toLowerCase().replace(/[^\w]+/g,"-"),e=/^[\u4e00-\u9fa5]+$/.test(a),g=e?escape(a).replace(/\%/g,""):b;return c.hashLinkCounts[g]?g=g+"-"+c.hashLinkCounts[g]++:c.hashLinkCounts[g]=1,f===!0&&(f="section"),d.helper.isString(f)&&(g=f+g),g}var f=b.prefixHeaderId,g=isNaN(parseInt(b.headerLevelStart))?1:parseInt(b.headerLevelStart);return a=a.replace(/^(.+)[ \t]*\n=+[ \t]*\n+/gm,function(a,f){var h=d.subParser("spanGamut")(f,b,c),i=g,j=b.noHeaderId?"":' id="'+e(h)+'"',k="<h"+i+j+">"+h+"</h"+i+">";return d.subParser("hashBlock")(k,b,c)}),a=a.replace(/^(.+)[ \t]*\n-+[ \t]*\n+/gm,function(a,f){var h=d.subParser("spanGamut")(f,b,c),i=g+1,j=b.noHeaderId?"":' id="'+e(h)+'"',k="<h"+i+j+">"+h+"</h"+i+">";return d.subParser("hashBlock")(k,b,c)}),a=a.replace(/^(#{1,6})[ \t]*(.+?)[ \t]*#*\n+/gm,function(a,f,h){var i=d.subParser("spanGamut")(h,b,c),j=g-1+f.length,k=b.noHeaderId?"":' id="'+e(i)+'"',l="<h"+j+k+">"+i+"</h"+j+">";return d.subParser("hashBlock")(l,b,c)})}),d.subParser("images",function(a,b,c){"use strict";function e(a,e,f,g,h,i,j,k){var l=c.gUrls,m=c.gTitles,n=c.gDimensions;if(f=f.toLowerCase(),k||(k=""),""===g||null===g){if((""===f||null===f)&&(f=e.toLowerCase().replace(/ ?\n/g," ")),g="#"+f,d.helper.isUndefined(l[f]))return a;g=l[f],d.helper.isUndefined(m[f])||(k=m[f]),d.helper.isUndefined(n[f])||(h=n[f].width,i=n[f].height)}if(b.book&&!g.match(/^(https?)?:\/\//i)){var o=decodeURIComponent(b.book.articleId),p=o.substring(0,o.lastIndexOf("/")+1);0===g.indexOf("/")?g=g.substring(1):0===g.indexOf("../")?(p=p.split("/").slice(0,-g.match(/^(\.\.\/)+/g)[0].split("/").length).join("/")+"/",g=p.replace(/^\//gi,"")+g.replace(/^(\.\.\/)+/g,"")):g=0===g.indexOf("./")?p+g.substring(2):p+g,g=g.replace(/\/\//gi,"/"),g="/book/preview/image?book_id="+b.book.id+"&file="+g+"&ref="+b.book.ref}e=e.replace(/"/g,"&quot;"),e=d.helper.escapeCharacters(e,"*_",!1),g=d.helper.escapeCharacters(g,"*_",!1);var q='<img src="'+g+'" alt="'+e+'"';return k&&(k=k.replace(/"/g,"&quot;"),k=d.helper.escapeCharacters(k,"*_",!1),q+=' title="'+k+'"'),h&&i&&(h="*"===h?"auto":h,i="*"===i?"auto":i,q+=' width="'+h+'"',q+=' height="'+i+'"'),q+=" />"}var f=/!\[(.*?)]\s?\([ \t]*()<?(\S+?)>?(?: =([*\d]+[A-Za-z%]{0,4})x([*\d]+[A-Za-z%]{0,4}))?[ \t]*(?:(['"])(.*?)\6[ \t]*)?\)/g,g=/!\[(.*?)][ ]?(?:\n[ ]*)?\[(.*?)]()()()()()/g;return a=a.replace(g,e),a=a.replace(f,e)}),d.subParser("italicsAndBold",function(a,b){"use strict";return b.literalMidWordUnderscores?(a=a.replace(/(^|\s|>|\b)__(?=\S)([^]+?)__(?=\b|<|\s|$)/gm,"$1<strong>$2</strong>"),a=a.replace(/(^|\s|>|\b)_(?=\S)([^]+?)_(?=\b|<|\s|$)/gm,"$1<em>$2</em>"),a=a.replace(/(\*\*)(?=\S)([^\r]*?\S[*]*)\1/g,"<strong>$2</strong>"),a=a.replace(/(\*)(?=\S)([^\r]*?\S)\1/g,"<em>$2</em>")):(a=a.replace(/(\*\*|__)(?=\S)([^\r]*?\S[*_]*)\1/g,"<strong>$2</strong>"),a=a.replace(/(\*|_)(?=\S)([^\r]*?\S)\1/g,"<em>$2</em>")),a}),d.subParser("lists",function(a,b,c){"use strict";function e(a,e){c.gListLevel++,a=a.replace(/\n{2,}$/,"\n"),a+="~0";var f=/(\n)?(^[ \t]*)([*+-]|\d+[.])[ \t]+((\[(x| )?])?[ \t]*[^\r]+?(\n{1,2}))(?=\n*(~0|\2([*+-]|\d+[.])[ \t]+))/gm,g=/\n[ \t]*\n(?!~0)/.test(a);return a=a.replace(f,function(a,e,f,h,i,j,k){k=k&&""!==k.trim();var l=d.subParser("outdent")(i,b,c),m="";return j&&b.tasklists&&(m=' class="task-list-item" style="list-style-type: none;"',l=l.replace(/^[ \t]*\[(x| )?]/m,function(){var a='<input type="checkbox" disabled style="margin: 0px 0.35em 0.25em -1.6em; vertical-align: middle;"';return k&&(a+=" checked"),a+=">"})),e||l.search(/\n{2,}/)>-1||l.match("^#{1,6}")?(l=d.subParser("blockGamut")(l,b,c),l=d.subParser("hashBlock")(l,b,c)):(l=d.subParser("lists")(l,b,c),l=l.replace(/\n$/,""),l=g?d.subParser("paragraphs")(l,b,c):d.subParser("spanGamut")(l,b,c)),l="<li"+m+">"+l+"</li>"}),a=a.replace(/~0/g,""),c.gListLevel--,e&&(a=a.replace(/\s+$/,"")),a}function f(a,b,c){var d="ul"===b?/^ {0,2}\d+\.[ \t]/gm:/^ {0,2}[*+-][ \t]/gm,f=[],g="";if(-1!==a.search(d)){!function i(a){var f=a.search(d);-1!==f?(g+="\n\n<"+b+">"+e(a.slice(0,f),!!c)+"</"+b+">\n\n",b="ul"===b?"ol":"ul",d="ul"===b?/^ {0,2}\d+\.[ \t]/gm:/^ {0,2}[*+-][ \t]/gm,i(a.slice(f))):g+="\n\n<"+b+">"+e(a,!!c)+"</"+b+">\n\n"}(a);for(var h=0;h<f.length;++h);}else g="\n\n<"+b+">"+e(a,!!c)+"</"+b+">\n\n";return g}a+="~0";var g=/^(([ ]{0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(~0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/gm;return c.gListLevel?a=a.replace(g,function(a,b,c){var d=c.search(/[*+-]/g)>-1?"ul":"ol";return f(b,d,!0)}):(g=/(\n\n|^\n?)(([ ]{0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(~0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/gm,a=a.replace(g,function(a,b,c,d){var e=d.search(/[*+-]/g)>-1?"ul":"ol";return f(c,e)})),a=a.replace(/~0/,"")}),d.subParser("outdent",function(a){"use strict";return a=a.replace(/^(\t|[ ]{1,4})/gm,"~0"),a=a.replace(/~0/g,"")}),d.subParser("paragraphs",function(a,b,c){"use strict";a=a.replace(/^\n+/g,""),a=a.replace(/\n+$/g,"");for(var e=a.split(/\n{2,}/g),f=[],g=e.length,h=0;g>h;h++){var i=e[h];i.search(/~K(\d+)K/g)>=0?f.push(i):i.search(/\S/)>=0&&(i=d.subParser("spanGamut")(i,b,c),i=i.replace(/^([ \t]*)/g,"<p>"),i+="</p>",f.push(i))}for(g=f.length,h=0;g>h;h++)for(;f[h].search(/~K(\d+)K/)>=0;){var j=c.gHtmlBlocks[RegExp.$1];j=j.replace(/\$/g,"$$$$"),f[h]=f[h].replace(/~K\d+K/,j)}return f.join("\n\n")}),d.subParser("runExtension",function(a,b,c,d){"use strict";if(a.filter)b=a.filter(b,d.converter,c);else if(a.regex){var e=a.regex;!e instanceof RegExp&&(e=new RegExp(e,"g")),b=b.replace(e,a.replace)}return b}),d.subParser("spanGamut",function(a,b,c){"use strict";return a=d.subParser("codeSpans")(a,b,c),d.helper.forEach(c.lineExtensions,function(e){a=d.subParser("runExtension")(e,a,b,c)}),a=d.subParser("escapeSpecialCharsWithinTagAttributes")(a,b,c),a=d.subParser("encodeBackslashEscapes")(a,b,c),a=d.subParser("images")(a,b,c),a=d.subParser("anchors")(a,b,c),a=d.subParser("autoLinks")(a,b,c),a=d.subParser("encodeAmpsAndAngles")(a,b,c),a=d.subParser("italicsAndBold")(a,b,c),a=d.subParser("strikethrough")(a,b,c),a=a.replace(/\n+(?!$)/g,"<br />")}),d.subParser("strikethrough",function(a,b){"use strict";return b.strikethrough&&(a=a.replace(/(?:~T){2}([^~]+)(?:~T){2}/g,"<del>$1</del>")),a}),d.subParser("stripBlankLines",function(a){"use strict";return a.replace(/^[ \t]+$/gm,"")}),d.subParser("stripLinkDefinitions",function(a,b,c){"use strict";var e=/^ {0,3}\[(.+)]:[ \t]*\n?[ \t]*<?(\S+?)>?(?: =([*\d]+[A-Za-z%]{0,4})x([*\d]+[A-Za-z%]{0,4}))?[ \t]*\n?[ \t]*(?:(\n*)["|'(](.+?)["|')][ \t]*)?(?:\n+|(?=~0))/gm;return a+="~0",a=a.replace(e,function(a,e,f,g,h,i,j){return e=e.toLowerCase(),c.gUrls[e]=d.subParser("encodeAmpsAndAngles")(f),i?i+j:(j&&(c.gTitles[e]=j.replace(/"|'/g,"&quot;")),b.parseImgDimensions&&g&&h&&(c.gDimensions[e]={width:g,height:h}),"")}),a=a.replace(/~0/,"")}),d.subParser("tables",function(a,b,c){"use strict";var e=function(){var a,e={};return e.th=function(a,e){var f="";return a=a.trim(),""===a?"":(b.tableHeaderId&&(f=' id="'+a.replace(/ /g,"_").toLowerCase()+'"'),a=d.subParser("spanGamut")(a,b,c),e=e&&""!==e.trim()?' style="'+e+'"':"","<th"+f+e+">"+a+"</th>")},e.td=function(a,e){var f=d.subParser("spanGamut")(a.trim(),b,c);return e=e&&""!==e.trim()?' style="'+e+'"':"","<td"+e+">"+f+"</td>"},e.ths=function(){var a="",b=0,c=[].slice.apply(arguments[0]),d=[].slice.apply(arguments[1]);for(b;b<c.length;b+=1)a+=e.th(c[b],d[b])+"\n";return a},e.tds=function(){var a="",b=0,c=[].slice.apply(arguments[0]),d=[].slice.apply(arguments[1]);for(b;b<c.length;b+=1)a+=e.td(c[b],d[b])+"\n";return a},e.thead=function(){var a,b=[].slice.apply(arguments[0]),c=[].slice.apply(arguments[1]);return a="<thead>\n",a+="<tr>\n",a+=e.ths.apply(this,[b,c]),a+="</tr>\n",a+="</thead>\n"},e.tr=function(){var a,b=[].slice.apply(arguments[0]),c=[].slice.apply(arguments[1]);return a="<tr>\n",a+=e.tds.apply(this,[b,c]),a+="</tr>\n"},a=function(a){var b,c,d=0,f=a.split("\n"),g=[];for(d;d<f.length;d+=1){if(b=f[d],b.match(/^[|].*[|]\s*$/)){b=b.trim();var h=[],i=f[d+1].trim(),j=[],k=0;if(i.match(/^[|][-=|: ]+[|]$/))for(j=i.substring(1,i.length-1).split("|"),k=0;k<j.length;++k)j[k]=j[k].trim(),j[k].match(/^[:][-=| ]+[:]$/)?j[k]="text-align:center;":j[k].match(/^[-=| ]+[:]$/)?j[k]="text-align:right;":j[k].match(/^[:][-=| ]+$/)?j[k]="text-align:left;":j[k]="";if(h.push("<table>"),c=b.substring(1,b.length-1).split("|"),0===j.length)for(k=0;k<c.length;++k)j.push("text-align:left");if(h.push(e.thead.apply(this,[c,j])),b=f[++d],b.trim().match(/^[|][-=|: ]+[|]$/)){for(b=f[++d],h.push("<tbody>");b.trim().match(/^[|].*[|]$/);)b=b.trim(),h.push(e.tr.apply(this,[b.substring(1,b.length-1).split("|"),j])),b=f[++d];h.push("</tbody>"),h.push("</table>\n"),g.push(h.join("\n"));continue}b=f[--d]}g.push(b)}return g.join("\n")},{parse:a}};if(b.tables){var f=e();return a=a.replace(/\\\|/g,"~S"),a=f.parse(a),a=a.replace(/~S/,"|")}return a}),d.subParser("unescapeSpecialChars",function(a){"use strict";return a=a.replace(/~E(\d+)E/g,function(a,b){var c=parseInt(b);return String.fromCharCode(c)})});var i=this;"undefined"!=typeof module&&module.exports?module.exports=d:"function"==typeof define&&(define.amd||define.cmd)?define("component/showdown/dist/showdown.min",[],function(){"use strict";return d}):i.showdown=d,function(a){"use strict";function b(a,b,c){var d,e,f,g='<ul class="markdown-toc-list">',h=0;b=b||1;for(var i=0,j=a.length;j>i;i++)e=a[i].text,f=parseInt(a[i].level),d=a[i].id,b>f||f>c||(g+=f>h?new Array(f-h).join("<li><ul>"):h>f?new Array(h-f+2).join("</ul></li>"):"</ul></li>",g+='<li><a class="toc-level-'+f+'" href="#'+d+'" level="'+f+'">'+e+"</a><ul>",h=f);return g+=new Array(h+1).join("</ul></li>"),g+="</ul>",'<div class="markdown-toc">'+g.replace(/\r?\n?<ul><\/ul>/g,"")+"</div>"}var c=function(){return[{type:"output",filter:function(a){var c=[];return a.replace(/<h(\d)\s+id=(['"])([^'"]+)\2\s*>(.*?)<\/h\1>/gi,function(a,b,d,e,f){c.push({text:f.replace(/<\/?.+?>/g,""),level:b,id:e})}),a=a.replace(/^<p>\[toc(?:=(\d)(?:,(\d))?)?\]<\/p>$/gim,function(a,d,e){return d?e||(e=d,d=1):(d=1,e=9),b(c,d,e)})}}]};"undefined"!=typeof a&&a.extension?a.extension("toc",c):"undefined"!=typeof window&&window.showdown&&window.showdown.extension&&window.showdown.extension("toc",c),"undefined"!=typeof module&&(module.exports=c)}(d)}.call(this),!function(){function a(a){return a.replace(t,"").replace(u,",").replace(v,"").replace(w,"").replace(x,"").split(/^$|,+/)}function b(a){return"'"+a.replace(/('|\\)/g,"\\$1").replace(/\r/g,"\\r").replace(/\n/g,"\\n")+"'"}function c(c,d){function e(a){return m+=a.split(/\n/).length-1,k&&(a=a.replace(/[\n\r\t\s]+/g," ").replace(/<!--.*?-->/g,"")),a&&(a=s[1]+b(a)+s[2]+"\n"),a}function f(b){var c=m;if(j?b=j(b,d):g&&(b=b.replace(/\n/g,function(){return m++,"$line="+m+";"})),0===b.indexOf("=")){var e=l&&!/^=[=#]/.test(b);if(b=b.replace(/^=[=#]?|[\s;]*$/g,""),e){var f=b.replace(/\s*\([^\)]+\)/,"");n[f]||/^(include|print)$/.test(f)||(b="$escape("+b+")")}else b="$string("+b+")";b=s[1]+b+s[2]}return g&&(b="$line="+c+";"+b),r(a(b),function(a){if(a&&!p[a]){var b;b="print"===a?u:"include"===a?v:n[a]?"$utils."+a:o[a]?"$helpers."+a:"$data."+a,w+=a+"="+b+",",p[a]=!0}}),b+"\n"}var g=d.debug,h=d.openTag,i=d.closeTag,j=d.parser,k=d.compress,l=d.escape,m=1,p={$data:1,$filename:1,$utils:1,$helpers:1,$out:1,$line:1},q="".trim,s=q?["$out='';","$out+=",";","$out"]:["$out=[];","$out.push(",");","$out.join('')"],t=q?"$out+=text;return $out;":"$out.push(text);",u="function(){var text=''.concat.apply('',arguments);"+t+"}",v="function(filename,data){data=data||$data;var text=$utils.$include(filename,data,$filename);"+t+"}",w="'use strict';var $utils=this,$helpers=$utils.$helpers,"+(g?"$line=0,":""),x=s[0],y="return new String("+s[3]+");";r(c.split(h),function(a){a=a.split(i);var b=a[0],c=a[1];1===a.length?x+=e(b):(x+=f(b),c&&(x+=e(c)))});var z=w+x+y;g&&(z="try{"+z+"}catch(e){throw {filename:$filename,name:'Render Error',message:e.message,line:$line,source:"+b(c)+".split(/\\n/)[$line-1].replace(/^[\\s\\t]+/,'')};}");try{var A=new Function("$data","$filename",z);return A.prototype=n,A}catch(B){throw B.temp="function anonymous($data,$filename) {"+z+"}",B}}var d=function(a,b){return"string"==typeof b?q(b,{filename:a}):g(a,b)};d.version="3.0.0",d.config=function(a,b){e[a]=b};var e=d.defaults={openTag:"<%",closeTag:"%>",escape:!0,cache:!0,compress:!1,parser:null},f=d.cache={};d.render=function(a,b){return q(a,b)};var g=d.renderFile=function(a,b){var c=d.get(a)||p({filename:a,name:"Render Error",message:"Template not found"});return b?c(b):c};d.get=function(a){var b;if(f[a])b=f[a];else if("object"==typeof document){var c=document.getElementById(a);if(c){var d=(c.value||c.innerHTML).replace(/^\s*|\s*$/g,"");b=q(d,{filename:a})}}return b};var h=function(a,b){return"string"!=typeof a&&(b=typeof a,"number"===b?a+="":a="function"===b?h(a.call(a)):""),a},i={"<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","&":"&#38;"},j=function(a){return i[a]},k=function(a){return h(a).replace(/&(?![\w#]+;)|[<>"']/g,j)},l=Array.isArray||function(a){return"[object Array]"==={}.toString.call(a)},m=function(a,b){var c,d;if(l(a))for(c=0,d=a.length;d>c;c++)b.call(a,a[c],c,a);else for(c in a)b.call(a,a[c],c)},n=d.utils={$helpers:{},$include:g,$string:h,$escape:k,$each:m};d.helper=function(a,b){o[a]=b};var o=d.helpers=n.$helpers;d.onerror=function(a){var b="Template Error\n\n";for(var c in a)b+="<"+c+">\n"+a[c]+"\n\n";"object"==typeof console&&console.error(b)};var p=function(a){return d.onerror(a),function(){return"{Template Error}"}},q=d.compile=function(a,b){function d(c){try{return new i(c,h)+""}catch(d){return b.debug?p(d)():(b.debug=!0,q(a,b)(c))}}b=b||{};for(var g in e)void 0===b[g]&&(b[g]=e[g]);var h=b.filename;try{var i=c(a,b)}catch(j){return j.filename=h||"anonymous",j.name="Syntax Error",p(j)}return d.prototype=i.prototype,d.toString=function(){return i.toString()},h&&b.cache&&(f[h]=d),d},r=n.$each,s="break,case,catch,continue,debugger,default,delete,do,else,false,finally,for,function,if,in,instanceof,new,null,return,switch,this,throw,true,try,typeof,var,void,while,with,abstract,boolean,byte,char,class,const,double,enum,export,extends,final,float,goto,implements,import,int,interface,long,native,package,private,protected,public,short,static,super,synchronized,throws,transient,volatile,arguments,let,yield,undefined",t=/\/\*[\w\W]*?\*\/|\/\/[^\n]*\n|\/\/[^\n]*$|"(?:[^"\\]|\\[\w\W])*"|'(?:[^'\\]|\\[\w\W])*'|[\s\t\n]*\.[\s\t\n]*[$\w\.]+/g,u=/[^\w$]+/g,v=new RegExp(["\\b"+s.replace(/,/g,"\\b|\\b")+"\\b"].join("|"),"g"),w=/^\d[^,]*|,\d[^,]*/g,x=/^,+|,+$/g;"function"==typeof define?define("component/template/template",[],function(){return d}):"undefined"!=typeof exports?module.exports=d:this.template=d}(),function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){function onTag(tag,html,options){}function onIgnoreTag(tag,html,options){}function onTagAttr(tag,name,value){}function onIgnoreTagAttr(tag,name,value){}function escapeHtml(html){return html.replace(REGEXP_LT,"&lt;").replace(REGEXP_GT,"&gt;")}function safeAttrValue(tag,name,value,cssFilter){if(cssFilter=cssFilter||defaultCSSFilter,value=friendlyAttrValue(value),"href"===name||"src"===name){if(value=_.trim(value),"#"===value)return"#";if("http://"!==value.substr(0,7)&&"https://"!==value.substr(0,8)&&"mailto:"!==value.substr(0,7)&&isNaN(value)&&"/"!==value[0])return""}else if("background"===name){if(REGEXP_DEFAULT_ON_TAG_ATTR_4.lastIndex=0,REGEXP_DEFAULT_ON_TAG_ATTR_4.test(value))return""}else if("style"===name){if(REGEXP_DEFAULT_ON_TAG_ATTR_7.lastIndex=0,REGEXP_DEFAULT_ON_TAG_ATTR_7.test(value))return"";if(REGEXP_DEFAULT_ON_TAG_ATTR_8.lastIndex=0,REGEXP_DEFAULT_ON_TAG_ATTR_8.test(value)&&(REGEXP_DEFAULT_ON_TAG_ATTR_4.lastIndex=0,REGEXP_DEFAULT_ON_TAG_ATTR_4.test(value)))return"";value=cssFilter.process(value)}return value=escapeAttrValue(value)}function escapeQuote(str){return str.replace(REGEXP_QUOTE,"&quot;")}function unescapeQuote(str){return str.replace(REGEXP_QUOTE_2,'"')}function escapeHtmlEntities(str){return str.replace(REGEXP_ATTR_VALUE_1,function(str,code){return"x"===code[0]||"X"===code[0]?String.fromCharCode(parseInt(code.substr(1),16)):String.fromCharCode(parseInt(code,10))})}function escapeDangerHtml5Entities(str){return str.replace(REGEXP_ATTR_VALUE_COLON,":").replace(REGEXP_ATTR_VALUE_NEWLINE," ")}function clearNonPrintableCharacter(str){for(var str2="",i=0,len=str.length;len>i;i++)str2+=str.charCodeAt(i)<32?" ":str.charAt(i);return _.trim(str2)}function friendlyAttrValue(str){return str=unescapeQuote(str),str=escapeHtmlEntities(str),str=escapeDangerHtml5Entities(str),str=clearNonPrintableCharacter(str)}function escapeAttrValue(str){return str=escapeQuote(str),str=escapeHtml(str)}function onIgnoreTagStripAll(){return""}function StripTagBody(tags,next){function isRemoveTag(tag){return isRemoveAllTag?!0:-1!==_.indexOf(tags,tag)}"function"!=typeof next&&(next=function(){});var isRemoveAllTag=!Array.isArray(tags),removeList=[],posStart=!1;return{onIgnoreTag:function(tag,html,options){if(isRemoveTag(tag)){if(options.isClosing){var ret="[/removed]",end=options.position+ret.length;return removeList.push([posStart!==!1?posStart:options.position,end]),posStart=!1,ret}return posStart||(posStart=options.position),"[removed]"}return next(tag,html,options)},remove:function(html){var rethtml="",lastPos=0;return _.forEach(removeList,function(pos){rethtml+=html.slice(lastPos,pos[0]),lastPos=pos[1]}),rethtml+=html.slice(lastPos)}}}function stripCommentTag(html){return html.replace(STRIP_COMMENT_TAG_REGEXP,"")}function stripBlankChar(html){var chars=html.split("");return chars=chars.filter(function(char){var c=char.charCodeAt(0);return 127===c?!1:31>=c?10===c||13===c:!0}),chars.join("")}var FilterCSS=require("cssfilter").FilterCSS,_=require("./util"),whiteList={a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","loop","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height"],ins:["datetime"],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],sup:[],strong:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","colspan","align","valign"],tfoot:["align","valign"],th:["width","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],video:["autoplay","controls","loop","preload","src","height","width"]},defaultCSSFilter=new FilterCSS,REGEXP_LT=/</g,REGEXP_GT=/>/g,REGEXP_QUOTE=/"/g,REGEXP_QUOTE_2=/&quot;/g,REGEXP_ATTR_VALUE_1=/&#([a-zA-Z0-9]*);?/gim,REGEXP_ATTR_VALUE_COLON=/&colon;?/gim,REGEXP_ATTR_VALUE_NEWLINE=/&newline;?/gim,REGEXP_DEFAULT_ON_TAG_ATTR_4=/((j\s*a\s*v\s*a|v\s*b|l\s*i\s*v\s*e)\s*s\s*c\s*r\s*i\s*p\s*t\s*|m\s*o\s*c\s*h\s*a)\:/gi,REGEXP_DEFAULT_ON_TAG_ATTR_7=/e\s*x\s*p\s*r\s*e\s*s\s*s\s*i\s*o\s*n\s*\(.*/gi,REGEXP_DEFAULT_ON_TAG_ATTR_8=/u\s*r\s*l\s*\(.*/gi,STRIP_COMMENT_TAG_REGEXP=/<!--[\s\S]*?-->/g;exports.whiteList=whiteList,exports.onTag=onTag,exports.onIgnoreTag=onIgnoreTag,exports.onTagAttr=onTagAttr,exports.onIgnoreTagAttr=onIgnoreTagAttr,exports.safeAttrValue=safeAttrValue,exports.escapeHtml=escapeHtml,exports.escapeQuote=escapeQuote,exports.unescapeQuote=unescapeQuote,exports.escapeHtmlEntities=escapeHtmlEntities,exports.escapeDangerHtml5Entities=escapeDangerHtml5Entities,exports.clearNonPrintableCharacter=clearNonPrintableCharacter,exports.friendlyAttrValue=friendlyAttrValue,exports.escapeAttrValue=escapeAttrValue,exports.onIgnoreTagStripAll=onIgnoreTagStripAll,exports.StripTagBody=StripTagBody,exports.stripCommentTag=stripCommentTag,exports.stripBlankChar=stripBlankChar,exports.cssFilter=defaultCSSFilter},{"./util":4,cssfilter:8}],2:[function(require,module,exports){function filterXSS(html,options){var xss=new FilterXSS(options);return xss.process(html)}var DEFAULT=require("./default"),parser=require("./parser"),FilterXSS=require("./xss");exports=module.exports=filterXSS,exports.FilterXSS=FilterXSS;for(var i in DEFAULT)exports[i]=DEFAULT[i];for(var i in parser)exports[i]=parser[i];"function"==typeof define&&(define.amd||define.cmd)&&define("component/xss/dist/xss",[],function(){return module.exports}),"undefined"!=typeof window&&(window.filterXSS=module.exports)},{"./default":1,"./parser":3,"./xss":5}],3:[function(require,module,exports){function getTagName(html){var i=html.indexOf(" ");if(-1===i)var tagName=html.slice(1,-1);else var tagName=html.slice(1,i+1);return tagName=_.trim(tagName).toLowerCase(),"/"===tagName.slice(0,1)&&(tagName=tagName.slice(1)),"/"===tagName.slice(-1)&&(tagName=tagName.slice(0,-1)),tagName}function isClosing(html){return"</"===html.slice(0,2)}function parseTag(html,onTag,escapeHtml){"user strict";var rethtml="",lastPos=0,tagStart=!1,quoteStart=!1,currentPos=0,len=html.length,currentHtml="",currentTagName="";for(currentPos=0;len>currentPos;currentPos++){var c=html.charAt(currentPos);if(tagStart===!1){if("<"===c){tagStart=currentPos;continue}}else if(quoteStart===!1){if("<"===c){rethtml+=escapeHtml(html.slice(lastPos,currentPos)),tagStart=currentPos,lastPos=currentPos;continue}if(">"===c){rethtml+=escapeHtml(html.slice(lastPos,tagStart)),currentHtml=html.slice(tagStart,currentPos+1),currentTagName=getTagName(currentHtml),rethtml+=onTag(tagStart,rethtml.length,currentTagName,currentHtml,isClosing(currentHtml)),lastPos=currentPos+1,tagStart=!1;continue}if(('"'===c||"'"===c)&&"="===html.charAt(currentPos-1)){quoteStart=c;continue}}else if(c===quoteStart){quoteStart=!1;continue}}return lastPos<html.length&&(rethtml+=escapeHtml(html.substr(lastPos))),rethtml}function parseAttr(html,onAttr){"user strict";function addAttr(name,value){if(name=_.trim(name),name=name.replace(REGEXP_ATTR_NAME,"").toLowerCase(),!(name.length<1)){var ret=onAttr(name,value||"");ret&&retAttrs.push(ret)}}for(var lastPos=0,retAttrs=[],tmpName=!1,len=html.length,i=0;len>i;i++){var v,j,c=html.charAt(i);if(tmpName!==!1||"="!==c)if(tmpName===!1||i!==lastPos||'"'!==c&&"'"!==c||"="!==html.charAt(i-1))if(" "!==c);else{if(tmpName===!1){if(j=findNextEqual(html,i),-1===j){v=_.trim(html.slice(lastPos,i)),addAttr(v),tmpName=!1,lastPos=i+1;continue}i=j-1;continue}if(j=findBeforeEqual(html,i-1),-1===j){v=_.trim(html.slice(lastPos,i)),v=stripQuoteWrap(v),addAttr(tmpName,v),tmpName=!1,lastPos=i+1;continue}}else{if(j=html.indexOf(c,i+1),-1===j)break;v=_.trim(html.slice(lastPos+1,j)),addAttr(tmpName,v),tmpName=!1,i=j,lastPos=i+1}else tmpName=html.slice(lastPos,i),lastPos=i+1}return lastPos<html.length&&(tmpName===!1?addAttr(html.slice(lastPos)):addAttr(tmpName,stripQuoteWrap(_.trim(html.slice(lastPos))))),_.trim(retAttrs.join(" "))}function findNextEqual(str,i){for(;i<str.length;i++){var c=str[i];if(" "!==c)return"="===c?i:-1}}function findBeforeEqual(str,i){for(;i>0;i--){var c=str[i];if(" "!==c)return"="===c?i:-1}}function isQuoteWrapString(text){return'"'===text[0]&&'"'===text[text.length-1]||"'"===text[0]&&"'"===text[text.length-1]}function stripQuoteWrap(text){return isQuoteWrapString(text)?text.substr(1,text.length-2):text}var _=require("./util"),REGEXP_ATTR_NAME=/[^a-zA-Z0-9_:\.\-]/gim;exports.parseTag=parseTag,exports.parseAttr=parseAttr},{"./util":4}],4:[function(require,module,exports){module.exports={indexOf:function(arr,item){var i,j;if(Array.prototype.indexOf)return arr.indexOf(item);for(i=0,j=arr.length;j>i;i++)if(arr[i]===item)return i;return-1},forEach:function(arr,fn,scope){var i,j;if(Array.prototype.forEach)return arr.forEach(fn,scope);for(i=0,j=arr.length;j>i;i++)fn.call(scope,arr[i],i,arr)},trim:function(str){return String.prototype.trim?str.trim():str.replace(/(^\s*)|(\s*$)/g,"")}}},{}],5:[function(require,module,exports){function isNull(obj){return void 0===obj||null===obj}function getAttrs(html){var i=html.indexOf(" ");if(-1===i)return{html:"",closing:"/"===html[html.length-2]};html=_.trim(html.slice(i+1,-1));var isClosing="/"===html[html.length-1];return isClosing&&(html=_.trim(html.slice(0,-1))),{html:html,closing:isClosing}}function FilterXSS(options){options=options||{},options.stripIgnoreTag&&(options.onIgnoreTag&&console.error('Notes: cannot use these two options "stripIgnoreTag" and "onIgnoreTag" at the same time'),options.onIgnoreTag=DEFAULT.onIgnoreTagStripAll),options.whiteList=options.whiteList||DEFAULT.whiteList,options.onTag=options.onTag||DEFAULT.onTag,options.onTagAttr=options.onTagAttr||DEFAULT.onTagAttr,options.onIgnoreTag=options.onIgnoreTag||DEFAULT.onIgnoreTag,options.onIgnoreTagAttr=options.onIgnoreTagAttr||DEFAULT.onIgnoreTagAttr,options.safeAttrValue=options.safeAttrValue||DEFAULT.safeAttrValue,options.escapeHtml=options.escapeHtml||DEFAULT.escapeHtml,options.css=options.css||{},this.options=options,this.cssFilter=new FilterCSS(options.css)}var FilterCSS=require("cssfilter").FilterCSS,DEFAULT=require("./default"),parser=require("./parser"),parseTag=parser.parseTag,parseAttr=parser.parseAttr,_=require("./util");FilterXSS.prototype.process=function(html){if(html=html||"",html=html.toString(),!html)return"";var me=this,options=me.options,whiteList=options.whiteList,onTag=options.onTag,onIgnoreTag=options.onIgnoreTag,onTagAttr=options.onTagAttr,onIgnoreTagAttr=options.onIgnoreTagAttr,safeAttrValue=options.safeAttrValue,escapeHtml=options.escapeHtml,cssFilter=me.cssFilter;if(options.stripBlankChar&&(html=DEFAULT.stripBlankChar(html)),options.allowCommentTag||(html=DEFAULT.stripCommentTag(html)),options.stripIgnoreTagBody){var stripIgnoreTagBody=DEFAULT.StripTagBody(options.stripIgnoreTagBody,onIgnoreTag);onIgnoreTag=stripIgnoreTagBody.onIgnoreTag}else stripIgnoreTagBody=!1;var retHtml=parseTag(html,function(sourcePosition,position,tag,html,isClosing){var info={sourcePosition:sourcePosition,position:position,isClosing:isClosing,isWhite:tag in whiteList},ret=onTag(tag,html,info);if(!isNull(ret))return ret;if(info.isWhite){if(info.isClosing)return"</"+tag+">";var attrs=getAttrs(html),whiteAttrList=whiteList[tag],attrsHtml=parseAttr(attrs.html,function(name,value){var isWhiteAttr=-1!==_.indexOf(whiteAttrList,name),ret=onTagAttr(tag,name,value,isWhiteAttr);if(!isNull(ret))return ret;if(isWhiteAttr)return value=safeAttrValue(tag,name,value,cssFilter),value?name+'="'+value+'"':name;var ret=onIgnoreTagAttr(tag,name,value,isWhiteAttr);return isNull(ret)?void 0:ret}),html="<"+tag;return attrsHtml&&(html+=" "+attrsHtml),attrs.closing&&(html+=" /"),html+=">"}var ret=onIgnoreTag(tag,html,info);return isNull(ret)?escapeHtml(html):ret},escapeHtml);return stripIgnoreTagBody&&(retHtml=stripIgnoreTagBody.remove(retHtml)),retHtml},module.exports=FilterXSS},{"./default":1,"./parser":3,"./util":4,cssfilter:8}],6:[function(require,module,exports){function isNull(obj){return void 0===obj||null===obj}function FilterCSS(options){options=options||{},options.whiteList=options.whiteList||DEFAULT.whiteList,options.onAttr=options.onAttr||DEFAULT.onAttr,options.onIgnoreAttr=options.onIgnoreAttr||DEFAULT.onIgnoreAttr,this.options=options}var DEFAULT=require("./default"),parseStyle=require("./parser");require("./util");FilterCSS.prototype.process=function(css){if(css=css||"",css=css.toString(),!css)return"";var me=this,options=me.options,whiteList=options.whiteList,onAttr=options.onAttr,onIgnoreAttr=options.onIgnoreAttr,retCSS=parseStyle(css,function(sourcePosition,position,name,value,source){var check=whiteList[name],isWhite=!1;check===!0?isWhite=check:"function"==typeof check?isWhite=check(value):check instanceof RegExp&&(isWhite=check.test(value)),isWhite!==!0&&(isWhite=!1);var opts={position:position,sourcePosition:sourcePosition,source:source,isWhite:isWhite};if(isWhite){var ret=onAttr(name,value,opts);return isNull(ret)?name+":"+value:ret}var ret=onIgnoreAttr(name,value,opts);return isNull(ret)?void 0:ret});return retCSS},module.exports=FilterCSS},{"./default":7,"./parser":9,"./util":10}],7:[function(require,module,exports){function onAttr(name,value,options){}function onIgnoreAttr(name,value,options){}var whiteList={};whiteList["align-content"]=!1,whiteList["align-items"]=!1,whiteList["align-self"]=!1,whiteList["alignment-adjust"]=!1,whiteList["alignment-baseline"]=!1,whiteList.all=!1,whiteList["anchor-point"]=!1,whiteList.animation=!1,whiteList["animation-delay"]=!1,whiteList["animation-direction"]=!1,whiteList["animation-duration"]=!1,whiteList["animation-fill-mode"]=!1,whiteList["animation-iteration-count"]=!1,whiteList["animation-name"]=!1,whiteList["animation-play-state"]=!1,whiteList["animation-timing-function"]=!1,whiteList.azimuth=!1,whiteList["backface-visibility"]=!1,whiteList.background=!0,whiteList["background-attachment"]=!0,whiteList["background-clip"]=!0,whiteList["background-color"]=!0,whiteList["background-image"]=!0,whiteList["background-origin"]=!0,whiteList["background-position"]=!0,whiteList["background-repeat"]=!0,whiteList["background-size"]=!0,whiteList["baseline-shift"]=!1,whiteList.binding=!1,whiteList.bleed=!1,whiteList["bookmark-label"]=!1,whiteList["bookmark-level"]=!1,whiteList["bookmark-state"]=!1,whiteList.border=!0,whiteList["border-bottom"]=!0,whiteList["border-bottom-color"]=!0,whiteList["border-bottom-left-radius"]=!0,whiteList["border-bottom-right-radius"]=!0,whiteList["border-bottom-style"]=!0,whiteList["border-bottom-width"]=!0,whiteList["border-collapse"]=!0,whiteList["border-color"]=!0,whiteList["border-image"]=!0,whiteList["border-image-outset"]=!0,whiteList["border-image-repeat"]=!0,whiteList["border-image-slice"]=!0,whiteList["border-image-source"]=!0,whiteList["border-image-width"]=!0,whiteList["border-left"]=!0,whiteList["border-left-color"]=!0,whiteList["border-left-style"]=!0,whiteList["border-left-width"]=!0,whiteList["border-radius"]=!0,whiteList["border-right"]=!0,whiteList["border-right-color"]=!0,whiteList["border-right-style"]=!0,whiteList["border-right-width"]=!0,whiteList["border-spacing"]=!0,whiteList["border-style"]=!0,whiteList["border-top"]=!0,whiteList["border-top-color"]=!0,whiteList["border-top-left-radius"]=!0,whiteList["border-top-right-radius"]=!0,whiteList["border-top-style"]=!0,whiteList["border-top-width"]=!0,whiteList["border-width"]=!0,whiteList.bottom=!1,whiteList["box-decoration-break"]=!0,whiteList["box-shadow"]=!0,whiteList["box-sizing"]=!0,whiteList["box-snap"]=!0,whiteList["box-suppress"]=!0,whiteList["break-after"]=!0,whiteList["break-before"]=!0,whiteList["break-inside"]=!0,whiteList["caption-side"]=!1,whiteList.chains=!1,whiteList.clear=!0,whiteList.clip=!1,whiteList["clip-path"]=!1,whiteList["clip-rule"]=!1,whiteList.color=!0,whiteList["color-interpolation-filters"]=!0,
whiteList["column-count"]=!1,whiteList["column-fill"]=!1,whiteList["column-gap"]=!1,whiteList["column-rule"]=!1,whiteList["column-rule-color"]=!1,whiteList["column-rule-style"]=!1,whiteList["column-rule-width"]=!1,whiteList["column-span"]=!1,whiteList["column-width"]=!1,whiteList.columns=!1,whiteList.contain=!1,whiteList.content=!1,whiteList["counter-increment"]=!1,whiteList["counter-reset"]=!1,whiteList["counter-set"]=!1,whiteList.crop=!1,whiteList.cue=!1,whiteList["cue-after"]=!1,whiteList["cue-before"]=!1,whiteList.cursor=!1,whiteList.direction=!1,whiteList.display=!0,whiteList["display-inside"]=!0,whiteList["display-list"]=!0,whiteList["display-outside"]=!0,whiteList["dominant-baseline"]=!1,whiteList.elevation=!1,whiteList["empty-cells"]=!1,whiteList.filter=!1,whiteList.flex=!1,whiteList["flex-basis"]=!1,whiteList["flex-direction"]=!1,whiteList["flex-flow"]=!1,whiteList["flex-grow"]=!1,whiteList["flex-shrink"]=!1,whiteList["flex-wrap"]=!1,whiteList["float"]=!1,whiteList["float-offset"]=!1,whiteList["flood-color"]=!1,whiteList["flood-opacity"]=!1,whiteList["flow-from"]=!1,whiteList["flow-into"]=!1,whiteList.font=!0,whiteList["font-family"]=!0,whiteList["font-feature-settings"]=!0,whiteList["font-kerning"]=!0,whiteList["font-language-override"]=!0,whiteList["font-size"]=!0,whiteList["font-size-adjust"]=!0,whiteList["font-stretch"]=!0,whiteList["font-style"]=!0,whiteList["font-synthesis"]=!0,whiteList["font-variant"]=!0,whiteList["font-variant-alternates"]=!0,whiteList["font-variant-caps"]=!0,whiteList["font-variant-east-asian"]=!0,whiteList["font-variant-ligatures"]=!0,whiteList["font-variant-numeric"]=!0,whiteList["font-variant-position"]=!0,whiteList["font-weight"]=!0,whiteList.grid=!1,whiteList["grid-area"]=!1,whiteList["grid-auto-columns"]=!1,whiteList["grid-auto-flow"]=!1,whiteList["grid-auto-rows"]=!1,whiteList["grid-column"]=!1,whiteList["grid-column-end"]=!1,whiteList["grid-column-start"]=!1,whiteList["grid-row"]=!1,whiteList["grid-row-end"]=!1,whiteList["grid-row-start"]=!1,whiteList["grid-template"]=!1,whiteList["grid-template-areas"]=!1,whiteList["grid-template-columns"]=!1,whiteList["grid-template-rows"]=!1,whiteList["hanging-punctuation"]=!1,whiteList.height=!0,whiteList.hyphens=!1,whiteList.icon=!1,whiteList["image-orientation"]=!1,whiteList["image-resolution"]=!1,whiteList["ime-mode"]=!1,whiteList["initial-letters"]=!1,whiteList["inline-box-align"]=!1,whiteList["justify-content"]=!1,whiteList["justify-items"]=!1,whiteList["justify-self"]=!1,whiteList.left=!1,whiteList["letter-spacing"]=!0,whiteList["lighting-color"]=!0,whiteList["line-box-contain"]=!1,whiteList["line-break"]=!1,whiteList["line-grid"]=!1,whiteList["line-height"]=!1,whiteList["line-snap"]=!1,whiteList["line-stacking"]=!1,whiteList["line-stacking-ruby"]=!1,whiteList["line-stacking-shift"]=!1,whiteList["line-stacking-strategy"]=!1,whiteList["list-style"]=!0,whiteList["list-style-image"]=!0,whiteList["list-style-position"]=!0,whiteList["list-style-type"]=!0,whiteList.margin=!0,whiteList["margin-bottom"]=!0,whiteList["margin-left"]=!0,whiteList["margin-right"]=!0,whiteList["margin-top"]=!0,whiteList["marker-offset"]=!1,whiteList["marker-side"]=!1,whiteList.marks=!1,whiteList.mask=!1,whiteList["mask-box"]=!1,whiteList["mask-box-outset"]=!1,whiteList["mask-box-repeat"]=!1,whiteList["mask-box-slice"]=!1,whiteList["mask-box-source"]=!1,whiteList["mask-box-width"]=!1,whiteList["mask-clip"]=!1,whiteList["mask-image"]=!1,whiteList["mask-origin"]=!1,whiteList["mask-position"]=!1,whiteList["mask-repeat"]=!1,whiteList["mask-size"]=!1,whiteList["mask-source-type"]=!1,whiteList["mask-type"]=!1,whiteList["max-height"]=!0,whiteList["max-lines"]=!1,whiteList["max-width"]=!0,whiteList["min-height"]=!0,whiteList["min-width"]=!0,whiteList["move-to"]=!1,whiteList["nav-down"]=!1,whiteList["nav-index"]=!1,whiteList["nav-left"]=!1,whiteList["nav-right"]=!1,whiteList["nav-up"]=!1,whiteList["object-fit"]=!1,whiteList["object-position"]=!1,whiteList.opacity=!1,whiteList.order=!1,whiteList.orphans=!1,whiteList.outline=!1,whiteList["outline-color"]=!1,whiteList["outline-offset"]=!1,whiteList["outline-style"]=!1,whiteList["outline-width"]=!1,whiteList.overflow=!1,whiteList["overflow-wrap"]=!1,whiteList["overflow-x"]=!1,whiteList["overflow-y"]=!1,whiteList.padding=!0,whiteList["padding-bottom"]=!0,whiteList["padding-left"]=!0,whiteList["padding-right"]=!0,whiteList["padding-top"]=!0,whiteList.page=!1,whiteList["page-break-after"]=!1,whiteList["page-break-before"]=!1,whiteList["page-break-inside"]=!1,whiteList["page-policy"]=!1,whiteList.pause=!1,whiteList["pause-after"]=!1,whiteList["pause-before"]=!1,whiteList.perspective=!1,whiteList["perspective-origin"]=!1,whiteList.pitch=!1,whiteList["pitch-range"]=!1,whiteList["play-during"]=!1,whiteList.position=!1,whiteList["presentation-level"]=!1,whiteList.quotes=!1,whiteList["region-fragment"]=!1,whiteList.resize=!1,whiteList.rest=!1,whiteList["rest-after"]=!1,whiteList["rest-before"]=!1,whiteList.richness=!1,whiteList.right=!1,whiteList.rotation=!1,whiteList["rotation-point"]=!1,whiteList["ruby-align"]=!1,whiteList["ruby-merge"]=!1,whiteList["ruby-position"]=!1,whiteList["shape-image-threshold"]=!1,whiteList["shape-outside"]=!1,whiteList["shape-margin"]=!1,whiteList.size=!1,whiteList.speak=!1,whiteList["speak-as"]=!1,whiteList["speak-header"]=!1,whiteList["speak-numeral"]=!1,whiteList["speak-punctuation"]=!1,whiteList["speech-rate"]=!1,whiteList.stress=!1,whiteList["string-set"]=!1,whiteList["tab-size"]=!1,whiteList["table-layout"]=!1,whiteList["text-align"]=!0,whiteList["text-align-last"]=!0,whiteList["text-combine-upright"]=!0,whiteList["text-decoration"]=!0,whiteList["text-decoration-color"]=!0,whiteList["text-decoration-line"]=!0,whiteList["text-decoration-skip"]=!0,whiteList["text-decoration-style"]=!0,whiteList["text-emphasis"]=!0,whiteList["text-emphasis-color"]=!0,whiteList["text-emphasis-position"]=!0,whiteList["text-emphasis-style"]=!0,whiteList["text-height"]=!0,whiteList["text-indent"]=!0,whiteList["text-justify"]=!0,whiteList["text-orientation"]=!0,whiteList["text-overflow"]=!0,whiteList["text-shadow"]=!0,whiteList["text-space-collapse"]=!0,whiteList["text-transform"]=!0,whiteList["text-underline-position"]=!0,whiteList["text-wrap"]=!0,whiteList.top=!1,whiteList.transform=!1,whiteList["transform-origin"]=!1,whiteList["transform-style"]=!1,whiteList.transition=!1,whiteList["transition-delay"]=!1,whiteList["transition-duration"]=!1,whiteList["transition-property"]=!1,whiteList["transition-timing-function"]=!1,whiteList["unicode-bidi"]=!1,whiteList["vertical-align"]=!1,whiteList.visibility=!1,whiteList["voice-balance"]=!1,whiteList["voice-duration"]=!1,whiteList["voice-family"]=!1,whiteList["voice-pitch"]=!1,whiteList["voice-range"]=!1,whiteList["voice-rate"]=!1,whiteList["voice-stress"]=!1,whiteList["voice-volume"]=!1,whiteList.volume=!1,whiteList["white-space"]=!1,whiteList.widows=!1,whiteList.width=!0,whiteList["will-change"]=!1,whiteList["word-break"]=!0,whiteList["word-spacing"]=!0,whiteList["word-wrap"]=!0,whiteList["wrap-flow"]=!1,whiteList["wrap-through"]=!1,whiteList["writing-mode"]=!1,whiteList["z-index"]=!1,exports.whiteList=whiteList,exports.onAttr=onAttr,exports.onIgnoreAttr=onIgnoreAttr},{}],8:[function(require,module,exports){function filterCSS(html,options){var xss=new FilterCSS(options);return xss.process(html)}var DEFAULT=require("./default"),FilterCSS=require("./css");exports=module.exports=filterCSS,exports.FilterCSS=FilterCSS;for(var i in DEFAULT)exports[i]=DEFAULT[i];"function"==typeof define&&define.amd&&define("component/xss/dist/xss",[],function(){return module.exports}),"undefined"!=typeof window&&(window.filterCSS=module.exports)},{"./css":6,"./default":7}],9:[function(require,module,exports){function parseStyle(css,onAttr){function addNewAttr(){if(!isParenthesisOpen){var source=_.trim(css.slice(lastPos,i)),j=source.indexOf(":");if(-1!==j){var name=_.trim(source.slice(0,j)),value=_.trim(source.slice(j+1));if(name){var ret=onAttr(lastPos,retCSS.length,name,value,source);ret&&(retCSS+=ret+"; ")}}}lastPos=i+1}css=_.trimRight(css),";"!==css[css.length-1]&&(css+=";");for(var cssLength=css.length,isParenthesisOpen=!1,lastPos=0,i=0,retCSS="";cssLength>i;i++){var c=css[i];if("/"===c&&"*"===css[i+1]){var j=css.indexOf("*/",i+2);if(-1===j)break;i=j+1,lastPos=i+1,isParenthesisOpen=!1}else"("===c?isParenthesisOpen=!0:")"===c?isParenthesisOpen=!1:";"===c?isParenthesisOpen||addNewAttr():"\n"===c&&addNewAttr()}return _.trim(retCSS)}var _=require("./util");module.exports=parseStyle},{"./util":10}],10:[function(require,module,exports){module.exports={indexOf:function(arr,item){var i,j;if(Array.prototype.indexOf)return arr.indexOf(item);for(i=0,j=arr.length;j>i;i++)if(arr[i]===item)return i;return-1},forEach:function(arr,fn,scope){var i,j;if(Array.prototype.forEach)return arr.forEach(fn,scope);for(i=0,j=arr.length;j>i;i++)fn.call(scope,arr[i],i,arr)},trim:function(str){return String.prototype.trim?str.trim():str.replace(/(^\s*)|(\s*$)/g,"")},trimRight:function(str){return String.prototype.trimRight?str.trimRight():str.replace(/(\s*$)/g,"")}}},{}]},{},[2]),define("home/auth/bind",function(require,exports,module){require("common/extend/validator/validator"),Class({authBindEle:$("#authBind"),loginFormEle:$("#loginForm"),registerFormEle:$("#registerForm"),registerAgreementEle:$("#registerAgreement"),bindTabEle:$("#bindTab"),initial:function(){var self=this;this.bindTabEle.find(".tab-navg .navg-item").click(function(){var _item=self.bindTabEle.find(".tab-item").eq($(this).index());$(this).addClass("active").siblings().removeClass("active"),_item.addClass("active").siblings().removeClass("active"),_item.find("form").clearValidate(),_item.find("input:first").focus(),$(this).index()?self.authBindEle.removeClass("auth-bind-login").addClass("auth-bind-register"):self.authBindEle.removeClass("auth-bind-register").addClass("auth-bind-login")}).eq(0).click(),this.loginVerifyImageEle=this.loginFormEle.find(".verity-code .code-image"),this.loginVerifyTextEle=this.loginFormEle.find(".verity-code .code-input :text"),this.loginFormEle.submitForm({autoValidate:!1,onAfter:function(data){data.status?($.dialog.success(data.info),self.synchroLogin(data.code,function(){location.replace(data.url)})):("string"==typeof data.info&&$.dialog.error(data.info),self.loginVerifyImageEle.click(),self.loginVerifyTextEle.val(""))}}),this.registerVerifyImageEle=this.registerFormEle.find(".verity-code .code-image"),this.registerVerifyTextEle=this.registerFormEle.find(".verity-code .code-input :text"),this.registerFormEle.submitForm({autoValidate:!1,onAfter:function(data){data.status?$.dialog.success(data.info,function(){data.url&&(location.href=data.url)}):("string"==typeof data.info&&$.dialog.error(data.info),self.registerVerifyImageEle.click(),self.registerVerifyTextEle.val(""))}})},synchroLogin:function(urls,callback){var _urls=$.isArray(urls)?urls:[urls],_funs=[],_mask=0;$.each(_urls,function(_index,_value){"string"==typeof _value&&_funs.push(function(){$.ajax({url:_value,dataType:"jsonp",complete:function(){++_mask,_mask<_funs.length?_funs[_mask]():$.isFunction(callback)&&callback()}})})}),_funs.length?_funs[_mask]&&_funs[_mask]():$.isFunction(callback)&&callback()}})}),define("home/auth/complete",function(require,exports,module){Class({completeFormEle:$("#completeForm"),initial:function(){this.completeFormEle.submitForm({onAfter:function(data){data.status?data.url?location.replace(data.url):location.reload():"string"==typeof data.info&&$.dialog.error(data.info)}})}})}),define("home/auth/forgot",function(require,exports,module){require("common/extend/validator/validator"),Class({forgotFormEle:$("#forgotForm"),initial:function(){var self=this;this.verifyImageEle=this.forgotFormEle.find(".verity-code .code-image"),this.verifyTextEle=this.forgotFormEle.find(".verity-code .code-input :text"),this.forgotFormEle.submitForm({autoValidate:!1,onAfter:function(data){data.status?$.dialog.success(data.info,{time:3e3,onClose:function(){location.replace(data.url)}}):("string"==typeof data.info&&$.dialog.error(data.info),self.verifyImageEle.click(),self.verifyTextEle.val(""))}}),this.forgotFormEle.find("input:first").focus()}})}),define("home/auth/login",function(require,exports,module){require("common/extend/validator/validator"),Class({loginFormEle:$("#loginForm"),keepLoginEle:$(':checkbox[name="is_auto"]'),cooperateEle:$(".auth-cooperate .cooperate-list a"),initial:function(){var self=this;this.verifyImageEle=this.loginFormEle.find(".verity-code .code-image"),this.verifyTextEle=this.loginFormEle.find(".verity-code .code-input :text"),this.loginFormEle.submitForm({autoValidate:!1,onAfter:function(data){data.status?($.dialog.success(data.info),self.synchroLogin(data.code,function(){location.replace(data.url)})):("string"==typeof data.info&&$.dialog.error(data.info),self.verifyImageEle.click(),self.verifyTextEle.val(""))}}),this.loginFormEle.find("input:first").focus(),this.loginFormEle.delegate(".field-msg a","click",function(){var _ele=$(this),_text=_ele.text(),_input=_ele.closest(".form-item").find(":text");_ele.hasClass("loading")||(_ele.addClass("loading"),_ele.text("邮件发送中..."),_input.click(),$.dialog.loading("正在发送帐号激活邮件"),$.get(_ele.data("href"),function(data){data.status?$.dialog.success(data.info,{time:3e3}):$.dialog.error(data.info),$.dialog.get("loading").close(),_ele.removeClass("loading"),_ele.text(_text)}))}),$.each(this.cooperateEle,function(){$(this).data("href")||$(this).data("href",$(this).attr("href"))}),this.keepLoginEle.click(function(){self.findKeepLogin($(this).is(":checked"))}),this.findKeepLogin(this.keepLoginEle.is(":checked"))},synchroLogin:function(urls,callback){var _urls=$.isArray(urls)?urls:[urls],_funs=[],_mask=0;$.each(_urls,function(_index,_value){"string"==typeof _value&&_funs.push(function(){$.ajax({url:_value,dataType:"jsonp",complete:function(){++_mask,_mask<_funs.length?_funs[_mask]():$.isFunction(callback)&&callback()}})})}),_funs.length?_funs[_mask]&&_funs[_mask]():$.isFunction(callback)&&callback()},findKeepLogin:function(status){var _value=this.keepLoginEle.val();$.each(this.cooperateEle,function(){var _href=$(this).data("href");status?$(this).attr("href",_href+(_href.indexOf("?")>=0?"&":"?")+"is_auto="+_value):$(this).attr("href",_href)})}})}),define("home/auth/register",function(require,exports,module){require("common/extend/validator/validator"),Class({registerFormEle:$("#registerForm"),initial:function(){var self=this;this.verifyImageEle=this.registerFormEle.find(".verity-code .code-image"),this.verifyTextEle=this.registerFormEle.find(".verity-code .code-input :text"),this.registerFormEle.submitForm({autoValidate:!1,onAfter:function(data){data.status?$.dialog.success(data.info,function(){data.url&&(location.href=data.url)}):("string"==typeof data.info&&$.dialog.error(data.info),self.verifyImageEle.click(),self.verifyTextEle.val(""))}}),this.registerFormEle.find("input:first").focus()}})}),define("home/auth/reset",function(require,exports,module){require("common/extend/validator/validator"),Class({resetFormEle:$("#resetForm"),initial:function(){var self=this;this.verifyImageEle=this.resetFormEle.find(".verity-code .code-image"),this.verifyTextEle=this.resetFormEle.find(".verity-code .code-input :text"),this.resetFormEle.submitForm({autoValidate:!1,onAfter:function(data){data.status?$.dialog.success(data.info,function(){location.replace(data.url)}):("string"==typeof data.info&&$.dialog.error(data.info),self.verifyImageEle.click(),self.verifyTextEle.val(""))}}),this.resetFormEle.find("input:first").focus()}})}),define("home/book/create/api",function(require,exports,module){require("common/extend/validator/validator"),require("component/jquery.form"),require("component/select2/dist/css/select2.css"),require("component/select2/dist/js/select2.full.min");var Template=require("common/extend/template"),headerTpl='<div class="api-header"><div class="w-group"><div class="w-text"><input name="config[headers][<%=index%>][key]" class="text-input" placeholder="Key"></div><div class="w-group-addon w-group-addon-middle">:&nbsp;&nbsp;</div><div class="w-text"><input name="config[headers][<%=index%>][value]" class="text-input" placeholder="Value"></div></div><a href="javascript:;"><i class="icon icon-trash-o"></i></a></div>';return{init:function(){var manualCreateFormEle=$("#manualCreateForm"),namespaceEle=$("#namespace"),addHeaderEle=$("#addHeader"),apiHeadersEle=$("#apiHeaders"),namespaceSelectEle=$("#namespaceSelect");Config.get("namespace")&&(namespaceSelectEle.val(Config.get("namespace")),namespaceEle.text(Config.get("namespace"))),namespaceSelectEle.select2({minimumResultsForSearch:1/0,templateResult:function(state){return state.id?$('<div style="line-height: 20px;white-space:nowrap;overflow: hidden;text-overflow: ellipsis;"><img style="border-radius: 3px;" src="'+$(state.element).data("logo")+'" width="20" height="20" /> '+state.text+"</div>"):state.text},templateSelection:function(state){return state.id?$('<div style="line-height: 30px;"><img style="vertical-align: middle;border-radius: 3px;" src="'+$(state.element).data("logo")+'" width="20" height="20" /> '+state.text+"</div>"):state.text}}).on("select2:select",function(e){namespaceEle.text(e.params.data.id)});var header_index=0;addHeaderEle.on("click",function(){apiHeadersEle.append(Template.parseTemp(headerTpl,{index:header_index})),header_index++}),apiHeadersEle.on("click",".api-header>a",function(){$(this).parent().remove()}),manualCreateFormEle.submitForm({autoValidate:!1,onAfter:function(data,options){data.status?data.url&&location.replace(data.url):"string"==typeof data.info&&$.dialog.error(data.info)}})}}}),define("home/book/create/default",function(require,exports,module){require("common/extend/validator/validator"),require("component/jquery.form"),require("component/webuploader/css/webuploader.css"),require("component/webuploader/dist/webuploader"),require("component/select2/dist/css/select2.css"),require("component/select2/dist/js/select2.full.min");var createUploader=function(type){var _selectUploadChmElement=$("#selectUpload"+type),_pickerElement=$("#picker"+type),_listElement=$("#upload"+type+"List"),_hiddenInputElement=$("#upload"+type+"Hidden"),uploader=null;_selectUploadChmElement.click(function(){$(this).is(":checked")&&!uploader&&(uploader=WebUploader.create({runtimeOrder:!1,auto:!0,width:86,height:34,server:Config.get("uploadImportSourceUrl"),fileNumLimit:1,pick:"#picker"+type,accept:{title:type,extensions:type.toLowerCase(),mimeTypes:"*"},formData:{ajax:1,import_type:type.toLowerCase()}}),uploader.on("uploadSuccess",function(file,data){data.status?(_hiddenInputElement.val(data.data.source),$("#"+file.id).find(".state").text("上传成功！"),$.dialog.success(data.info)):$.dialog.error(data.info)}),uploader.on("fileQueued",function(file){_listElement.append('<div id="'+file.id+'" class="upload-item"><h4 class="info">'+file.name+'</h4><p class="state">等待上传...</p><b class="delete" title="删除">x</b>',"</div>"),_pickerElement.hide()}),_listElement.on("click",".delete",function(){uploader.stop(!0),uploader.reset(),_hiddenInputElement.val(""),$(this).closest(".upload-item").remove(),_pickerElement.show()}),uploader.on("uploadProgress",function(file,percentage){var $li=$("#"+file.id),$percent=$li.find(".progress .progress-bar");$percent.length||($percent=$('<div class="progress progress-striped active"><div class="progress-bar" role="progressbar" style="width: 0%"></div></div>').appendTo($li).find(".progress-bar")),$li.find("p.state").text("上传中"),$percent.css("width",100*percentage+"%")}))}),_selectUploadChmElement.click(function(){!$(this).is(":checked")&&uploader&&(uploader.stop(!0),uploader.reset(),_hiddenInputElement.val(""),_listElement.find(".upload-item").remove(),_pickerElement.show())})};return{init:function(){var manualCreateFormEle=$("#manualCreateForm"),importDocumentEle=$("#importDocument"),namespaceSelectEle=$("#namespaceSelect"),namespaceEle=$("#namespace");Config.get("namespace")&&(namespaceSelectEle.val(Config.get("namespace")),namespaceEle.text(Config.get("namespace"))),namespaceSelectEle.select2({minimumResultsForSearch:1/0,templateResult:function(state){return state.id?$('<div style="line-height: 20px;white-space:nowrap;overflow: hidden;text-overflow: ellipsis;"><img style="border-radius: 3px;" src="'+$(state.element).data("logo")+'" width="20" height="20" /> '+state.text+"</div>"):state.text},templateSelection:function(state){return state.id?$('<div style="line-height: 30px;"><img style="vertical-align: middle;border-radius: 3px;" src="'+$(state.element).data("logo")+'" width="20" height="20" /> '+state.text+"</div>"):state.text}}).on("select2:select",function(e){namespaceEle.text(e.params.data.id)}),importDocumentEle.each(function(){var _documentType=$(this).find(".document-type :checkbox"),_documentSelect=$(this).find(".document-select"),_documentItem=_documentSelect.find(".item"),_isImport=$(this).find(":hidden[name=is_import]");_documentType.click(function(){_documentType.not($(this)).prop("checked",!1),_isImport.prop("disabled",!0),_documentItem.hide().find("input").prop("disabled",!0),_documentType.filter(":checked").length?(_documentSelect.show(),_documentItem.eq($(this).closest(".w-btn").index()).show().find("input").prop("disabled",!1),_isImport.prop("disabled",!1)):_documentSelect.hide()})}),createUploader("Epub"),createUploader("Chm"),manualCreateFormEle.submitForm({autoValidate:!1,uploadFile:!0,onAfter:function(data,options){data.status?data.url&&location.replace(data.url):"string"==typeof data.info&&$.dialog.error(data.info)}})}}}),define("home/book/create/index",function(require,exports,module){return require("component/dialog/jquery.dialog"),Class({initial:function(){$(".book-creator").click(function(){var dialog=$.dialog.load("/book/create",{title:"请选择你要创建的文档类型",style:"think-dialog think-dialog-load",width:790,onComplete:function(){this.bodyElement.find("[data-type]").click(function(){var type=$(this).data("type");dialog.destroy(),dialog=$.dialog.open("/book/create/"+type,{title:"创建文档",style:"think-dialog think-dialog-load",onComplete:function(){this.bodyElement.find("form").data("submitButton",this.okBtn)},onOk:function(){this.bodyElement.find("form").submit()}})})}})})}})}),define("home/book/dashboard",function(require,exports,module){var Order=require("common/module/order");return Class({manualReleaseEle:$("#manualRelease"),manualRetryEle:$("#manualRetry"),manualDeleteEle:$("#manualDelete"),showDiffEle:$("#showDiff"),checkImportComplete:function(){var _self=this;$.ajax({url:Config.get("checkManualStatusUrl"),type:"get",data:{book_id:Config.get("manualId")},success:function(data){1==data.status?window.location.reload():2==data.status?setTimeout(function(){_self.checkImportComplete.apply(_self)},6e3):$.dialog.error("文档导入失败，请删除或者重试",{time:3e3,onClose:function(){window.location.reload()}})}})},initial:function(){switch(Config.get("manualStatus")){case 2:this.checkImportComplete();break;case 3:this.manualDeleteEle.click(function(){var _ele=$(this),_id=$(this).data("id");return $.dialog.confirm("确定删除吗",function(action){1==action&&$.ajax({url:_ele.data("href"),data:{book_id:_id},type:"post",success:function(data){data.status?location.href=data.url:$.dialog.error(data.info)}})}),!1}),this.manualRetryEle.click(function(){var _ele=$(this),_id=$(this).data("id");return $.ajax({url:_ele.data("href"),data:{book_id:_id},type:"post",success:function(data){data.status?location.reload():$.dialog.error(data.info)}}),!1});break;default:this.showDiffEle.click(function(){var _html='<div class="dialog-history" style="padding-left: 0"><div class="history-commit-details"></div></div>';_html=$(_html);$.dialog(_html,{button:[function(){var _self=this,cancelBtn=$('<label class="w-btn btn-default btn-m"><button class="btn-input">关闭</button></label>');return cancelBtn.click(function(){_self.close()}),cancelBtn}],style:"think-dialog-form",drag:!1,close:!1,onCreate:function(){var _detail=$(".history-commit-details",_html);$.dialog.loading("获取差异信息中..."),$.ajax({url:Config.get("showDiffUrl"),data:{book_id:Config.get("manualId")},context:this,type:"get",success:function(data){$.dialog.get("loading").close(),_detail.html(data)},complete:function(){$.dialog.get("loading").close()}})}})}),this.manualReleaseEle.click(function(){var _ele=$(this);$.dialog.confirm("确定发布吗？",function(action){1==action&&(_ele.hasClass("loading")||($.dialog.loading("发布中..."),$.post(_ele.data("href"),{book_id:Config.get("manualId")},function(data){$.dialog.get("loading").close(),data.status?location.reload():$.dialog.error(data.info),_ele.removeClass("loading")})),_ele.addClass("loading"))})})}""==Config.get("token")?$("#label_token_del").hide():$("#label_token_del").removeAttr("style"),$("#token_set").click(function(){var _ele=$(this),_id=$(this).data("id"),_tips=$(this).data("tips");return $.dialog.confirm(_tips,function(action){1==action&&$.ajax({url:_ele.data("href"),data:{book_id:_id},type:"post",success:function(data){data.status?($("#token_text").val(data.tokenUrl),$("#token_set").text("重新生成"),$("#label_token_del").show(),$("#label_token_del").removeAttr("style")):$.dialog.error(data.info)}})}),!1}),$("#token_del").click(function(){var _ele=$(this),_id=$(this).data("id"),_tips=$(this).data("tips");return $.dialog.confirm(_tips,function(action){1==action&&$.ajax({url:_ele.data("href"),data:{book_id:_id},type:"post",success:function(data){data.status?($("#token_text").val(""),$("#token_set").text("生成"),$("#label_token_del").hide(),$("#label_token_del").attr("style","visibility: hidden;")):$.dialog.error(data.info)}})}),!1}),$("#git_text,#token_text").click(function(){$(this).focus().select()}),$(".size-upgrade").click(function(){new Order({title:"欢迎购买文档空间",type:"BookSizeProduct",infoTpl:['<div class="form-item">','<span class="form-label">购买大小：</span>','<div class="form-target">','<a class="btn-default w-btn minus"><span class="btn-input "> - </span></a>&nbsp;','<label class="w-text" style="width: 82px;">','<input type="text" name="size" style="width: 60px;" class="text-input" data-num="1" value="50 M" readonly="readonly" />',"</label>",'&nbsp;<a class="btn-default w-btn plus"><span class="btn-input">+</span></a>',"</div>","</div>"].join(""),coupon:!0,coin:Config.get("userCoin"),price:function(){return parseInt(1e3*this.wrapEle.find("[name=size]").data("num"))},data:function(){return{num:parseInt(this.wrapEle.find("[name=size]").data("num")),book_id:Config.get("manualId")}},onInit:function(){var self=this;this.wrapEle.find(".minus").click(function(){var num=self.wrapEle.find("[name=size]").data("num");num>1&&(num--,self.wrapEle.find("[name=size]").data("num",num),self.wrapEle.find("[name=size]").val(50*num+" M"),self.freshPrice())}),this.wrapEle.find(".plus").click(function(){var num=self.wrapEle.find("[name=size]").data("num");num++,self.wrapEle.find("[name=size]").data("num",num),self.wrapEle.find("[name=size]").val(50*num+" M"),self.freshPrice()})},onSuccess:function(){location.reload()}})})}})}),define("home/book/domain/update",function(require,exports,module){return require("common/extend/validator/validator"),require("component/jquery.form"),Class({manualUpdateFormEle:$("#manualUpdateForm"),initial:function(){var self=this;this.verifyImageEle=this.manualUpdateFormEle.find(".verity-code .code-image"),this.verifyTextEle=this.manualUpdateFormEle.find(".verity-code .code-input :text"),this.manualUpdateFormEle.submitForm({autoValidate:!1,onAfter:function(data){data.status?$.dialog.success(data.info,function(){location.reload()}):($.dialog.error(data.info),self.verifyImageEle.click(),self.verifyTextEle.val(""))}})}})}),define("home/book/editor/article",function(require){var loadContentAjax,saveContentAjax,currentArticleHash,events=require("./events"),state=require("./state"),editor=require("./editor"),load=function(id,callback){$.dialog.loading("数据加载中!"),loadContentAjax&&loadContentAjax.abort(),loadContentAjax=$.ajax({url:"/book/article/content",type:"post",data:{id:id,book_id:state.id},success:function(data){data.status?callback(data.data):$.dialog.error(data.info)},complete:function(){$.dialog.get("loading").close()}})},open=function(node){load(node.id,function(data){state.articleId=node.id,state.articleTitle=node.text,currentArticleHash=data.hash;var mode,type=node.ext||node.original.ext,$editor=editor.getEditor();switch(type){case"md":mode="markdown";break;case"json":mode="json";break;case"css":mode="css";break;case"htm":case"xhtml":case"html":mode="html";break;default:mode="text"}$editor.setMode(mode),$editor.setValue(data.content),$editor.reset(),$editor.$ace.renderer.scrollToLine(0),events.trigger("article.open",{content:data.content,node:node})})},save=function(force){saveContentAjax||(saveContentAjax=!0,$.dialog.loading("文章保存中..."),$.ajax({url:"/book/article/update",type:"post",data:{id:state.articleId,title:state.articleTitle,content:editor.getEditor().getValue(),book_id:state.id,hash:currentArticleHash,force:force?1:0},success:function(data){1===data.status?(editor.getEditor().reset(),currentArticleHash=data.hash,events.trigger("article.save")):2===data.status?$.dialog.confirm("本文件在你打开之后已经被其他人修改过了，直接覆盖吗？",function(action){1==action&&save(!0)}):$.dialog.error(data.info)},complete:function(){saveContentAjax=!1,$.dialog.get("loading").close()}}))};return{init:function(){events.on("catalog.select",function(event,node){open(node)}),events.on("editor.save",function(){save(!1)}),events.on("editor.reset",function(event,hash){$.dialog.loading("文件恢复中..."),$.ajax({url:"/book/article/reset",data:{book_id:state.id,path:state.articleId,title:state.articleTitle,hash:hash},type:"post",success:function(data){1==data.status?load(state.articleId,function(data){var $editor=editor.getEditor();currentArticleHash=data.hash,$editor.setValue(data.content),$editor.reset()}):($.dialog.get("loading").close(),$.dialog.error(data.info))}})})}}}),define("home/book/editor/backup",function(require){var lastContent,lastId,cacheTiper,events=require("./events"),editor=require("./editor"),state=require("./state"),saveId=function(id){window.localStorage&&localStorage.setItem("kancloud-manual-"+state.id+"-id",id)},saveContent=function(content){window.localStorage&&(null===content?localStorage.removeItem("kancloud-manual-"+state.id+"-content"):localStorage.setItem("kancloud-manual-"+state.id+"-content",content))},getContent=function(){return window.localStorage?localStorage.getItem("kancloud-manual-"+state.id+"-content"):void 0},getId=function(){return window.localStorage?localStorage.getItem("kancloud-manual-"+state.id+"-id"):void 0},removeCacheTiper=function(){cacheTiper&&(cacheTiper.remove(),cacheTiper=null)};return{init:function(){var $editor=editor.getEditor();lastContent=getContent(),lastId=getId(),lastId&&(state.articleId=lastId),events.on("editor.change",function(){setTimeout(function(){saveContent($editor.isChanged()?$editor.getValue():null)},0)}),events.on("catalog.not_found",function(){saveContent(null),lastContent=null}),events.on("article.open",function(event,data){lastContent&&(lastContent!=data.content&&($editor.setValue(lastContent),cacheTiper=$(['<div class="manual-cache-tiper">','<div class="tiper-content">这是你上次未保存的数据，<a class="revoke">[撤销]</a></div>',"</div>"].join("")),cacheTiper.appendTo(state.$book.find(".manual-editor")).find(".revoke").click(function(){$editor.setValue(data.content)}),events.one("article.save editor.change",function(){removeCacheTiper()})),lastContent=null),saveId(data.node.id)}),events.on("catalog.update",function(){saveId(state.articleId)})}}}),define("home/book/editor/catalog",function(require){require("component/jstree/dist/jstree.js"),require("component/jstree/dist/themes/default/style.min.css");var treeCatalog,catalogHash,state=require("./state"),events=require("./events"),editor=require("./editor"),catalogElement=state.$book.find(".manual-left .manual-tab .tab-wrap .catalog-list"),addCatalogBtnElement=state.$book.find(".manual-left .manual-tab .tab-util .setting-edit"),getCatalogEditTemp=function(){
var _catalogEditTemp=$(['<div class="m-manual-add">','<form class="w-form form-horizon dialog-form" method="post">','<div class="form-item">','<span class="form-label"><i class="form-must">*</i>目录标题</span>','<div class="form-target">','<label class="w-text text-m text-full">','<input class="text-input" type="text" name="title" />',"</label>","</div>","</div>",'<div class="form-item">','<span class="form-label"><i class="form-must">*</i>对应文件</span>','<div class="form-target">','<label class="w-text text-m text-full">','<input class="text-input" type="text" name="file" />','<input name="book_id" type="hidden" value="'+state.id+'"/>',"</label>",'<p class="field-msg w-fragment fragment-s fragment-tip">输入路径创建一个新目录和任何必要的子目录<br />例如："test/myfile.md"<br /><strong>文件后缀代表文件类型</strong><br />目前仅支持md(MarkDown),html类型的解析，其他类型原样输出</p>',"</div>","</div>",'<input type="submit" style="display: none;" />',"</form>","</div>"].join(""));return _catalogEditTemp},checkFilenameSafe=function(filename){return!filename.match(/[\\:*\?"<>\|]/g)},setCatalogError=function(msg){catalogElement.hide(),catalogElement.next(".catalog-error").text(msg).show()},openUpdateCatalogDialog=function(node){if(!node)return!1;var dialog=$.dialog.form(getCatalogEditTemp(),{title:"更新目录",onCreate:function(){var _form=this.bodyElement.find("form");_form.attr("action","/book/article/title"),_form.find(":text[name=title]").val(node.text).focus(),_form.find(":text[name=file]").val(decodeURIComponent(node.id)),_form.submitForm({onBefore:function(options){var file=options.data.file.trim().replace(/\/\s+/g,"/");if(!checkFilenameSafe(file))return $.dialog.error('文件名不能包含任何以下字符 \\ : * ? " < > |'),!1;var pathinfo=Util.pathinfo(file),data={id:encodeURIComponent(file),text:options.data.title,name:pathinfo.name,ext:pathinfo.ext};if(""===data.id||""===data.name||""===data.text)return $.dialog.error("目录标题和对应文件均不能为空"),!1;if(data.id!==node.id){var _node=treeCatalog.get_node(data.id);if(_node)return $.dialog.error("文件名称已存在"),!1}return data.id===node.id&&data.text===node.text?(dialog.close(),!1):(options.data.id=node.id,node.original=data,treeCatalog.rename_node(node,data.text),treeCatalog.set_id(node,data.id),options.data.new_id=data.id,options.data.summary=JSON.stringify(treeCatalog.get_json(null,{no_state:!0,no_data:!0})),void(options.data.hash=catalogHash))},onAfter:function(data,options){data.status?(state.articleId==options.data.id&&(state.articleId=options.data.new_id),$.dialog.success(data.info),events.trigger("catalog.update"),catalogHash=data.hash):setCatalogError(data.info),dialog.close()}})}})},openCreateCatalogDialog=function(node){var id=node?node.id:0,dialog=$.dialog.form(getCatalogEditTemp(),{title:"创建目录",onCreate:function(){var _form=this.bodyElement.find("form");_form.attr("action","/book/article/create"),_form.find(":text[name=title]").on("keyup",function(){var filename=$(this).val().trim().replace(/\//g,"-");filename=filename.replace(/[\\:*\?"<>\|]/g,""),_form.find(":text[name=file]").val(filename+".md")}),_form.find(":text[name=title]").focus(),_form.append($('<input type="hidden" name="pid" value="'+id+'">')),_form.submitForm({onBefore:function(options){var file=options.data.file.trim().replace(/\/\s+/g,"/");if(!checkFilenameSafe(file))return $.dialog.error('文件名不能包含任何以下字符 \\ : * ? " < > |'),!1;var pathinfo=Util.pathinfo(file),data={id:encodeURIComponent(file),text:options.data.title,name:pathinfo.name,ext:pathinfo.ext};if(""===data.id||""===data.name||""===data.text)return $.dialog.error("目录标题和对应文件均不能为空"),!1;var node=treeCatalog.get_node(data.id);return node?($.dialog.error("文件名称已存在"),!1):(treeCatalog.create_node(0==id?"#":"#"+id,data,"last"),options.data.id=data.id,options.data.summary=JSON.stringify(treeCatalog.get_json(null,{no_state:!0,no_data:!0})),void(options.data.hash=catalogHash))},onAfter:function(data,options){var node=treeCatalog.get_node(options.data.id);data.status?($.dialog.success(data.info),catalogHash=data.hash,events.trigger("catalog.create"),node&&(editor.getEditor().isChanged()?$.dialog.confirm("编辑区域有尚未保存的内容,确定要离开吗？",function(action){1==action&&(treeCatalog.deselect_all(!0),treeCatalog.select_node(node))}):(treeCatalog.deselect_all(!0),treeCatalog.select_node(node)))):setCatalogError(data.info),dialog.close()}})}})},deleteCatalog=function(node){$.dialog.loading("目录删除中...");var nodes=JSON.stringify(treeCatalog.get_json(node,{no_state:!0,no_data:!0}));if(node){var _targetDom=treeCatalog.get_next_dom(node),_targetNode=null;_targetDom.length||(_targetDom=treeCatalog.get_prev_dom(node)),treeCatalog.delete_node(node),_targetDom.length&&state.articleId==node.id&&(_targetNode=treeCatalog.get_node(_targetDom),treeCatalog.select_node(_targetNode))}var summary=JSON.stringify(treeCatalog.get_json(null,{no_state:!0,no_data:!0}));$.ajax({url:"/book/article/delete",data:{nodes:nodes,book_id:state.id,title:node.text,summary:summary,hash:catalogHash},context:this,type:"post",success:function(data){data.status?(catalogHash=data.hash,events.trigger("catalog.delete")):setCatalogError(data.info)},complete:function(){$.dialog.get("loading").close()}})},saveCatalogSort=function(){var summary=JSON.stringify(treeCatalog.get_json(null,{no_state:!0,no_data:!0}));$.dialog.loading("保存排序中..."),$.ajax({url:"/book/article/sort",data:{summary:summary,book_id:state.id,hash:catalogHash},type:"post",success:function(data){data.status?(catalogHash=data.hash,$.dialog.success(data.info)):setCatalogError(data.info)},complete:function(){$.dialog.get("loading").close()}})},isEmpty=function(){var _status=!1;return treeCatalog&&(_status=!treeCatalog.get_json().length),events.trigger("catalog.empty",_status),_status};return{init:function(config){catalogHash=config.catalogHash,treeCatalog=catalogElement.jstree({core:{check_callback:!0,data:config.catalogData,force_text:!0},plugins:["wholerow","dnd","contextmenu"],dnd:{inside_pos:"last",large_drag_target:!0,large_drop_target:!0,copy:!1},contextmenu:{show_at_node:!1,select_node:!1,items:{create:{separator_before:!1,separator_after:!0,_disabled:!1,label:"新建章节",action:function(data){var inst=$.jstree.reference(data.reference),node=inst.get_node(data.reference);openCreateCatalogDialog(node)},icon:"icon icon-plus2"},edit:{separator_before:!1,separator_after:!0,_disabled:!1,label:"编辑",action:function(data){var inst=$.jstree.reference(data.reference),node=inst.get_node(data.reference);openUpdateCatalogDialog(node)},icon:"icon icon-mode-edit"},remove:{separator_before:!1,separator_after:!0,_disabled:!1,label:"删除",action:function(data){var inst=$.jstree.reference(data.reference),node=inst.get_node(data.reference);$.dialog.confirm("确定删除目录吗？",function(action){1==action&&deleteCatalog(node)})},icon:"icon icon-trash-o"}}}}).jstree(),catalogElement.bind("loaded.jstree",function(){if(addCatalogBtnElement.click(function(){openCreateCatalogDialog(null)}),!isEmpty()){var _mask="#"+(state.articleId||"").toString(),_node=treeCatalog.get_node(_mask),_child=null;_node&&null!==_node.parent||(events.trigger("catalog.not_found"),_child=treeCatalog.get_children_dom("#"),_child[0]&&(_node=treeCatalog.get_node(_child[0]))),_node&&treeCatalog.select_node(_node)}}),catalogElement.bind("redraw.jstree",function(){treeCatalog.get_container_ul().delegate(".jstree-anchor","click",function(event){treeCatalog.trigger("before_select_node.jstree",{event:event,reference:$(this).closest(".jstree-node")})})}),catalogElement.bind("select_node.jstree",function(event,data){events.trigger("catalog.select",data.node)}),catalogElement.bind("before_select_node.jstree",function(event,data){editor.getEditor().isChanged()&&(data.event.stopPropagation(),$.dialog.confirm("编辑区域有尚未保存的内容,确定要离开吗？",function(action){if(1==action){var _node=treeCatalog.get_node(data.reference);_node&&(treeCatalog.deselect_all(!0),treeCatalog.select_node(_node))}}))}),$(document).bind("dnd_stop.vakata",function(event,data){setTimeout(function(){saveCatalogSort()},0)}),events.on("catalog.delete catalog.create",function(){isEmpty()})}}}),define("home/book/editor/editor",function(require){var $editor,events=require("./events"),editor=require("common/module/editor"),state=require("./state"),history=require("./tools/history"),htmlpaste=require("./tools/htmlpaste"),more=require("./tools/more"),save=require("./tools/save"),sidebar=require("./tools/sidebar"),toc=require("./tools/toc"),previewAll=require("./tools/previewAll"),extensions=[];return{init:function(){var _editorHtml=$(['<div class="manual-editor">',"<textarea></textarea>","</div>",'<div class="manual-editor-status"><div class="filename"></div><div class="pull-right"></div></div>'].join("")),_textarea=_editorHtml.find("textarea");state.$book.find(".manual-body .manual-right").append(_editorHtml);var options={items:"save,-,undo,redo,-,h1,h2,h3,h4,-,bold,italic,-,ul,ol,-,link,image,code,hr,blockquote,table,htmlpaste,toc,-,sidebar,preview,history,preview-all,help,more",extraItems:"",uploader:{url:"/book/article/image",data:function(){return{book_id:state.id,path:state.articleId}},callback:function(status,msg){status||$.dialog.error(msg)},name:"image"},statusBar:_editorHtml[1],preview:!0,lang:{sidebar:"边栏",toc:"章节导航",history:"历史记录",htmlpaste:"粘贴HTML","preview-all":"全文预览"},tools:{sidebar:sidebar,toc:toc,history:history,htmlpaste:htmlpaste,more:more,save:save,"preview-all":previewAll},extensions:extensions};events.trigger("editor.before_init",options),$editor=editor(_textarea,options),$editor.$marked.setOption("book",state),$editor.$ace.on("change",function(){events.trigger("editor.change")}),$(window).on("beforeunload",function(){return $editor.isChanged()?"确定取消编辑吗？":void 0})},getEditor:function(){return $editor},addExtension:function(ext){extensions.push(ext)}}}),define("home/book/editor/events",function(){return $({})}),define("home/book/editor/index",function(require){var plugins,settings,events=require("./events"),catalog=require("./catalog"),article=require("./article"),state=require("./state"),editor=require("./editor"),ui=require("./ui"),backup=require("./backup"),preload=function(callback){var len=plugins.length;if(len){var plugin_name=plugins.shift();require.async("document/plugins/"+plugin_name+"/index",function(plugin){var assets=[];if(plugin){plugin.init&&plugin.init(settings);var blocks=plugin.blocks||{};$.each(blocks,function(name,ext){editor.addExtension(ext)}),plugin.editor?(plugin.editor.js&&(assets=assets.concat(plugin.editor.js)),plugin.editor.css&&(assets=assets.concat(plugin.editor.css)),assets=$.map(assets,function(item){return"document/plugins/"+plugin_name+"/"+plugin.editor.assets+"/"+item}),require.async(assets,function(){preload(callback)})):preload(callback)}else preload(callback)})}else callback()},checkImportStatus=function(callback){switch(state.status){case 2:$.ajax({url:"/book/import/status",type:"get",data:{book_id:state.id},success:function(data){1==data.status?callback():2==data.status?setTimeout(function(){checkImportStatus(callback)},6e3):window.location.reload()}});break;case 3:return!1;default:callback()}},start=function(config){settings=config,checkImportStatus(function(){plugins=config.plugins||[],preload(function(){events.trigger("init",config),editor.init(),backup.init(),article.init(),catalog.init(config),ui.init(),events.trigger("start")})})};return{start:start}}),define("home/book/editor/state",function(){var state={};return state.update=function(dom){var book=$(dom.find(".m-manual"));state.$book=book,state.id=book.data("id"),state.status=book.data("status"),state.ref="master"},state.update($),state}),define("home/book/editor/tools/history",function(require){var getArticleCommitAjax,getArticleHistoryAjax,state=require("../state"),events=require("../events"),Template=require("common/extend/template"),getArticleCommit=function(hash,callback){$.dialog.loading("获取提交信息中..."),getArticleCommitAjax&&getArticleCommitAjax.abort(),getArticleCommitAjax=$.ajax({url:"/book/article/commit",data:{book_id:state.id,hash:hash},type:"get",success:callback,complete:function(){$.dialog.get("loading").close()}})},getArticleHistory=function(path,offset,callback){$.dialog.loading("获取历史记录中..."),getArticleHistoryAjax&&getArticleHistoryAjax.abort(),getArticleHistoryAjax=$.ajax({url:"/book/article/history",data:{book_id:state.id,path:path,offset:offset},type:"get",success:callback,complete:function(){$.dialog.get("loading").close()}})};return{exec:function(){var _html='<div class="dialog-history"><div class="history-commits"><div class="history-commits-title"><span class="commits-count">0</span> 条修改记录</div><div class="history-commits-inner"><ul class="commits-list"></ul></div></div><div class="history-commit-details"></div></div>';_html=$(_html);var commitTemp='<li data-hash="<%=hash%>" class="commit"><div class="commit-avatar"><img src="<%=avatar%>"></div><div class="commit-message"><%=message%></div><div class="commit-meta"><%=date%> by <%=author%></div></li>',dialog=$.dialog(_html,{button:[function(){var _self=this,cancelBtn=$('<label class="w-btn btn-default btn-m"><button class="btn-input">关闭</button></label>');return cancelBtn.click(function(){_self.close()}),cancelBtn}],style:"think-dialog-form",drag:!1,close:!1,onCreate:function(){var _total=$(".commits-count",_html),_list=$(".commits-list",_html),_detail=$(".history-commit-details",_html),currentHash=null;_list.on("click","li",function(){$(this).siblings(".active").removeClass("active"),$(this).addClass("active");var hash=$(this).data("hash");return hash==currentHash?!1:void getArticleCommit(hash,function(data){currentHash=hash,_detail.html(data)})}),_detail.on("click",".reset",function(){var hash=$(this).data("hash");$.dialog.confirm("确定要恢复当前章节至此版本吗？",function(action){1==action&&(events.trigger("editor.reset",hash),dialog.close())})});var offset=0;getArticleHistory(state.articleId,offset,function(data){_total.text(data.total),$.each(data.list,function(k,v){_list.append(Template.parseTemp(commitTemp,v))}),0===offset&&$("li",_list).first().click()})}})}}}),define("home/book/editor/tools/htmlpaste",function(require){var state=require("../state");return{exec:function(){var editor=this;require.async("component/to-markdown/dist/to-markdown",function(){var $text,$iframe,$html,doc,dialog,downloadAjax,ie=navigator.userAgent.toLowerCase().indexOf("msie")>-1&&-1==navigator.userAgent.toLowerCase().indexOf("opera");$text=$("<p />").text("请使用快捷键(Ctrl+V)把内容粘贴到下面的方框里。"),$iframe=$('<iframe frameborder="0" style="width:600px;height:260px;padding: 5px;"></iframe>'),$html=$("<div/>").addClass("thinkeditor-plugin-htmlpaste").append($text).append($iframe),dialog=$.dialog.open($html,{title:"从HTML粘贴",onCancel:function(){$.dialog.get("loading").close(),downloadAjax&&downloadAjax.abort()},onOk:function(){$.dialog.get("loading").close(),downloadAjax&&downloadAjax.abort();var str=doc.body.innerHTML;str=str.replace(/~/g,"~T"),str=str.replace(/`/g,"~E"),str=str.replace(/\$/g,"~D"),str=toMarkdown(str,{gfm:!0});var cnum=0,arrcode=[];str=str.replace(/~~~([\s\S]*?)~~~/g,function(all){return cnum++,arrcode[cnum]=all,"[	codeplace_"+cnum+"	]"}),str=str.replace(/(`+)([^\r]*?[^`])\1(?!`)/g,function(wholeMatch,m1,m2,m3){return cnum++,arrcode[cnum]=wholeMatch,"[	codeplace_"+cnum+"	]"}),str=str.replace(/<\/?.+?>/g,""),str=str.replace(/\n{2,}/g,"\n\n");for(var i=1;cnum>=i;i++)str=str.replace("[	codeplace_"+i+"	]",function(){return arrcode[i]});str=str.replace(/~D/g,"$$"),str=str.replace(/~E/g,"`"),str=str.replace(/~T/g,"~"),editor.insert(str),dialog.close()}});var $localImageBtn=$('<label class="w-btn btn-m btn-success pull-left"><button class="btn-input" type="button">图片本地化</button></label>');$localImageBtn.click(function(){if("undefined"!=typeof $(this).attr("disabled"))return!1;var html=doc.body.innerHTML,reg=/<img\b[^>]*\ssrc\s*=\s*(["'])([^>'"]*)\1[^>]*>/gi,images=[],index=0;html=html.replace(reg,function(str,match1,match2){return match2.match(/^(https?:\/\/|\.)/i)?(index++,images[index]=match2,"[	imgplace_"+index+"	]"):str});var total=index,downloader=function(){if(index>0){var image=images[index],data={url:image,book_id:state.id,path:state.articleId};$.dialog.get("loading").content("远程图片下载中…… 还剩"+index+"张","success"),downloadAjax=$.post("/book/article/localize",data,function(result){html=html.replace("[	imgplace_"+index+"	]",function(){return'<img preview-src="'+result.info.src+'" src="'+result.info.url+'" />'}),index--,downloader()})}else doc.body.innerHTML=html,$.dialog.get("loading").close(),$localImageBtn.removeAttr("disabled")};total>0?($.dialog.loading("远程图片下载中……"),downloader(),$localImageBtn.attr("disabled","disabled")):$.dialog.error("没有远程图片")}),dialog.footElement.append($localImageBtn),doc=$iframe[0].contentDocument||$iframe[0].contentWindow.document,ie||(doc.designMode="on"),doc.open(),doc.write('<!doctype html><html style="height:100%;"><head><title>WordPaste</title></head>'),doc.write('<body style="background-color:#ffffff;font-size:12px;padding:0px;margin:0px;height: 100%;">'),ie||doc.write("<br />"),doc.write("</body></html>"),doc.close(),ie&&(doc.body.contentEditable="true"),$iframe[0].contentWindow.focus()})},markdown:!0}}),define("home/book/editor/tools/more",function(require){var state=require("../state"),events=require("../events");return{exec:function(){this.toolMore.toggle(),this.getToolbar("more").toggleClass("active")},init:function(){var _dropWrap=$('<div class="tools-more"><ul class="w-menu"><li class="menu-item"><a class="menu-link setting" href="javascript:;"><i class="icon icon-cog"></i> 文档配置</a></li><li class="menu-item"><a class="menu-link css" href="javascript:;"><i class="icon icon-paintcan"></i> 样式表</a></li></ul></div>'),editor=this;state.$book.append(_dropWrap),this.toolMore=_dropWrap,$("body").on("click",function(){editor.getToolbar("more").removeClass("active"),_dropWrap.hide()}),_dropWrap.on("click",".css",function(){events.trigger("catalog.select",{text:"样式表",id:"style/website.css",ext:"css"})}),_dropWrap.on("click",".setting",function(){events.trigger("catalog.select",{text:"配置文件",id:"book.json",ext:"json"})})}}}),define("home/book/editor/tools/previewAll",function(require){return{exec:function(){window.open(window.location.href.replace(/\/edit$/i,"/preview"))}}}),define("home/book/editor/tools/save",function(require){var events=require("../events");return{bindKey:{win:"ctrl+s",mac:"command+s"},exec:function(){this.isChanged()&&events.trigger("editor.save")},init:function(){var editor=this;this.getToolbar("save").attr("disabled","disabled").removeClass("warning"),this.$ace.on("change",function(){editor.isChanged()?editor.getToolbar("save").removeAttr("disabled","disabled").addClass("warning"):editor.getToolbar("save").attr("disabled","disabled").removeClass("warning")})}}}),define("home/book/editor/tools/sidebar",function(require){var state=require("../state");return{exec:function(){state.$book.hasClass("manual-fullscreen")?(state.$book.removeClass("manual-fullscreen"),this.getToolbar("sidebar").addClass("active")):(state.$book.addClass("manual-fullscreen"),this.getToolbar("sidebar").removeClass("active")),this.$ace.resize()},init:function(){this.getToolbar("sidebar").addClass("active")}}}),define("home/book/editor/tools/toc",function(){return{exec:function(){this.insert("\n[TOC]\n")},init:function(){var _editor=this;this.preview.on("click","ul.markdown-toc-list a",function(e){e.stopImmediatePropagation();var id=$(this).attr("href");return _editor.preview.animate({scrollTop:$(id).offset().top-60},500),!1})},markdown:!0}}),define("home/book/editor/ui",function(require){var events=require("./events"),state=require("./state");return{init:function(){events.on("start",function(){state.$book.show(),$(".think-loading").remove()}),events.on("article.open",function(event,data){state.$book.find(".manual-editor-status .filename").text(decodeURIComponent(data.node.id))});var emptyEle;events.on("catalog.empty",function(event,status){if(status){var _html="";_html+='<div class="manual-empty-message">',_html+='<div class="inner">',_html+="<h3>文档还没有目录，赶紧添加吧！</h3>",_html+="</div>",_html+="</div>",emptyEle=$(_html),state.$book.find(".manual-body").append(emptyEle),state.$book.addClass("manual-empty")}else state.$book.removeClass("manual-empty"),emptyEle&&(emptyEle.remove(),emptyEle=null)})}}}),define("home/book/history/detail",function(require,exports,module){Class({resetHistoryEle:$("#resetHistory"),initial:function(){this.resetHistoryEle.click(function(){$.dialog.confirm("确定文档回滚至此版本吗？回滚后，该版本之后的所有的修改记录将丢失。",function(action){1==action&&($.dialog.loading("文档回滚中..."),$.ajax({url:Config.get("resetUrl"),data:{book_id:Config.get("currentManual"),hash:Config.get("hash")},context:this,type:"post",success:function(data){1==data.status?$.dialog.success("回滚成功"):$.dialog.error(data.info),$.dialog.get("loading").close()}}))})})}})}),define("home/book/history/index",function(require,exports,module){require("component/infinite-ajax-scroll/dist/jquery-ias.min"),Class({initial:function(){var ias=jQuery.ias({container:".m-history-list",item:".m-history-item",pagination:".m-paging",next:".m-paging .next"});ias.extension(new IASSpinnerExtension),ias.extension(new IASTriggerExtension({offset:3,text:"点击加载更多"})),ias.extension(new IASNoneLeftExtension({text:"没有更多了"})),$("#manualGc").click(function(){return $.dialog.loading("垃圾回收中..."),$.ajax({url:"/book/history/gc",data:{book_id:Config.get("manualId")},type:"post",success:function(data){data.status?$.dialog.success("垃圾回收完成",function(){location.reload()}):$.dialog.error(data.info)},complete:function(){$.dialog.get("loading").close()}}),!1})}})}),define("home/book/index",function(require,exports,module){require("component/semantic-ui-tab/tab.min"),require("component/infinite-ajax-scroll/dist/jquery-ias.min");var Comment=require("common/module/comment"),Sharing=require("common/module/sharing"),Order=require("common/module/order");return Class({manual:$(".reader-main"),manualId:Config.get("bookId"),manualDownloadEle:$("#manualDownload"),shareArticleEle:$("#shareArticle"),articleTitleEle:$("#articleTitle"),articleDescriptionEle:$("#articleDescription"),manualFollowEle:$("#manualFollow"),manualFollowNumber:$("#manualFollowNumber"),followTotal:Config.get("followTotal"),manualSummary:$("#entrance_summary"),manualDirectory:$("#entrance_directory"),manualComment:$("#entrance_comment"),manualContainer:$(".ent-wrap"),commentEle:$("#articleComment"),rewardBtn:$("#reward-btn"),buyBookBtn:$("#buyBook"),userFollowManual:[],initial:function(){var _self=this;if(_self.rewardBtn.click(function(){new Order({title:"欢迎打赏",type:"RewardProduct",infoTpl:['<div class="reward-item">','<img class="user-img"src="'+Config.get("userAvatar")+'">','<p class="reward-msg">喜欢是赞, 爱是打赏</p>','<label class="reward-text">',"<span>打赏金额</span>",'<span class="num">¥</span>','<input class="reward-input" type="number" min="1" max="200" style="width:60%" name="price" value="'+(Config.get("defaultPrice")/100).toFixed(2)+'" />',"</label>","</div>"].join(""),coin:Config.get("userCoin"),style:"reward-form",price:function(){return parseInt(100*this.wrapEle.find("[name=price]").val())},data:function(){return{price:parseInt(100*this.wrapEle.find("[name=price]").val()),user_id:Config.get("bookUid"),book_id:Config.get("bookId")}},onInit:function(){var self=this;this.wrapEle.find("[name=price]").keyup(function(){self.freshPrice()}),this.wrapEle.find("[name=price]").change(function(){self.freshPrice()})},onSuccess:function(){location.reload()}})}),_self.buyBookBtn.click(function(){return Config.get("isLogin")?void new Order({title:"购买 "+Config.get("bookTitle"),type:"BookProduct",infoTpl:['<div class="book-info">','<img class="user-img"src="'+Config.get("bookPicUrl")+'">','<p class="book-title">'+Config.get("bookTitle")+"</p>","</div>"].join(""),coin:Config.get("userCoin"),style:"bookproduct-form",price:parseInt(Config.get("bookPrice")),data:function(){return{price:parseInt(Config.get("bookPrice")),book_id:Config.get("bookId")}},onInit:function(){var self=this;this.wrapEle.find("[name=price]").keyup(function(){self.freshPrice()}),this.wrapEle.find("[name=price]").change(function(){self.freshPrice()})},onSuccess:function(){location.reload()}}):void $.dialog.error("请登录后再购买",{time:5e3})}),this.getReward(),$(".tab-navg .navg-item").tab({selector:{tabs:".tab-content"}}),Config.get("isDownload")){this.manualDownloadEle.find(".menu-link").click(function(){_self.downloadManual($(this).data("type"))});var kindle_loading=!1;$("#manualKindle").click(function(){kindle_loading||(kindle_loading=!0,$.dialog.loading("请稍后……"),$.ajax({url:Config.get("kindleUrl"),data:{book_id:_self.manualId},type:"post",success:function(data){1==data.status?$.dialog.success(data.info):$.dialog.error(data.info,{time:5e3})},complete:function(){$.dialog.get("loading").close(),kindle_loading=!1}}))})}if(new Sharing({cover:Config.get("sharePicUrl"),url:location.href,title:Util.HTMLEnCode(_self.articleTitleEle.text()),summary:Util.HTMLEnCode(Util.substr(_self.articleDescriptionEle.text(),0,200))}),this.manualFollowEle.click(function(){_self.inUserFollowManual(_self.manualId)>=0?_self.cancelFollowManual():_self.addFollowManual()}),Config.get("isComment")){_self.comment=new Comment({wrapEle:_self.commentEle,postParam:{book_id:_self.manualId,doc_id:0},delParam:{book_id:_self.manualId,doc_id:0},disabledPost:!Config.get("isLogin"),votePath:Config.get("commentVotePath"),onePath:Config.get("commentOnePath"),listPath:Config.get("commentListPath"),delPath:Config.get("commentDelPath"),addPath:Config.get("commentAddPath")});var hash=location.hash.substr(1),_hashSplit=null;hash&&hash.indexOf("-")>=0&&(_hashSplit=hash.split("-")),_hashSplit&&"comment"==_hashSplit[0]&&_hashSplit[1]?this.comment.loadOne({id:_hashSplit[1],doc_id:0,book_id:this.manualId},function(data){this.assignList({doc_id:0,book_id:_self.manualId},function(){data.status&&this.addItem(data.data,!0,!1)}),Util.scrollTop(this.listEle,-120)}):this.comment.assignList({doc_id:0,book_id:_self.manualId})}(function(){function loadCallback(callback){_self.getUserFollowManual(function(){$.isFunction(callback)&&callback()})}loadCallback(function(){_self.findUserFollowManual()})}).call(this)},downloadManual:function(type){var ele=this.manualDownloadEle.find(".drop-show");ele.click();$.ajax({url:Config.get("getDownloadUrl"),data:{book_id:this.manualId,type:type},type:"post",success:function(data){1==data.status?(window.location.href=data.url,ele.removeClass("loading")):($.dialog.error(data.info),ele.removeClass("loading"))}})},addFollowManual:function(){var self=this;$.ajax({url:Config.get("confirmFollowUrl"),data:{book_id:self.manualId},type:"post",success:function(data){data.status?(self.manualFollowNumber.text(parseInt(self.manualFollowNumber.text())+1),self.userFollowManual.push(self.manualId),self.manualFollowEle.find(".number").text(++self.followTotal),self.findUserFollowManual(),$.dialog.success(data.info)):$.dialog.error(data.info)},complete:function(){self.manualFollowEle.removeClass("loading")}})},cancelFollowManual:function(){var self=this;$.ajax({url:Config.get("cancelFollowUrl"),data:{book_id:self.manualId},type:"post",success:function(data){if(data.status){self.manualFollowNumber.text(parseInt(self.manualFollowNumber.text())-1);var _index=self.inUserFollowManual();self.manualFollowEle.find(".number").text(--self.followTotal),self.userFollowManual.splice(_index,1),self.findUserFollowManual(),$.dialog.success(data.info)}else $.dialog.error(data.info)},complete:function(){self.manualFollowEle.removeClass("loading")}})},getUserFollowManual:function(callback){var self=this;$.ajax({url:Config.get("getFollowUrl"),type:"post",success:function(data){data.status&&(self.userFollowManual=data.data),$.isFunction(callback)&&callback.call(self)}})},findUserFollowManual:function(){if(Config.get("memberIsAuthor"))this.manualFollowEle.addClass("data-disabled").find(".text").text("关注数");else{var _index=this.inUserFollowManual();_index>=0?(this.manualFollowEle.removeClass("btn-success").addClass("btn-default"),this.manualFollowEle.find(".text").text("取消关注")):(this.manualFollowEle.removeClass("btn-default").addClass("btn-success"),this.manualFollowEle.find(".text").text("关注"))}},inUserFollowManual:function(){for(var i=0;i<this.userFollowManual.length;i++)if(this.manualId==this.userFollowManual[i])return i;return-1},getReward:function(){var bookId=this.manualId,isLoad=!1;$("[data-tab=reward]").click(function(){return isLoad?void(isLoad=!0):(isLoad=!0,void $("#articleReward").load("/reward?book_id="+bookId,function(){$.ias({container:".m-reward-list",item:".m-reward-item",pagination:".m-paging",next:".m-paging .next"})}))})}})}),define("home/book/member/index",function(require,exports,module){return require("component/select2/dist/css/select2.css"),require("component/select2/dist/js/select2.full.min"),Class({selectMemberEle:$("#selectMember"),currentManualId:Config.get("currentManual"),memberListEle:$("#memberList"),maxMemberNum:Config.get("maxSelectNumber"),initial:function(){var self=this;this.selectMemberEle.click(function(){var $html,dialog;$html=$("<div/>").addClass("m-manual-add").html('<form class="w-form form-horizon dialog-form" method="post"><div class="form-item"><span class="form-label">用户</span><div class="form-target"><label class="w-select select-m"><select class="select-input" name="user" multiple="multiple"></select></label></div></div><div class="form-item"><span class="form-label">角色</span><div class="form-target"><label class="w-select select-m"><select class="select-input" name="role"></select></label></div></div></form>'),dialog=$.dialog.form($html,{title:"添加成员",onCreate:function(){var _form=this.bodyElement.find("form");_form.append($('<input type="hidden" name="book_id" value="'+self.currentManualId+'">')),_form.attr("action",Config.get("createUserUrl")),_form.find('[name="role"]').append(function(){var options="";return $.each(Config.get("accessRoles"),function(k,v){options+="<option value='"+v+"'>"+k+"</option>"}),options}),_form.find('[name="user"]').select2({placeholder:"选择用户",width:232,multiple:!0,ajax:{url:"/autocomplete/user",data:function(params){return{search:params.term}},processResults:function(data){return{results:data}}},templateResult:function(state){return state.id?$('<div style="line-height: 20px;white-space:nowrap;overflow: hidden;text-overflow: ellipsis; font-weight: bold;"><img style="border-radius: 3px;" src="'+state.avatar+'" width="20" height="20" /> '+state.username+' <span style="font-weight: normal;">'+state.name+"</span></div>"):state.text},templateSelection:function(state){return state.name||state.text}}),_form.submitForm({onBefore:function(options){var user=_form.find('[name="user"]').val();return user?void(options.data.user=user):($.dialog.error("请选择用户"),!1)},onAfter:function(data,options){data.status?window.location.reload():$.dialog.error(data.info)}})}})}),this.memberListEle.delegate(".delete","click",function(){var _id=$(this).closest(".m-member-item").data("id"),$this=$(this);$.dialog.confirm("确定要删除该用户吗？",function(action){1==action&&$.ajax({url:Config.get("delMemberPath"),data:{id:_id,book_id:self.currentManualId},context:this,type:"post",success:function(data){data.status?$this.closest(".m-member-item").remove():$.dialog.error(data.info)}})})}),this.memberListEle.delegate(".leave","click",function(){$.dialog.confirm("确定要退出吗？",function(action){1==action&&$.ajax({url:Config.get("leaveUserUrl"),data:{book_id:self.currentManualId},context:this,type:"post",success:function(data){data.status?window.location.href="/user/book":$.dialog.error(data.info)}})})}),this.memberListEle.delegate(".role>select","change",function(){var _id=$(this).closest(".m-member-item").data("id");$.ajax({url:Config.get("setMemberRolePath"),data:{id:_id,role:$(this).val(),book_id:self.currentManualId},context:this,type:"post",success:function(data){data.status?$.dialog.success(data.info):$.dialog.error(data.info)}})})}})}),define("home/book/price",function(require,exports,module){require("common/extend/validator/validator"),require("component/jquery.form"),require("component/jstree/dist/jstree.js"),
require("component/jstree/dist/themes/default/style.min.css");var config=require("common/module/config");return Class({initial:function(){var book_id=config.get("bookId"),setPreviewUrl=config.get("setPreviewUrl");$("#manualUpdatePriceForm").submitForm({autoValidate:!1,onAfter:function(data,options){if(data.status)$.dialog.success(data.info,function(){location.reload()});else{var _errorInfo=[];if($.isPlainObject(data.info)){for(var i in data.info)_errorInfo.push(data.info[i]);_errorInfo=_errorInfo.join("<br/>")}else _errorInfo=data.info;$.dialog.error(_errorInfo)}}}),$(".btn-shelve-up").on("click",function(){$.post($(this).data("url"),{book_id:book_id,shelve:1},function(data){$.dialog.success(data.info,function(){location.reload()})})}),$(".btn-shelve-down").on("click",function(){$.post($(this).data("url"),{book_id:book_id,shelve:2},function(data){$.dialog.success(data.info,function(){location.reload()})})});var summary=config.get("summary");if(summary){var summayData=[];$.each(summary,function(k,v){summayData.push({id:v.id,text:v.title,icon:!1,state:{selected:1==v.is_preview},parent:0==v.pid?"#":v.pid})});$("#summary-container").jstree({core:{check_callback:!0,data:summayData,force_text:!0},plugins:["checkbox"],checkbox:{keep_selected_style:!1,three_state:!1}}).jstree();$("#summary-container").bind("select_node.jstree",function(event,data){$.post(setPreviewUrl,{book_id:book_id,id:data.node.id,is_preview:1},function(result){})}),$("#summary-container").bind("deselect_node.jstree",function(event,data){$.post(setPreviewUrl,{book_id:book_id,id:data.node.id,is_preview:0},function(result){})})}}})}),define("home/book/update",function(require,exports,module){var TagCreate=require("common/module/tagCreate");return require("common/extend/validator/validator"),require("component/jquery.form"),Class({uploadCoverFormEle:$("#uploadCoverForm"),uploadCoverEle:$("#uploadCover"),reCoverEle:$("#reCover"),manualUpdateFormEle:$("#manualUpdateForm"),manualDeleteEle:$("#manualDelete"),manualInfoCoverEle:$(".m-manual-info .cover img"),uploadNumber:0,manualTagEle:$("#manualTag"),manualId:Config.get("manualId"),initial:function(){var self=this;this.createTag=new TagCreate({appendEle:this.manualTagEle,maxNumber:10,hiddenName:"tags",data:Config.get("createdTags"),onRepeat:function(item,text){$.dialog.error(text+"标签已创建")},onMaxLimit:function(max){$.dialog.error("最多允许创建"+max+"个标签")}}),this.uploadCoverEle.click(function(){self.cutImageDialog?self.cutImageDialog.open():(self.cutImageDialog=$.dialog('<div class="m-dialog-loading"><b class="loading-text">裁剪组件加载中...</b></div>',{title:"封面裁剪",cache:!0}),require.async("common/module/cutImage",function(cutImage){self.cutCover=new cutImage({cls:"m-cover-cutting",cutWidth:173,cutHeight:231,boxWidth:420,boxHeight:300,uploadUrl:Config.get("uploadCoverUrl"),uploadParam:{book_id:Config.get("manualId"),title:Config.get("manualTitle")},saveCutUrl:Config.get("saveCoverUrl"),saveCutParam:{book_id:Config.get("manualId"),title:Config.get("manualTitle")},onSuccess:function(data){var _image=self.uploadCoverEle.find("img"),_src=data.data.url.indexOf("?")>=0?data.data.url+"&v="+self.uploadNumber:data.data.url+"?v="+self.uploadNumber;self.cutImageDialog.close(),self.uploadNumber++,_image.length||(_image=$("<img/>"),self.uploadCoverEle.find(".upload-image").html(_image)),self.manualInfoCoverEle.attr("src",_src),_image.attr("src",_src)}}),self.cutImageDialog.content(self.cutCover.getHtml()),self.cutImageDialog.offset(self.cutImageDialog._options.offset[0],self.cutImageDialog._options.offset[1])}))}),this.manualUpdateFormEle.submitForm({autoValidate:!1,onAfter:function(data,options){if(data.status)$.dialog.success(data.info,function(){location.reload()});else{var _errorInfo=[];if($.isPlainObject(data.info)){for(var i in data.info)_errorInfo.push(data.info[i]);_errorInfo=_errorInfo.join("<br/>")}else _errorInfo=data.info;$.dialog.error(_errorInfo)}}}),this.manualDeleteEle.click(function(){var $html=$("<div/>").html('<div class="w-alert alert-danger">该操作 <strong>不可逆</strong> ,将会删除该文档的所有信息,请确认</div><form class="w-form" method="post"><div class="form-item"><span class="form-label">请输入文档标识以确认</span><div class="form-target"><label class="w-text text-m text-full"><input type="text" name="name" class="text-input" /></label></div></div></form>');return $.dialog.open($html,{title:"删除文档",onOk:function(){var name=$html.find('input[name="name"]').val();name&&name===Config.get("bookName")?$.ajax({url:Config.get("delUrl"),data:{book_id:Config.get("manualId")},type:"post",success:function(data){data.status?location.href=data.url:$.dialog.error(data.info)}}):$.dialog.error("请输入正确的文档标识")}}),!1}),this.reCoverEle.click(function(){return $.dialog.confirm("将使用系统生成的图片作为本文档的封面",function(action){1==action&&($.dialog.loading("重建封面中..."),$.ajax({url:Config.get("reCoverUrl"),data:{book_id:Config.get("manualId")},type:"post",success:function(data){if(data.status){var _image=self.uploadCoverEle.find("img"),_src=data.data.url;_image.length||(_image=$("<img/>"),self.uploadCoverEle.find(".upload-image").html(_image)),_image.attr("src",_src),$.dialog.success("封面重建完成")}else $.dialog.error(data.info)},complete:function(){$.dialog.get("loading").close()}}))}),!1}),$("#manualOpen").click(function(){return $.dialog.confirm("确定要将文档转为公开文档吗",function(action){1==action&&($.dialog.loading("请稍后..."),$.ajax({url:"/book/setting/open",data:{book_id:Config.get("manualId")},type:"post",success:function(data){data.status?$.dialog.success("转换完成",function(){window.location.reload()}):$.dialog.error(data.info)},complete:function(){$.dialog.get("loading").close()}}))}),!1}),$("#manualClose").click(function(){return $.dialog.confirm("确定要将文档转为私有文档吗",function(action){1==action&&($.dialog.loading("请稍后..."),$.ajax({url:"/book/setting/close",data:{book_id:Config.get("manualId")},type:"post",success:function(data){data.status?$.dialog.success("转换完成",function(){window.location.reload()}):$.dialog.error(data.info)},complete:function(){$.dialog.get("loading").close()}}))}),!1}),$("#manualTransfer").click(function(){var $html=$("<div/>").html('<div class="w-alert alert-warning">该操作 <strong>不可逆</strong> ,该文档的所有权将会转移给所选空间</div><form class="w-form dialog-form" method="post" action="/book/setting/transfer"><input type="hidden" name="book_id" value="'+Config.get("manualId")+'" /><div class="form-item"><span class="form-label">请输入要转让的用户名或者团队标识</span><div class="form-target"><label class="w-text text-m text-full"><input type="text" name="namespace" class="text-input" /></label></div></div></form>');return $.dialog.form($html,{title:"转让文档",onCreate:function(){var _form=this.bodyElement.find("form");_form.submitForm({onAfter:function(data,options){data.status?location.href=data.url:$.dialog.error(data.info)}})}}),!1})}})}),define("home/compatible",function(require,exports,module){Class({initial:function(){var self=this;this.hasPlaceholderSupport()||this.placeholder($("[placeholder]")),$(document).on("onCompatible",function(event,name,element){"placeholder"==name&&element&&!self.hasPlaceholderSupport()&&self.placeholder(element)})},placeholder:function(element){require.async("component/jquery.placeholder",function(){element.placeholder()})},hasPlaceholderSupport:function(){var input=document.createElement("input");return"placeholder"in input}})}),define("home/enterprise/centre/create",function(require,exports,module){return require("common/extend/validator/validator"),require("component/jquery.form"),Class({formEle:$("#createCentreForm"),initial:function(){this.formEle.submitForm({autoValidate:!1,onAfter:function(data){data.status?$.dialog.success(data.info,function(){location.reload()}):$.dialog.error(data.info)}})}})}),define("home/enterprise/centre/update",function(require,exports,module){require("component/select2/dist/css/select2.css"),require("component/select2/dist/js/select2.full.min"),require("component/Sortable/jquery.fn.sortable.min"),require("component/webuploader/css/webuploader.css"),require("component/webuploader/dist/webuploader");var Template=require("common/extend/template"),editor=require("common/module/editor");return Class({itemTpl:['<div class="w-centre-item">',"<h2>",'<label class="w-text text-s ">','<input class="text-input" type="text" name="name" value="分类名称" />',"</label>",'<a href="javascript:;" class="w-btn btn-s pull-right btn-red btn-delete"><b class="btn-input"><i class="icon-cross"></i></b></a>','<a href="javascript:;" class="w-btn btn-s pull-right btn-default btn-add"><b class="btn-input"><i class="icon-mode-edit"></i> 添加文档</b></a>',"</h2>","<ul>","</ul>","</div>"].join(""),bookItemTpl:['<li data-id="<%=id%>">','<a target="_blank" href="javascript:;" class="item-text"><%=title%></a>','<a href="javascript:;" class="item-delete"><i class="icon-cross"></i></a>',"</li>"].join(""),getEditor:function(){return this._editor||(this._editor=editor($("#descEditor").find("textarea"),{items:"undo,redo,-,h1,h2,h3,h4,-,bold,italic,-,ul,ol,-,link,image,code,hr,blockquote,table,-,preview,fullscreen,help",uploader:{url:"/image/upload"}})),this._editor},initial:function(){var self=this;$(".w-centre-add-item").on("click",function(){$html=$(Template.parseTemp(self.itemTpl)),$(this).parent().before($html),$html.children("ul").sortable()}),this.getEditor(),$(".w-centre-content").on("click",".w-centre-item .btn-delete",function(){var $this=$(this);return $.dialog.confirm("确定要移除该分类吗?",function(action){1==action&&$this.parents(".w-centre-item").remove()}),!1}),$(".w-centre-content").on("click",".w-centre-item .btn-add",function(){var $html,dialog,$this=$(this);$html=$("<div/>").addClass("m-manual-add").html('<form class="w-form form-horizon dialog-form" method="post"><div class="form-item"><span class="form-label">文档</span><div class="form-target"><label class="w-select select-m"><select class="select-input" name="item" multiple="multiple"></select></label></div></div></div>');var books=[];dialog=$.dialog.open($html,{title:"添加文档",onCreate:function(){var $select=this.bodyElement.find('[name="item"]');$select.select2({placeholder:"选择文档",width:232,multiple:!0,ajax:{url:"/setting/centre/book",data:function(params){return{search:params.term}},processResults:function(data){return{results:data}}},templateResult:function(repo){return repo.id?$('<div style="overflow: hidden;"><img style="float: left;" width="40" src="'+repo.cover+'" /><span style="margin-left: 50px;font-style: normal;display: block;line-height: 1.5;">'+repo.title+"</span></div>"):repo.text},templateSelection:function(repo){return repo.title||repo.text}}),$select.on("select2:select",function(e){books.push(e.params.data)}),$select.on("select2:unselect",function(e){for(var i=0;i<books.length;i++)if(books[i].id==e.params.data.id){books.splice(i,1);break}})},onOk:function(){for(var i=0;i<books.length;i++)$this.parents(".w-centre-item").find("ul").append(Template.parseTemp(self.bookItemTpl,books[i]));dialog.close()}})}),$(".w-centre-content").on("click",".w-centre-item .item-delete",function(){var $this=$(this);return $.dialog.confirm("确定要移除该文档吗?",function(action){1==action&&$this.parents("li").remove()}),!1}),$(".w-centre-content .w-centre-item ul").sortable();var uploader=WebUploader.create({runtimeOrder:!1,auto:!0,width:86,height:34,server:"/image/upload",fileNumLimit:1,pick:"#uploadLogo",accept:{title:"Image",extensions:"jpg,jepg,gif,png",mimeTypes:"*"},formData:{ajax:1}});uploader.on("uploadSuccess",function(file,data){data.status?($(".w-centre-logo").find(".upload-image img").attr("src",data.files.image0.src),$(".w-centre-logo").find("[name=logo]").val(data.files.image0.src),$.dialog.success(data.info)):$.dialog.error(data.info)}),uploader.on("uploadProgress",function(file,percentage){$.dialog.loading("上传中")}),$("#updateCentreForm").submitForm({autoValidate:!1,onBefore:function(options){var content=[];$(".w-centre-content .w-centre-item:not(:last-child)").each(function(){var books=[];$(this).find("ul li").each(function(){books.push($(this).data("id"))}),content.push({title:$(this).find("h2 input[name=name]").val(),books:books})}),options.data.content=content,options.data.description=self.getEditor().getValue()},onAfter:function(data){data.status?($.dialog.success(data.info),location.reload()):"string"==typeof data.info&&$.dialog.error(data.info)}})}})}),define("home/enterprise/member/index",function(require,exports,module){return require("component/select2/dist/css/select2.css"),require("component/select2/dist/js/select2.full.min"),Class({selectMemberEle:$("#selectMember"),memberListEle:$("#memberList"),initial:function(){var self=this;this.selectMemberEle.click(function(){var $html,dialog;$html=$("<div/>").addClass("m-manual-add").html('<form class="w-form form-horizon dialog-form" method="post"><div class="form-item"><span class="form-label">用户</span><div class="form-target"><label class="w-select select-m"><select class="select-input" name="user" multiple="multiple"></select></label></div></div><div class="form-item"><span class="form-label">角色</span><div class="form-target"><label class="w-select select-m"><select class="select-input" name="role"></select></label></div></div></div>'),dialog=$.dialog.form($html,{title:"添加成员",onCreate:function(){var _form=this.bodyElement.find("form");_form.attr("action",Config.get("createUserUrl")),_form.find('[name="role"]').append(function(){var options="";return $.each(Config.get("accessRoles"),function(k,v){options+="<option value='"+v+"'>"+k+"</option>"}),options}),_form.find('[name="user"]').select2({placeholder:"选择用户",width:232,multiple:!0,ajax:{url:"/autocomplete/user",data:function(params){return{search:params.term}},processResults:function(data){return{results:data}}},templateResult:function(state){return state.id?$('<div style="line-height: 20px;white-space:nowrap;overflow: hidden;text-overflow: ellipsis; font-weight: bold;"><img style="border-radius: 3px;" src="'+state.avatar+'" width="20" height="20" /> '+state.username+' <span style="font-weight: normal;">'+state.name+"</span></div>"):state.text},templateSelection:function(state){return state.name||state.text}}),_form.submitForm({onBefore:function(options){var user=_form.find('[name="user"]').val();return user?void(options.data.user=user):($.dialog.error("请选择用户"),!1)},onAfter:function(data,options){data.status?window.location.reload():$.dialog.error(data.info)}})}})}),this.memberListEle.delegate(".delete","click",function(){var _id=$(this).closest(".m-member-item").data("id"),$this=$(this);$.dialog.confirm("确定要删除该用户吗？",function(action){1==action&&$.ajax({url:Config.get("delMemberPath"),data:{id:_id,book_id:self.currentManualId},context:this,type:"post",success:function(data){data.status?$this.closest(".m-member-item").remove():$.dialog.error(data.info)}})})}),this.memberListEle.delegate(".role>select","change",function(){var _id=$(this).closest(".m-member-item").data("id");$.ajax({url:Config.get("setMemberRolePath"),data:{id:_id,role:$(this).val(),book_id:self.currentManualId},context:this,type:"post",success:function(data){data.status?$.dialog.success(data.info):$.dialog.error(data.info)}})})}})}),define("home/globle",function(require,exports,module){if("undefined"!=typeof nonsupportIE&&nonsupportIE===!0)return!1;var Template=require("common/extend/template");require("component/jquery.loading"),require("component/jquery.drop"),require("common/extend/dialog/dialog"),require("common/library/function"),require("common/module/customerService"),Template.setData({STATIC:Config.get("STATIC"),ROOT:Config.get("ROOT")}),Template.helper("getMemberAvatar",Util.getMemberAvatar),require("home/compatible"),require("component/hint.css/hint.min.css"),Class({topbarSearchEle:$("#topbarSearch"),placeholderImage:Config.get("STATIC")+"/home/image/20.png",initial:function(){var self=this;$(".e-cover img").each(function(){var _orgImage=$(this),_newImg=$("<img/>");_newImg.bind("error",function(){_orgImage.attr("src",self.placeholderImage),_orgImage.parent().addClass("cover-error")}),_newImg.attr("src",$(this).attr("src"))}),$(".m-manual-info .cover img").each(function(){var _orgImage=$(this),_newImg=$("<img/>");_newImg.bind("error",function(){_orgImage.attr("src",self.placeholderImage),_orgImage.closest(".cover").addClass("cover-error")}),_newImg.attr("src",$(this).attr("src"))}),this.topbarSearchEle.submit(function(){var _text=$(this).find(":text");return $.trim(_text.val())?void 0:(Util.wranStyle(_text,"text-wran"),!1)}),function(){var _page=$(".m-page"),_header=$('<b class="e-hander">搜索</b>').appendTo(_page.find(".page-head"));_header.click(function(){_page.hasClass("page-head-toggle")?(_page.removeClass("page-head-toggle"),_header.text("搜索")):(_page.addClass("page-head-toggle"),_header.text("取消"))})}(),Config.get("isLogin")&&this.checkNewNotification(),$(".m-navg-toggle").click(function(){$(".m-page .page-head .left .m-navg").slideToggle()})},checkNewNotification:function(){Config.get("checkNotification")&&$.ajax({url:"/notification/check",type:"get",success:function(status){status>0?$(".page-head .navg-link .icon-email").addClass("new"):$(".page-head .navg-link .icon-email").removeClass("new")}})}})}),define("home/index/forward",function(require,exports,module){require("component/fullPage/vendors/jquery.slimscroll.min"),require("component/fullPage/jquery.fullPage"),Class({initial:function(){var _page=$(".m-page"),_pageAnchors=["one","two","three","four","five","six","seven","eight","nine"];$("#fullpage").fullpage({anchors:_pageAnchors,navigation:!0,navigationPosition:"right",onLeave:function(leavingSection,leavingSectionIndex,sectionIndex,yMovement){$.each(_pageAnchors,function(i,v){_page.removeClass("page-fullpage-"+v)}),_page.addClass("page-fullpage-"+_pageAnchors[leavingSectionIndex-1])}}),$("#fullpage").show()}})}),define("home/index/index",function(require,exports,module){require("component/carousel/owl-carousel/owl.carousel.css"),require("component/carousel/owl-carousel/owl.theme.css"),require("component/carousel/owl-carousel/owl.carousel.min"),Class({bannerSlideEle:$("#bannerSlide"),manualRecome1Ele:$("#manualRecome1"),manualRecome2Ele:$("#manualRecome2"),manualRecome3Ele:$("#manualRecome3"),initial:function(){this.bannerSlideEle.owlCarousel({navigation:!0,slideSpeed:300,paginationSpeed:400,autoPlay:!0,singleItem:!0})}})}),define("home/manage/book/detail",function(require,exports,module){Class({initial:function(){$("#setCommissionRatio").on("click",function(){var _ele=$(this);return $.ajax({url:_ele.attr("href"),data:{commission_ratio:$("[name=commission_ratio]").val(),book_id:_ele.data("id")},type:"post",success:function(data){data.status?location.reload():$.dialog.error(data.info)}}),!1}),$("#book-delete").on("click",function(){var _ele=$(this),_id=$(this).data("id");return $.dialog.confirm("确定删除吗",function(action){1==action&&$.ajax({url:_ele.data("href"),data:{book_id:_id},type:"post",success:function(data){data.status?location.reload():$.dialog.error(data.info)}})}),!1}),$("#set-cover").on("click",function(){var _ele=$(this),_id=$(this).data("id");return $.ajax({url:_ele.data("href"),data:{book_id:_id},type:"post",success:function(data){data.status?location.reload():$.dialog.error(data.info)}}),!1}),$("#submit-baidu").on("click",function(){var _ele=$(this),_id=$(this).data("id");return $.dialog.confirm("确定提交到百度吗",function(action){1==action&&$.ajax({url:_ele.data("href"),data:{book_id:_id},type:"post",success:function(data){data.status?$.dialog.success(data.info):$.dialog.error(data.info)}})}),!1}),$("#book-forbid").on("click",function(){var _ele=$(this),_id=$(this).data("id");return $.dialog.confirm("确定禁用吗",function(action){1==action&&$.ajax({url:_ele.data("href"),data:{book_id:_id},type:"post",success:function(data){data.status?location.reload():$.dialog.error(data.info)}})}),!1}),$("#book-recover").on("click",function(){var _ele=$(this),_id=$(this).data("id");return $.ajax({url:_ele.data("href"),data:{book_id:_id},type:"post",success:function(data){data.status?location.reload():$.dialog.error(data.info)}}),!1})}})}),define("home/manage/book/index",function(require,exports,module){require("component/select2/dist/css/select2.css"),require("component/select2/dist/js/select2.full.min"),Class({namespaceEle:$("#namespace"),manualListEle:$(".list-right"),initial:function(){this.namespaceEle.select2({placeholder:"所属用户",allowClear:!0,ajax:{url:"/autocomplete/user",data:function(params){return{search:params.term}},processResults:function(data){return{results:data}}},templateResult:function(repo){return repo.name},templateSelection:function(repo){return repo.name||repo.text}}),this.manualListEle.delegate(".recommend","click",function(){var _ele=$(this),_id=$(this).data("id");return $.ajax({url:_ele.attr("href"),data:{book_id:_id},type:"post",success:function(data){data.status?location.reload():$.dialog.error(data.info)}}),!1})}})}),define("home/manage/coupon/index",function(require,exports,module){require("component/select2/dist/css/select2.css"),require("component/select2/dist/js/select2.full.min"),Class({namespaceEle:$("#namespace"),manualListEle:$(".list-right"),initial:function(){this.namespaceEle.select2({placeholder:"所属用户",allowClear:!0,ajax:{url:"/autocomplete/user",data:function(params){return{search:params.term}},processResults:function(data){return{results:data}}},templateResult:function(repo){return repo.name},templateSelection:function(repo){return repo.name||repo.text}}),this.manualListEle.delegate(".delete","click",function(){var _ele=$(this),_id=$(this).data("id");return $.dialog.confirm("确定删除吗",function(action){1==action&&$.ajax({url:_ele.data("href"),data:{id:_id},type:"post",success:function(data){data.status?location.reload():$.dialog.error(data.info)}})}),!1})}})}),define("home/manage/coupon/make",function(require,exports,module){require("component/select2/dist/css/select2.css"),require("component/select2/dist/js/select2.full.min"),Class({namespaceEle:$("#namespace"),submitEle:$(".btn-input[type=submit]"),formEle:$(".list-left form"),clearMakeEle:$(".btn-clear-make"),initial:function(){var self=this;this.namespaceEle.select2({placeholder:"所属用户",allowClear:!0,ajax:{url:"/autocomplete/user",data:function(params){return{search:params.term}},processResults:function(data){return{results:data}}},templateResult:function(repo){return repo.name},templateSelection:function(repo){return repo.name||repo.text}}),this.namespaceEle.data("selected")&&this.namespaceEle.val(function(){return $(this).data("selected")}).trigger("change"),this.submitEle.on("click",function(){if("生成中..."!==self.submitEle.text()){self.submitEle.text("生成中...");var data=self.formEle.serialize();return $.post(self.formEle.attr("action"),data,function(result){result.status?location.reload():(self.submitEle.text("生成"),alert(result.info))}),!1}}),this.clearMakeEle.on("click",function(){return"清理中..."!==self.clearMakeEle.text()?($.dialog.confirm("确定要清理吗? 清理后将不能下载",function(action){1===action&&(self.clearMakeEle.text("清理中..."),$.post(self.clearMakeEle.data("url"),null,function(result){result.status?location.reload():(self.clearMakeEle.text("清除历史"),alert(result.info))}))}),!1):void 0})}})}),define("home/manage/email",function(require,exports,module){var editor=require("common/module/editor");Class({emailContentEle:$("#emailContent"),emailFormEle:$("#emailForm"),initial:function(){this.getEditor(),this.emailFormEle.submitForm({onBefore:function(options){options.data.content=self.getEditor().getValue()},onAfter:function(data){data.status?$.dialog.success(data.info,function(){location.reload()}):"string"==typeof data.info&&$.dialog.error(data.info)}})},getEditor:function(){var self=this;return this._editor||(this._editor=editor(self.emailContentEle.find("textarea"),{items:"undo,redo,-,h1,h2,h3,h4,-,bold,italic,-,ul,ol,-,link,image,code,hr,blockquote,table,-,preview,fullscreen,help",uploader:{url:Config.get("uploadImageUrl")}})),this._editor}})}),define("home/manage/order/index",function(require,exports,module){require("component/select2/dist/css/select2.css"),require("component/select2/dist/js/select2.full.min"),Class({namespaceEle:$("#namespace"),manualListEle:$(".list-right"),initial:function(){this.namespaceEle.select2({placeholder:"所属用户",allowClear:!0,ajax:{url:"/autocomplete/user",data:function(params){return{search:params.term}},processResults:function(data){return{results:data}}},templateResult:function(repo){return repo.name},templateSelection:function(repo){return repo.name||repo.text}}),this.manualListEle.delegate(".pay","click",function(){var _ele=$(this),_id=$(this).data("id");return $.dialog.confirm("确定要设为已支付吗?",function(action){1===action&&$.ajax({url:_ele.data("href"),data:{id:_id},type:"post",success:function(result){"object"==typeof result?$.dialog.error(result.info):"success"==result&&location.reload()}})}),!1})}})}),define("home/manage/setting",function(require,exports,module){Class({settingFormEle:$("#settingForm"),initial:function(){this.settingFormEle.submitForm({autoValidate:!1,onAfter:function(data,options){data.status?$.dialog.success("修改成功"):"string"==typeof data.info&&$.dialog.error(data.info)}})}})}),define("home/manage/special/detail",function(require,exports,module){require("component/select2/dist/css/select2.css"),require("component/select2/dist/js/select2.full.min"),require("component/Sortable/jquery.fn.sortable.min"),Class({selectBookEle:$("#selectBook"),currentSpecialId:Config.get("specialId"),itemListEle:$(".list-right ul"),initial:function(){var self=this;this.selectBookEle.click(function(){var $html,dialog;$html=$("<div/>").addClass("m-manual-add").html('<form class="w-form form-horizon dialog-form" method="post"><div class="form-item"><span class="form-label">文档</span><div class="form-target"><label class="w-select select-m"><select class="select-input" name="item" multiple="multiple"></select></label></div></div></div>'),dialog=$.dialog.form($html,{title:"添加文档",onCreate:function(){var _form=this.bodyElement.find("form");_form.append($('<input type="hidden" name="special_id" value="'+self.currentSpecialId+'">')),_form.append($('<input type="hidden" name="type" value="1">')),_form.attr("action",Config.get("addItemUrl")),_form.find('[name="item"]').select2({placeholder:"选择文档",width:232,multiple:!0,ajax:{url:"/autocomplete/book",data:function(params){return{search:params.term}},processResults:function(data){return{results:data}}},templateResult:function(repo){return repo.id?$('<div style="overflow: hidden;"><img style="float: left;" width="40" src="'+repo.cover+'" /><span style="margin-left: 50px;font-style: normal;display: block;line-height: 1.5;">'+repo.title+"</span></div>"):repo.text},templateSelection:function(repo){return repo.title||repo.text}}),_form.submitForm({onBefore:function(options){var item=_form.find('[name="item"]').val();return item?void(options.data.item=item):($.dialog.error("请选择文档"),!1)},onAfter:function(data,options){data.status?window.location.reload():$.dialog.error(data.info)}})}})}),this.itemListEle.delegate(".item-delete","click",function(){var _ele=$(this),_id=$(this).data("id"),_type=$(this).data("type");return $.dialog.confirm("确定删除吗",function(action){1==action&&$.ajax({url:_ele.attr("href"),data:{special_id:self.currentSpecialId,id:_id,type:_type},type:"post",success:function(data){data.status?location.reload():$.dialog.error(data.info)}})}),!1}),this.itemListEle.sortable({group:$(this).data("type"),onUpdate:function(evt){var items=this.toArray();$.ajax({url:Config.get("sortItemUrl"),data:{item:items},type:"post",success:function(data){data.status?$.dialog.success(data.info):$.dialog.error(data.info)}})}})}})}),define("home/manage/special/index",function(require,exports,module){Class({manualListEle:$(".list-right"),initial:function(){this.manualListEle.delegate(".delete","click",function(){var _ele=$(this),_id=$(this).data("id");return $.dialog.confirm("确定删除吗",function(action){1==action&&$.ajax({url:_ele.data("href"),data:{special_id:_id},type:"post",success:function(data){data.status?location.reload():$.dialog.error(data.info)}})}),!1})}})}),define("home/manage/special/update",function(require,exports,module){Class({uploadCoverFormEle:$("#uploadCoverForm"),uploadCoverEle:$("#uploadCover"),manualInfoCoverEle:$(".m-manual-info .cover img"),uploadNumber:0,specialFormEle:$("#specialUpdateForm"),initial:function(){var self=this;this.specialFormEle.submitForm({autoValidate:!1,onAfter:function(data,options){data.status?($.dialog.success(data.info),data.url&&(window.location.href=data.url)):"string"==typeof data.info&&$.dialog.error(data.info)}}),this.uploadCoverEle.click(function(){self.cutImageDialog?self.cutImageDialog.open():(self.cutImageDialog=$.dialog('<div class="m-dialog-loading"><b class="loading-text">裁剪组件加载中...</b></div>',{title:"封面裁剪",cache:!0}),require.async("common/module/cutImage",function(cutImage){self.cutCover=new cutImage({cls:"m-cover-cutting",cutWidth:173,cutHeight:231,boxWidth:420,boxHeight:300,uploadUrl:Config.get("uploadCoverUrl"),saveCutUrl:Config.get("saveCoverUrl"),onSuccess:function(data){var _image=self.uploadCoverEle.find("img"),_input=self.uploadCoverEle.find("input"),_src=data.data.url.indexOf("?")>=0?data.data.url+"&v="+self.uploadNumber:data.data.url+"?v="+self.uploadNumber;self.cutImageDialog.close(),self.uploadNumber++,_image.length||(_image=$("<img/>"),self.uploadCoverEle.find(".upload-image").html(_image)),self.manualInfoCoverEle.attr("src",_src),_image.attr("src",_src),_input.val(data.data.url)}}),self.cutImageDialog.content(self.cutCover.getHtml()),self.cutImageDialog.offset(self.cutImageDialog._options.offset[0],self.cutImageDialog._options.offset[1])}))})}})}),define("home/manage/tag/index",function(require,exports,module){Class({manualListEle:$(".list-right"),initial:function(){this.manualListEle.delegate(".check","click",function(){var _ele=$(this),_id=$(this).data("id");return $.ajax({url:_ele.attr("href"),data:{id:_id,type:$(this).data("type")},type:"post",success:function(result){1==result.status?location.reload():$.dialog.error(result.info)}}),!1}),this.manualListEle.delegate(".recommend","click",function(){var _ele=$(this),_id=$(this).data("id"),recommend=$(this).data("recommend");return $.ajax({url:_ele.attr("href"),data:{id:_id,recommend:recommend},type:"post",success:function(result){1==result.status?location.reload():$.dialog.error(result.info)}}),!1})}})}),define("home/manage/team/edit",function(require,exports,module){Class({teamFormEle:$("#teamForm"),initial:function(){this.teamFormEle.submitForm({autoValidate:!1,onAfter:function(data,options){data.status?$.dialog.success("修改成功"):"string"==typeof data.info&&$.dialog.error(data.info)}})}})}),define("home/manage/template",function(require,exports,module){require("component/select2/dist/css/select2.css"),require("component/select2/dist/js/select2.full.min"),Class({namespaceEle:$("#namespace"),manualListEle:$(".template_content"),uploadCoverFormEle:$("#uploadCoverForm"),uploadCoverEle:$("#uploadCover"),manualInfoCoverEle:$("#templatePreview img"),initial:function(){var self=this;this.namespaceEle.select2({placeholder:"所属用户",allowClear:!0,ajax:{url:"/admin/user/search",data:function(params){return{nickname:params.term}},processResults:function(data){return{results:data.info}}},templateResult:function(repo){return repo.nickname},templateSelection:function(repo){return repo.nickname||repo.text}}),this.uploadCoverEle.click(function(){self.cutImageDialog?self.cutImageDialog.open():(self.cutImageDialog=$.dialog('<div class="m-dialog-loading"><b class="loading-text">裁剪组件加载中...</b></div>',{title:"封面裁剪",cache:!0}),require.async("common/module/cutImage",function(cutImage){self.cutCover=new cutImage({cls:"m-cover-cutting",cutWidth:175,cutHeight:130,boxWidth:525,boxHeight:393,uploadUrl:Config.get("uploadCoverUrl"),uploadParam:{template_id:Config.get("templateId"),title:Config.get("templateTitle")},saveCutUrl:Config.get("saveCoverUrl"),saveCutParam:{template_id:Config.get("templateId"),title:Config.get("templateTitle")},onSuccess:function(data){var _image=self.uploadCoverEle.find("img"),_src=data.data.url.indexOf("?")>=0?data.data.url+"&t="+self.uploadNumber:data.data.url+"?t="+self.uploadNumber;
self.cutImageDialog.close(),self.uploadNumber++,_image.length||(_image=$("<img/>"),self.uploadCoverEle.find(".upload-image").html(_image)),self.manualInfoCoverEle.attr("src",_src),_image.attr("src",_src)}}),self.cutImageDialog.content(self.cutCover.getHtml()),self.cutImageDialog.offset(self.cutImageDialog._options.offset[0],self.cutImageDialog._options.offset[1])}))}),this.manualListEle.delegate(".delete","click",function(){var _ele=$(this),_id=$(this).data("id"),_tips=$(this).data("tips");return $.dialog.confirm(_tips,function(action){1==action&&$.ajax({url:_ele.data("href"),data:{id:_id},type:"post",success:function(data){data.status?location.href=data.url:$.dialog.error(data.info)}})}),!1})}})}),define("home/manage/user/detail",function(require,exports,module){require("component/semantic-ui-tab/tab.min"),Class({tabEle:$(".nav-tabs .navg-item"),initial:function(){this.tabEle.tab({selector:{tabs:".tab-content"}})}})}),define("home/manage/user/edit",function(require,exports,module){Class({userFormEle:$("#userForm"),initial:function(){var self=this;this.userFormEle.submitForm({autoValidate:!1,onBefore:function(data,options){data.data.is_admin=self.userFormEle.find('[name="is_admin"]').is(":checked")?1:0},onAfter:function(data,options){data.status?$.dialog.success("修改成功"):"string"==typeof data.info&&$.dialog.error(data.info)}})}})}),define("home/manage/withdrawals/index",function(require,exports,module){Class({initial:function(){$(".btn-withdrawals").on("click",function(){var self=$(this);$.dialog.confirm("确定完成?",function(action){1==action&&$.post(self.data("href"),{id:self.data("id")},function(){$.dialog.success("设置成功"),setTimeout(function(){location.reload()},2e3)})})})}})}),define("home/order/buy",function(require,exports,module){return require("component/jquery.spinner"),Class({initial:function(){var self=this;this.buyFormEle=$("#buyForm"),this.selectMonthEle=$("#selectMonth"),this.selectMonthCycleEle=$("#selectMonthCycle"),this.selectPriceEle=$("#selectPrice"),this.serverDate=Util.getDate(1e3*Config.get("buyStartTime")),this.buyPrice=Config.get("buyPrice"),this.startDate=Util.formartDate(this.serverDate,"yyyy-MM-dd"),this.endDate=this.serverDate,this.endTime=this.endDate.getTime(),this.endMonth=this.endDate.getMonth(),this.buyFormEle.submit(function(){$.dialog.confirm("确定支付已完成？",function(action){1==action&&location.reload()})}),this.selectMonthEle.spinner({minValue:1,maxValue:Number(Config.get("buyMonth")),onChange:function(){var _value=Number(this.value());self.countDate(_value),self.countPrice(_value)},onCreate:function(){this.options.onChange.call(this)}})},countDate:function(month){this.endDate.setTime(this.endTime),this.endDate.setMonth(this.endMonth+month),this.selectMonthCycleEle.html("从"+this.startDate+"开始到"+Util.formartDate(this.endDate,"yyyy-MM-dd")+"截止")},countPrice:function(month){this.selectPriceEle.val((this.buyPrice*month).toFixed(2))},instantiation:!1})}),define("home/order/index",function(require,exports,module){Class({orderListEle:$("#orderList"),initial:function(){this.orderListEle.delegate(".pay","click",function(){return $(this).hasClass("disabled")?!1:void $.dialog.confirm("确定支付已完成？",function(action){1==action&&location.reload()})}),this.orderListEle.delegate(".cancel","click",function(){var ele=$(this);return $(this).hasClass("disabled")||$.dialog.confirm("确定取消订单吗？",function(action){1==action&&($.dialog.loading("操作中..."),$.ajax({url:ele.attr("href"),type:"post",success:function(data){data.status?location.reload():$.dialog.error(data.info)},complete:function(){$.dialog.get("loading").close()}}))}),!1}),this.orderListEle.delegate(".delete","click",function(){var ele=$(this);return $(this).hasClass("disabled")||$.dialog.confirm("确定删除订单吗？",function(action){1==action&&($.dialog.loading("操作中..."),$.ajax({url:ele.attr("href"),type:"post",success:function(data){data.status?location.reload():$.dialog.error(data.info)},complete:function(){$.dialog.get("loading").close()}}))}),!1})}})}),define("home/setting/info",function(require,exports,module){require("common/extend/validator/validator"),require("component/jquery.form"),Class({uploadCoverEle:$("#uploadAvatar"),userInfoAvatarEle:$(".m-manual-info .avatar img"),userInfoFormEle:$("#userInfoForm"),uploadNumber:0,initial:function(){var self=this;this.uploadCoverEle.click(function(){self.cutImageDialog?self.cutImageDialog.open():(self.cutImageDialog=$.dialog('<div class="m-dialog-loading"><b class="loading-text">裁剪组件加载中...</b></div>',{title:"头像裁剪",cache:!0}),require.async("common/module/cutImage",function(cutImage){self.cutCover=new cutImage({cls:"m-cover-cutting",cutWidth:150,cutHeight:150,boxWidth:420,boxHeight:300,uploadUrl:Config.get("uploadAvatarUrl"),saveCutUrl:Config.get("saveAvatarUrl"),onSuccess:function(data){var _image=self.uploadCoverEle.find("img"),_src=data.data.url.indexOf("?")>=0?data.data.url+"&v="+self.uploadNumber:data.data.url+"?v="+self.uploadNumber;self.cutImageDialog.close(),self.uploadNumber++,_image.length||(_image=$("<img/>"),self.uploadCoverEle.find(".upload-image").html(_image)),self.userInfoAvatarEle.attr("src",_src),_image.attr("src",_src)}}),self.cutImageDialog.content(self.cutCover.getHtml()),self.cutImageDialog.offset(self.cutImageDialog._options.offset[0],self.cutImageDialog._options.offset[1])}))}),this.userInfoFormEle.submitForm({autoValidate:!1,onAfter:function(data){data.status?$.dialog.success(data.info):$.dialog.error(data.info)}})}})}),define("home/setting/kindle",function(require,exports,module){Class({initial:function(){$("#kindleForm").submitForm({autoValidate:!1,onAfter:function(data){data.status?$.dialog.success(data.info,function(){window.location.reload()}):"string"==typeof data.info&&$.dialog.error(data.info)}})}})}),define("home/setting/oauth",function(require,exports,module){Class({oauthListEle:$(".m-oauth-list"),initial:function(){this.oauthListEle.delegate(".oauth-cancel","click",function(){var _ele=$(this),_type=$(this).data("type");return $.dialog.confirm("确定取消绑定吗？",function(action){1==action&&$.ajax({url:_ele.data("href"),data:{type:_type},type:"post",success:function(data){data.status?location.reload():$.dialog.error(data.info)}})}),!1})}})}),define("home/setting/security",function(require,exports,module){Class({securityFormEle:$("#securityForm"),initial:function(){this.securityFormEle.submitForm({autoValidate:!1,onAfter:function(data){data.status?$.dialog.success(data.info,function(){window.location.reload()}):"string"==typeof data.info&&$.dialog.error(data.info)}})}})}),define("home/space/centre/index",function(require,exports,module){require("component/semantic-ui-tab/tab.min"),Class({tabEle:$(".nav-tabs .navg-item"),initial:function(){this.tabEle.tab({selector:{tabs:".tab-content"}})}})}),define("home/special/index",function(require,exports,module){var Sharing=require("common/module/sharing");return Class({initial:function(){new Sharing({cover:Config.get("sharePicUrl"),url:location.href,title:Config.get("shareTitle"),summary:Config.get("shareContent")})}})}),define("home/tag/detail",function(require,exports,module){var Sharing=require("common/module/sharing");return Class({initial:function(){new Sharing({cover:Config.get("sharePicUrl"),url:location.href,title:"给你推荐的看云 [ "+Config.get("shareTitle")+" ] 专题文档列表",summary:Config.get("shareContent")})}})}),define("home/tag/index",function(require,exports,module){return require("component/jqcloud/jqcloud-1.0.4.min"),require("component/jqcloud/jqcloud.css"),Class({initial:function(){$(".tag-cate").empty(),$(".tag-cate").jQCloud(Config.get("words")),$(".tag-cate").css("visibility","visible")}})}),define("home/team/create",function(require,exports,module){return require("component/dialog/jquery.dialog"),Class({initial:function(){$(".team-creator").click(function(){$.dialog.open("/team/create",{title:"创建团队",style:"think-dialog think-dialog-load",onComplete:function(){var $form=this.bodyElement.find("form");$form.submitForm({autoValidate:!1,onAfter:function(data,options){data.status?data.url&&location.replace(data.url):"string"==typeof data.info&&$.dialog.error(data.info)}}),$form.data("submitButton",this.okBtn)},onOk:function(){this.bodyElement.find("form").submit()}})})}})}),define("home/team/index",function(require,exports,module){}),define("home/team/member",function(require,exports,module){return require("component/select2/dist/css/select2.css"),require("component/select2/dist/js/select2.full.min"),Class({selectMemberEle:$("#selectMember"),currentTeamId:Config.get("currentTeam"),memberListEle:$("#memberList"),initial:function(){var self=this;this.selectMemberEle.click(function(){var $html,dialog;$html=$("<div/>").addClass("m-manual-add").html('<form class="w-form form-horizon dialog-form" method="post"><div class="form-item"><span class="form-label">用户</span><div class="form-target"><label class="w-select select-m"><select class="select-input" name="user" multiple="multiple"></select></label></div></div><div class="form-item"><span class="form-label">角色</span><div class="form-target"><label class="w-select select-m"><select class="select-input" name="role"></select></label></div></div></div>'),dialog=$.dialog.form($html,{title:"添加成员",onCreate:function(){var _form=this.bodyElement.find("form");_form.append($('<input type="hidden" name="team_id" value="'+self.currentTeamId+'">')),_form.attr("action",Config.get("createUserUrl")),_form.find('[name="role"]').append(function(){var options="";return $.each(Config.get("accessRoles"),function(k,v){options+="<option value='"+v+"'>"+k+"</option>"}),options}),_form.find('[name="user"]').select2({placeholder:"选择用户",width:232,multiple:!0,ajax:{url:"/team/member/user",data:function(params){return{search:params.term,team_id:self.currentTeamId}},processResults:function(data){return{results:data}}},templateResult:function(state){return state.id?$('<div style="line-height: 20px;white-space:nowrap;overflow: hidden;text-overflow: ellipsis; font-weight: bold;"><img style="border-radius: 3px;" src="'+state.avatar+'" width="20" height="20" /> '+state.username+' <span style="font-weight: normal;">'+state.name+"</span></div>"):state.text},templateSelection:function(state){return state.name||state.text}}),_form.submitForm({onBefore:function(options){var user=_form.find('[name="user"]').val();return user?void(options.data.user=user):($.dialog.error("请选择用户"),!1)},onAfter:function(data,options){data.status?window.location.reload():$.dialog.error(data.info)}})}})}),this.memberListEle.delegate(".delete","click",function(){var _id=$(this).closest(".m-member-item").data("id"),$this=$(this);$.dialog.confirm("确定要删除该用户吗？",function(action){1==action&&$.ajax({url:Config.get("delMemberPath"),data:{id:_id,team_id:self.currentTeamId},context:this,type:"post",success:function(data){data.status?$this.closest(".m-member-item").remove():$.dialog.error(data.info)}})})}),this.memberListEle.delegate(".leave","click",function(){$.dialog.confirm("确定要退出吗？",function(action){1==action&&$.ajax({url:Config.get("leaveUserUrl"),data:{team_id:self.currentTeamId},context:this,type:"post",success:function(data){data.status?window.location.href="/user/team":$.dialog.error(data.info)}})})}),this.memberListEle.delegate(".role>select","change",function(){var _id=$(this).closest(".m-member-item").data("id");$.ajax({url:Config.get("setMemberRolePath"),data:{id:_id,role:$(this).val(),team_id:self.currentTeamId},context:this,type:"post",success:function(data){data.status?$.dialog.success(data.info):$.dialog.error(data.info)}})})}})}),define("home/team/setting",function(require,exports,module){return require("common/extend/validator/validator"),require("component/jquery.form"),Class({uploadCoverEle:$("#uploadAvatar"),teamAvatarEle:$(".m-manual-info .avatar img"),teamFormEle:$("#teamForm"),uploadNumber:0,teamId:Config.get("teamId"),initial:function(){var self=this;this.uploadCoverEle.click(function(){self.cutImageDialog?self.cutImageDialog.open():(self.cutImageDialog=$.dialog('<div class="m-dialog-loading"><b class="loading-text">裁剪组件加载中...</b></div>',{title:"封面裁剪",cache:!0}),require.async("common/module/cutImage",function(cutImage){self.cutCover=new cutImage({cls:"m-cover-cutting",cutWidth:173,cutHeight:173,boxWidth:420,boxHeight:300,uploadUrl:Config.get("uploadAvatarUrl"),uploadParam:{team_id:Config.get("teamId")},saveCutUrl:Config.get("saveAvatarUrl"),saveCutParam:{team_id:Config.get("teamId")},onSuccess:function(data){var _image=self.uploadCoverEle.find("img"),_src=data.data.url.indexOf("?")>=0?data.data.url+"&v="+self.uploadNumber:data.data.url+"?t="+self.uploadNumber;self.cutImageDialog.close(),self.uploadNumber++,_image.length||(_image=$("<img/>"),self.uploadCoverEle.find(".upload-image").html(_image)),self.teamAvatarEle.attr("src",_src),_image.attr("src",_src)}}),self.cutImageDialog.content(self.cutCover.getHtml()),self.cutImageDialog.offset(self.cutImageDialog._options.offset[0],self.cutImageDialog._options.offset[1])}))}),this.teamFormEle.submitForm({autoValidate:!1,onAfter:function(data){data.status?$.dialog.success(data.info):$.dialog.error(data.info)}}),$("#teamDelete").click(function(){return $.dialog.confirm("确定删除吗",function(action){1==action&&$.ajax({url:"/team/setting/delete",data:{team_id:Config.get("teamId")},type:"post",success:function(data){data.status?location.href=data.url:$.dialog.error(data.info)}})}),!1})}})}),define("home/topic/detail",function(require,exports,module){var Comment=require("common/module/comment"),Sharing=require("common/module/sharing");Class({commentEle:$("#comment"),manualListEle:$("#manualList"),initial:function(){this.comment=new Comment({wrapEle:this.commentEle,postParam:{book_id:Config.get("bookId")},delParam:{book_id:Config.get("bookId"),doc_id:Config.get("articleId")},votePath:Config.get("commentVotePath"),onePath:Config.get("commentOnePath"),listPath:Config.get("commentListPath"),delPath:Config.get("commentDelPath"),addPath:Config.get("commentAddPath"),onCreate:function(){this.articleIdHiddenEle=$('<input type="hidden" name="doc_id" value="'+Config.get("articleId")+'" />'),this.postEnterEle.after(this.articleIdHiddenEle)}});var hash=location.hash.substr(1),_hashSplit=null;hash&&hash.indexOf("-")>=0&&(_hashSplit=hash.split("-")),_hashSplit&&"comment"==_hashSplit[0]&&_hashSplit[1]?this.comment.loadOne({id:_hashSplit[1],doc_id:0,book_id:0},function(data){this.assignList({doc_id:Config.get("articleId"),book_id:0},function(){data.status&&this.addItem(data.data,!0,!1)}),Util.scrollTop(this.listEle,-120)}):this.comment.assignList({doc_id:Config.get("articleId"),book_id:0}),this.manualListEle.delegate("a[class$='topic_op_status']","click",function(){var _ele=$(this),_id=$(this).data("id"),_opstatus=$(this).data("opstatus"),_tips=$(this).data("tips");return $.dialog.confirm(_tips,function(action){1==action&&$.ajax({url:_ele.data("href"),data:{id:_id,op_status:_opstatus},type:"post",success:function(data){data.status?location.reload():$.dialog.error(data.info)}})}),!1}),this.manualListEle.delegate("a[class$='e-operate']","click",function(){var _ele=$(this),_id=$(this).data("id"),_tips=$(this).data("tips");return $.dialog.confirm(_tips,function(action){1==action&&$.ajax({url:_ele.data("href"),data:{id:_id},type:"post",success:function(data){data.status?location.href=data.url:$.dialog.error(data.info)}})}),!1}),new Sharing({cover:Config.get("sharePicUrl"),url:location.href,title:Config.get("shareTitle"),summary:""})}})}),define("home/topic/send",function(require,exports,module){var editor=require("common/module/editor");Class({suggestContentEle:$("#suggestContent"),suggestFormEle:$("#suggestForm"),initial:function(){var self=this;this.getEditor(),this.suggestFormEle.submitForm({onBefore:function(options){options.data.content=self.getEditor().getValue()},onAfter:function(data){data.status?$.dialog.success(data.info,function(){data.url?location.href=data.url:location.reload()}):"string"==typeof data.info&&$.dialog.error(data.info)}})},getEditor:function(){var self=this;return this._editor||(self.suggestContentEle.addClass("editor"),this._editor=editor(self.suggestContentEle.find("textarea"),{items:"undo,redo,-,h1,h2,h3,h4,-,bold,italic,-,ul,ol,-,link,image,code,hr,blockquote,table,htmlpaste,-,preview,fullscreen,help",uploader:{url:Config.get("uploadImageUrl")},tools:{htmlpaste:{exec:function(){var editor=this;require.async("component/to-markdown/dist/to-markdown",function(){var $text,$iframe,$html,doc,dialog,ie=navigator.userAgent.toLowerCase().indexOf("msie")>-1&&-1==navigator.userAgent.toLowerCase().indexOf("opera");$text=$("<p />").text("请使用快捷键(Ctrl+V)把内容粘贴到下面的方框里。"),$iframe=$('<iframe frameborder="0" style="width:600px;height:260px;padding: 5px;"></iframe>'),$html=$("<div/>").addClass("thinkeditor-plugin-htmlpaste").append($text).append($iframe),dialog=$.dialog.open($html,{title:"从HTML粘贴",onCancel:function(){},onOk:function(){var str=doc.body.innerHTML;str=str.replace(/~/g,"~T"),str=str.replace(/`/g,"~E"),str=str.replace(/\$/g,"~D"),str=toMarkdown(str,{gfm:!0});var cnum=0,arrcode=[];str=str.replace(/~~~([\s\S]*?)~~~/g,function(all){return cnum++,arrcode[cnum]=all,"[	codeplace_"+cnum+"	]"}),str=str.replace(/(`+)([^\r]*?[^`])\1(?!`)/g,function(wholeMatch,m1,m2,m3){return cnum++,arrcode[cnum]=wholeMatch,"[	codeplace_"+cnum+"	]"}),str=str.replace(/<\/?.+?>/g,""),str=str.replace(/\n{2,}/g,"\n\n");for(var i=1;cnum>=i;i++)str=str.replace("[	codeplace_"+i+"	]",function(){return arrcode[i]});str=str.replace(/~D/g,"$$"),str=str.replace(/~E/g,"`"),str=str.replace(/~T/g,"~"),editor.insert(str),dialog.close()}}),doc=$iframe[0].contentDocument||$iframe[0].contentWindow.document,ie||(doc.designMode="on"),doc.open(),doc.write('<!doctype html><html style="height:100%;"><head><title>WordPaste</title></head>'),doc.write('<body style="background-color:#ffffff;font-size:12px;padding:0px;margin:0px;height: 100%;">'),ie||doc.write("<br />"),doc.write("</body></html>"),doc.close(),ie&&(doc.body.contentEditable="true"),$iframe[0].contentWindow.focus()})},markdown:!0}}})),this._editor}})}),define("home/user/coin",function(require,exports,module){require("component/infinite-ajax-scroll/dist/jquery-ias.min"),Class({initial:function(){var self=this;$("#btn-withdrawals").on("click",function(){var postUrl=Config.get("postUrl"),userCoin=Config.get("userCoin"),minCoin=Config.get("minCoin"),banks=Config.get("banks"),bankType=Config.get("bankType"),bankAccount=Config.get("bankAccount"),trueName=Config.get("trueName"),$form=self.createWithdrawalsForm();$.dialog.form($form,{title:"提现申请",onCreate:function(){var _form=$form.find("form");_form.attr("action",postUrl);var userPriceEle=$form.find(".user-price"),inputPriceEle=$form.find("[name=price]");userCoin>minCoin?(userPriceEle.html("￥"+userCoin/100),inputPriceEle.val(userCoin/100)):(userPriceEle.html("￥"+userCoin/100+' （<span style=" color: red">不足￥'+minCoin/100+"不能提现</span>）"),inputPriceEle.val(0));for(var i in banks)$form.find("[name=bank_type]").append('<option value="'+banks[i].value+'">'+banks[i].text+"</option>");$form.find("[name=bank_type]").val(bankType),$form.find("[name=bank_account]").val(bankAccount),$form.find("[name=true_name]").val(trueName),_form.submitForm({onBefore:function(options){return 100*inputPriceEle.val()>userCoin?($.dialog.error("你输入的金额大于你的云币总数"),!1):void 0},onAfter:function(data,options){data.status?($.dialog.success("申请成功, 我们会尽快打款到你指定的帐号"),setTimeout(function(){window.location.reload()},3e3)):$.dialog.error(data.info)}})}})});var ias=jQuery.ias({container:".m-history-list",item:".m-history-item",pagination:".m-paging",next:".m-paging .next"});ias.extension(new IASSpinnerExtension),ias.extension(new IASTriggerExtension({offset:3,text:"点击加载更多"})),ias.extension(new IASNoneLeftExtension({text:"没有更多了"}))},createWithdrawalsForm:function(){return $("<div/>").addClass("withdrawals").html('<form class="w-form form-horizon dialog-form" method="post"><div class="form-item"><span class="form-label">可提现金额</span><div class="form-target" style=" line-height: 22px; padding:6px 0px;"><span class="user-price">$100</span></div></div><div class="form-item"><span class="form-label">提现金额</span><div class="form-target"><label class="w-text text-m"><input class="text-input" type="number" style="width: 100px;" name="price" /></label></div></div><div class="form-item"><span class="form-label">收款账户类型</span><div class="form-target"><label class="w-select select-m"><select class="select-input" name="bank_type"></select></label></div></div><div class="form-item"><span class="form-label">收款账户名</span><div class="form-target"><label class="w-text text-m"><input class="text-input" type="text" style="width: 180px;" name="bank_account" /></label></div></div><div class="form-item"><span class="form-label">收款人</span><div class="form-target"><label class="w-text text-m"><input class="text-input" type="text" style="width: 100px;" name="true_name" /></label></div></div><div class="form-item" style="margin-bottom: 0px"><a href="http://help.kancloud.cn/113596" target="_blank">提现须知</a></div></form>')}})}),define("home/user/enterprise",function(require,exports,module){var Order=require("common/module/order");return Class({initial:function(){$(".enterprise-upgrade").click(function(){new Order({title:"欢迎使用企业版",type:"EnterpriseProduct",infoTpl:['<div class="form-item">','<span class="form-label">购买时长：</span>','<div class="form-target">','<label class="w-radio radio-vertical">','<input class="radio-input" type="radio" data-price="6000" name="year" value="1" checked="checked" />','<span class="radio-text">1年 ￥6000元</span>',"</label>","</div>","</div>"].join(""),coupon:!0,coin:Config.get("userCoin"),price:function(){return parseInt(100*this.wrapEle.find("[name=year]:checked").data("price"))},data:function(){return{year:parseInt(this.wrapEle.find("[name=year]:checked").val()),name:Config.get("namespace")}},onInit:function(){var self=this;this.wrapEle.find("[name=year]").click(function(){self.freshPrice()}),this.wrapEle.find("[name=year]").change(function(){self.freshPrice()})},onSuccess:function(){location.reload()}})})}})}),define("home/user/notification",function(require,exports,module){Class({notificationListEle:$("#notificationList"),readAllEle:$("#readAll"),removeAllEle:$("#removeAll"),initial:function(){this.notificationListEle.on("click","dl",function(){var id=$(this).data("id"),$this=$(this);$.post(Config.get("readUrl"),{id:id}).done(function(){$this.removeClass("unread")})}),this.readAllEle.click(function(){$.post(Config.get("readUrl")).done(function(){location.reload()})}),this.removeAllEle.click(function(){$.dialog.confirm("确定要清空吗",function(action){1==action&&$.post(Config.get("removeUrl")).done(function(){location.reload()})})})}})}),define("home/user/profession",function(require,exports,module){var Order=require("common/module/order");return Class({initial:function(){$(".profession-upgrade").click(function(){new Order({title:"欢迎使用专业版",type:"ProfessionProduct",infoTpl:['<div class="form-item">','<span class="form-label">购买时长：</span>','<div class="form-target">','<label class="w-radio radio-vertical">','<input class="radio-input" type="radio" data-price="36" name="month" value="1" checked="checked" />','<span class="radio-text">1个月 ￥36元</span>',"</label>",'<label class="w-radio radio-vertical">','<input class="radio-input" type="radio" data-price="108" name="month" value="3" />','<span class="radio-text">3个月 ￥108元</span>',"</label>",'<label class="w-radio radio-vertical">','<input class="radio-input" type="radio" data-price="216" name="month" value="6" />','<span class="radio-text">6个月 ￥216元</span>',"</label>",'<label class="w-radio radio-vertical">','<input class="radio-input" type="radio" data-price="360" name="month" value="12" />','<span class="radio-text">1年 ￥360元 <del>￥432元</del></span>',"</label>","</div>","</div>"].join(""),coupon:!0,coin:Config.get("userCoin"),price:function(){return parseInt(100*this.wrapEle.find("[name=month]:checked").data("price"))},data:function(){return{month:parseInt(this.wrapEle.find("[name=month]:checked").val()),name:Config.get("namespace")}},onInit:function(){var self=this;this.wrapEle.find("[name=month]").click(function(){self.freshPrice()}),this.wrapEle.find("[name=month]").change(function(){self.freshPrice()})},onSuccess:function(){location.reload()}})})}})}),define("common/extend/bootstrap/bootstrap",function(require,exports,module){!function(){var Button=$.fn.button.Constructor;$.extend(Button.prototype,{disabled:function(status){return this.isDisabled="undefined"==typeof status?!0:status,this.$element.attr("disabled",this.isDisabled),this},initialed:function(){var _self=this;this.$element.click(function(event){_self.isDisabled&&event.stopImmediatePropagation()})}}),$.fn.button=function(option){var args=arguments;return this.each(function(){var $this=$(this),data=$this.data("bs.button"),options="object"==typeof option&&option;data||($this.data("bs.button",data=new Button(this,options)),$.isFunction(data.initialed)&&data.initialed.call(data)),"toggle"==option?data.toggle():"disabled"==option?data.disabled.apply(data,Array.prototype.slice.call(args,1)):option&&data.setState(option)})}}()}),define("common/extend/dialog/dialog",function(require,exports,module){require("component/dialog/jquery.dialog"),require("common/extend/validator/validator"),function(){$.extend($.dialog,{form:function(url,options){var _options=options||{},_praseData=_options.praseData,_onCreate=(_options.onBefore,_options.onAfter,_options.onCreate);_options=$.extend({drag:!1},_options);var _cancelBtn=function(){var _self=this;return _self.cancelBtn=$('<label class="w-btn btn-default btn-m"><button class="btn-input">取消</button></label>'),_self.cancelBtn.click(function(){_self.close()}),_self.cancelBtn},_defineBtn=function(){var _self=this;return _self.defineBtn=$('<label class="w-btn btn-success btn-m"><button class="btn-input">确定</button></label>'),_self.defineBtn.click(function(){_self.formEle.submit()}),_self.defineBtn};return"string"!=typeof url?(_options.button=[_defineBtn,_cancelBtn],_options.onCreate=function(){var _content=this.content();_content.data("dialog",this),this.formEle=_content.find(".dialog-form"),this.formEle.data("submitButton",this.defineBtn),$.isFunction(_onCreate)&&_onCreate.call(this)},$.dialog(url,_options)):(_options.praseData=function(data){var data=$.isFunction(_praseData)?_praseData.call(this,data):data;return data===!1?!1:(data=$(data),this.setButton([_defineBtn,_cancelBtn]),data.data("dialog",this),this.formEle=data.find("form"),this.formEle.data("submitButton",this.defineBtn),data)},$.dialog.load(url,_options))},open:function(url,options){options=options||{};var cancelBtn=function(){var _self=this;return _self.cancelBtn=$('<label class="w-btn btn-default btn-m"><button class="btn-input">取消</button></label>'),_self.cancelBtn.click(function(){_self.close(),$.isFunction(options.onCancel)?options.onCancel.call(this):""}),_self.cancelBtn},okBtn=function(){var _self=this;return _self.okBtn=$('<label class="w-btn btn-success btn-m"><button class="btn-input">确定</button></label>'),_self.okBtn.click(function(){$.isFunction(options.onOk)?options.onOk.call(_self):""}),_self.okBtn};if("string"!=typeof url)return options.button=[okBtn,cancelBtn],options.content=url,$.dialog(options);var praseData=options.praseData;return options.praseData=function(data){return data=$.isFunction(praseData)?praseData.call(this,data):data,data===!1?!1:(data=$(data),this.setButton([okBtn,cancelBtn]),data)},$.dialog.load(url,options)}})}()}),define("common/extend/showdown/xss",function(require,exports,module){var xss=require("component/xss/dist/xss");return[{type:"output",filter:function(html){if(xss){var options={whiteList:$.extend(xss.whiteList,{form:["method","action"],input:["type","value","disabled","name"],label:[],slide:["class","style"],hgroup:[]}),onIgnoreTagAttr:function(tag,name,value,isWhiteAttr){return"id"===name||"data-"===name.substr(0,5)||"aria-"===name.substr(0,5)||"class"===name||"style"===name?name+'="'+xss.escapeAttrValue(value)+'"':void 0}};return xss(html,options)}return html}}]}),define("common/extend/template",function(require,exports,module){var Cache=require("common/library/cache"),Template=require("component/template/template");return Template.setData=function(data){Cache.set("TEMPLATE_DATA",$.extend({},Cache.get("TEMPLATE_DATA"),data))},Template.getTemp=function(temp,callback){var _type=$.type(temp),_temp="";if("object"==_type)_temp=$(temp).html(),$.isFunction(callback)&&callback(_temp);else if(Util.isUrl(temp)){var _data=temp.split("#");_temp=Cache.get(_data[0]),_temp?_data[1]&&(_temp=$(_temp).filter("#"+_data[1]).html(),$.isFunction(callback)&&callback(_temp)):Util.ajax({url:_data[0],dataType:"html",success:function(data){_temp=data||"",data&&_data[1]&&(_temp=$(data).filter("#"+_data[1]).html()),Cache.set(_data[0],data),$.isFunction(callback)&&callback(_temp)}})}else _temp=String(temp),$.isFunction(callback)&&callback(_temp)},Template.delData=function(name){var _cacheData=Cache.get("TEMPLATE_DATA");name in _cacheData&&delete _cacheData[name]},Template.parseTemp=function(temp,data,name){return Template.compile(temp)($.extend({},data,Cache.get("TEMPLATE_DATA")),name)},Template}),define("common/extend/validator/validator",function(require,exports,module){function serializeObject(form){var _object={};if("FORM"==form.nodeName)for(var _value=$(form).serializeArray(),i=0;i<_value.length;i++)_object[_value[i].name]=_value[i].value;return _object}require("component/jquery-plugs/jquery.validator"),require("component/jquery.form"),$.fn.clearValidate=function(){$(this).find("[name]").each(function(){element=$(this);var _group=element.closest(".form-item"),_msg=_group.find(".field-msg");_group.removeClass("has-error has-success"),_msg.html(_msg.data("defalut-msg"))})},$.fn.submitForm=function(options){function check(element,form){var _name=(element.closest(".form-item"),element.attr("name")),_items=this.getItem(_name),_join=["[name="+_name+"]"];$.each(_items,function(){if(this.must||fetchDefatul(element),$.isArray(this.join))for(var i=0;i<this.join.length;i++)_join.push("[name="+this.join[i]+"]")}),_join=_join.join(","),this.check(form.serializeArray(),_items)}function fetchError(element,message){var _group=element.closest(".form-item"),_msg=_group.find(".field-msg");_msg.length||(_msg=$('<span class="field-msg"></span>'),_group.find("[name]").after(_msg)),_group.addClass("has-error").removeClass("has-success"),"undefined"==typeof _msg.data("defalut-msg")&&_msg.attr("data-defalut-msg",_msg.html()),_msg.html(message||this.msg)}function fetchDefatul(element){if(element){var _group=element.closest(".form-item"),_msg=_group.find(".field-msg");_group.removeClass("has-error has-success"),_msg.html(_msg.data("defalut-msg"))}}function _activeForm(){_form.removeClass("form-posting"),_options.handler.each(function(){var _text=$(this).data("text"),_parent=$(this).closest(".w-btn");_parent.length||(_parent=$(this));var _btn=_parent.find("input,button");_btn.length?_btn.val(_text):(_btn=_parent,_btn.html(_text)),_btn.prop("disabled",!1),_parent.removeClass("btn-loading")})}function _disabledForm(){_form.addClass("form-posting"),_options.handler.each(function(){var _parent=$(this).closest(".w-btn");_parent.length||(_parent=$(this));var _btn=_parent.find("input,button");_btn.length?_btn.val("提交中"):(_btn=_parent,_btn.text("提交中")),_btn.prop("disabled",!0),_parent.addClass("btn-loading")})}var _form=$(this),_options=$.extend({validate:null,autoValidate:!1,type:"post",handler:_form.find(":submit"),controlPoint:null,onBefore:null,onAfter:null,loadingTpl:'<span class="form-loading">提交中...</span>'},options),_origValue=_form.serializeArray(),_onComplete=(_origValue.length,_options.complete),_validator=$.validator({map:_options.validate,onAfter:function(status,data){var _element=$("[name="+this.name+"]");status===!0||fetchError.call(this,_element)},onCreate:function(){var _validator=this,_activeElement=!1;_form.find("[name]").click(function(event){_activeElement=$(this),fetchDefatul(_activeElement),
_options.autoValidate&&"INPUT"==this.nodeName&&"checkbox"==this.type&&check.call(_validator,_activeElement,_form),event.stopPropagation()}).keyup(function(){fetchDefatul($(this))}).closest("label").click(function(event){event.stopPropagation()}),$(document).bind("click",function(){_activeElement&&_options.autoValidate&&check.call(_validator,_activeElement,_form),_activeElement=!1})}});_options.url=_options.url||$(this).attr("action"),_options.type=_options.type||$(this).attr("method")||"POST",_options.beforeSend=function(){var _data=_form.serializeArray(),_status=_validator.check(_data);return _options.handler=_form.data("submitButton")?_form.data("submitButton"):_options.handler,_options.handler.each(function(){var _btn=$(this).find("input,button");_btn.length?$(this).data("text",_btn.val()||_btn.text()):$(this).data("text",$(this).html()||$(this).val())}),_status&&_disabledForm(),_status},_options.complete=function(){_activeForm(),$.isFunction(_onComplete)&&_onComplete.call(this)},_options.success=function(data){if(!data.status&&$.isPlainObject(data)){var _first=null,_number=0;for(var i in data.info)_number||(_first=_form.find("[name="+i+"]")),fetchError(_form.find("[name="+i+"]"),data.info[i]),_number++}$.isFunction(_options.onAfter)&&_options.onAfter(data,_options)},_form.append(_options.loadingTpl),_form.submit(function(event){if(_options.uploadFile!==!0&&(_options.data=$.extend({},_options.data,serializeObject(_form[0]))),$.isFunction(_options.onBefore)){var _status=_options.onBefore.call(_form,_options);if(_status===!1)return!1}return _options.uploadFile===!0?_form.ajaxSubmit(_options):$.ajax(_options),!1}),$.isFunction(_options.controlPoint)&&_options.controlPoint.call(_form,valueChange)}}),define("common/library/cache",function(require,exports,module){var cacheList=window.top.DATACACHELIST=window.top.DATACACHELIST||{};exports.set=function(name,data){var _proxy=cacheList;if(null!==name)if($.isPlainObject(name))$.extend(!0,_proxy,name);else{name=name.toString();for(var _name=name.split("."),_leng=_name.length,i=0;_leng>i;i++)"undefined"==typeof _proxy[_name[i]]?i==_leng-1?_proxy[_name[i]]=data:_proxy[_name[i]]={}:_proxy[_name[i]]=$.extend(!0,_proxy[_name[i]],data),_proxy=_proxy[_name[i]]}},exports.del=function(name){if(null!==name)for(var _name=name.toString().split("."),_leng=_name.length,_proxy=cacheList,i=0;_leng>i;i++){if("undefined"!=typeof _proxy[_name[i]]&&i==_leng-1){delete _proxy[_name[i]];break}_proxy=_proxy[_name[i]]}},exports.get=function(name){if(null!==name)for(var _name=name.toString().split("."),_leng=_name.length,_proxy=cacheList,i=0;_leng>i;i++)if("undefined"!=typeof _proxy[_name[i]]){if(i==_leng-1)return _proxy[_name[i]];_proxy=_proxy[_name[i]]}}}),define("common/library/function",function(require,exports,module){window.Class=exports.Class=function(object,callback){var _attrs={},_F=function(){$.extend(!0,this,_attrs),this.initial&&this.initial.apply(this,arguments),this.parent&&this.parent.initial&&this.parent.initial.apply(this,arguments)};_F.prototype.setConfig=function(name,data){return Config.set.apply(Config,arguments)},_F.prototype.getConfig=function(name){return Config.get.apply(Config,arguments)},_F.prototype.getStatic=function(name){return _F[name]};for(var i=0;i<arguments.length;i++)if($.isPlainObject(arguments[i]))for(var j in arguments[i])$.isFunction(arguments[i][j])?_F.prototype[j]=arguments[i][j]:_attrs[j]=arguments[i][j];return $.isFunction(callback)&&callback.call(_F),object.instantiation===!1&&object.single!==!0?_F:new _F},window.Util={friendlyDate:function(time){var time=Number(time),text="",msec=1e3*time,differ=Math.floor(((new Date).getTime()-msec)/1e3);return text=30>differ?"刚刚":60>differ?differ+"秒前":3600>differ?Math.floor(differ/60)+"分钟前":86400>differ?Math.floor(differ/3600)+"小时前":259200>differ?1==Math.floor(time/86400)?"昨天 ":"前天 ":2592e3>differ?Util.formartDate(msec,"M月d日"):31536e3>differ?Util.formartDate(msec,"M月d日"):Util.formartDate(msec,"yyyy年M月d日")},formartDate:function(date,format){var _type=$.type(date),_date=new Date;if("date"==_type)_date=date;else if("number"==_type)_date.setTime(Number(date));else if("string"==_type){var _arr=_type.split(/\D/);_date=new Date(_arr[0]?_arr[0]:1,_arr[1]?_arr[1]-1:0,_arr[2]?_arr[2]:1,_arr[3]?_arr[3]:0,_arr[4]?_arr[4]:0,_arr[5]?_arr[5]:0)}var o={"M+":_date.getMonth()+1,"d+":_date.getDate(),"h+":_date.getHours(),"m+":_date.getMinutes(),"s+":_date.getSeconds(),"q+":Math.floor((_date.getMonth()+3)/3),S:_date.getMilliseconds()};/(y+)/.test(format)&&(format=format.replace(RegExp.$1,(_date.getFullYear()+"").substr(4-RegExp.$1.length)));for(var k in o)new RegExp("("+k+")").test(format)&&(format=format.replace(RegExp.$1,1==RegExp.$1.length?o[k]:("00"+o[k]).substr((""+o[k]).length)));return format},getDate:function(date){var _type=$.type(date);if("date"==_type)return date;if("number"==_type)return new Date(date);if("string"==_type){var _arr=_type.split(/\D/);return new Date(_arr[0]?_arr[0]:1,_arr[1]?_arr[1]-1:0,_arr[2]?_arr[2]:1,_arr[3]?_arr[3]:0,_arr[4]?_arr[4]:0,_arr[5]?_arr[5]:0)}return new Date},scrollTop:function(element,wrapElement,offset,callback){return $.isFunction(wrapElement)&&(callback=wrapElement,offset=0,wrapElement=null),$.isNumeric(wrapElement)&&(callback=offset,offset=wrapElement,wrapElement=null),$.isFunction(offset)&&(callback=offset,offset=0),$.isNumeric(offset)||(offset=0),wrapElement||(wrapElement=$("html,body")),offset=Math.floor(element.offset().top+offset),wrapElement.animate({scrollTop:offset},400,callback)},substr:function(content,start,length){var _start=start?start:0,_content=content;return _content&&"string"==typeof _content?($.isNumeric(start)&&(_start=parseInt(_start,10)),_content=length?_content.substr(start,length):_content.substr(start),_content!==content&&(_content+="..."),_content):""},HTMLEnCode:function(str){var s="";return 0==str.length?"":(s=str.replace(/</g,"&lt;"),s=s.replace(/>/g,"&gt;"))},HTMLDeCode:function(str){var s="";return 0==str.length?"":(s=str.replace(/&lt;/g,"<"),s=s.replace(/&gt;/g,">"))},setCursorPosition:function(elem,index){if($(elem).is(":visible")){var val=elem.value,len=val.length;index>len||setTimeout(function(){if(elem.focus(),elem.setSelectionRange)elem.setSelectionRange(index,index);else{var range=elem.createTextRange();range.moveStart("character",-len),range.moveEnd("character",-len),range.moveStart("character",index),range.moveEnd("character",0),range.select()}},10)}},isPhone:function(){for(var userAgentInfo=navigator.userAgent,Agents=new Array("Android","iPhone","SymbianOS","Windows Phone","iPod"),v=0;v<Agents.length;v++)if(userAgentInfo.indexOf(Agents[v])>0)return!0;return!1},getMemberAvatar:function(id,size){if($.isNumeric(id)){for(var _src=[],_id=id.toString(),_i=_id.length,_size=size||"middle";10>_i;_i++)_id="0"+_id;return _src.push(_id.substr(0,3)),_src.push(_id.substr(3,3)),_src.push(_id.substr(6,2)),_src.push(_id.substr(8,2)),_src=_src.join("/"),"/Uploads/Avatar/"+_src+"/"+_size+".gif"}return""},selectable:function(element,status){var status=!!status;status?element.attr("unselectable","on").css({"-moz-user-select":"-moz-none","-moz-user-select":"none","-o-user-select":"none","-khtml-user-select":"none","-webkit-user-select":"none","-ms-user-select":"none","user-select":"none"}).bind("selectstart",function(){return!1}):element.attr("unselectable","off").css({"-moz-user-select":"-moz-auto","-moz-user-select":"auto","-o-user-select":"auto","-khtml-user-select":"auto","-webkit-user-select":"auto","-ms-user-select":"auto","user-select":"auto"}).bind("selectstart",function(){return!0})},cnstrlen:function(str,shortUrl){return 1==shortUrl?Math.ceil(str.replace(/((news|telnet|nttp|file|http|ftp|https):\/\/){1}(([-A-Za-z0-9]+(\.[-A-Za-z0-9]+)*(\.[-A-Za-z]{2,5}))|([0-9]{1,3}(\.[0-9]{1,3}){3}))(:[0-9]*)?(\/[-A-Za-z0-9_\$\.\+\!\*\(\),;:@&=\?\/~\#\%]*)*/gi,"http://goo.gl/fkKB ").replace(/^\s+|\s+$/gi,"").replace(/[^\x00-\xff]/gi,"xx").length/2):Math.ceil(str.replace(/^\s+|\s+$/gi,"").replace(/[^\x00-\xff]/gi,"xx").length/2)},wranStyle:function(element,cls){function _wran(){element.toggleClass(_cls)}var _number=0,_cls=cls||"wran-style";element.__TIMER__&&clearInterval(element.__TIMER__),element.__TIMER__=setInterval(function(){_number++,_wran(),_number>=1&&clearInterval(element.__TIMER__)},300),_wran()},pathinfo:function(path){var ext,name,index1=path.lastIndexOf("."),index2=path.length;return index1>-1?(ext=path.substring(index1+1,index2),name=path.substring(0,index1)):(name=path,ext=""),{name:name,ext:ext}},isMac:function(){var os=(navigator.platform.match(/mac|win|linux/i)||["other"])[0].toLowerCase();return"mac"==os},md5:function(string){function RotateLeft(lValue,iShiftBits){return lValue<<iShiftBits|lValue>>>32-iShiftBits}function AddUnsigned(lX,lY){var lX4,lY4,lX8,lY8,lResult;return lX8=2147483648&lX,lY8=2147483648&lY,lX4=1073741824&lX,lY4=1073741824&lY,lResult=(1073741823&lX)+(1073741823&lY),lX4&lY4?2147483648^lResult^lX8^lY8:lX4|lY4?1073741824&lResult?3221225472^lResult^lX8^lY8:1073741824^lResult^lX8^lY8:lResult^lX8^lY8}function F(x,y,z){return x&y|~x&z}function G(x,y,z){return x&z|y&~z}function H(x,y,z){return x^y^z}function I(x,y,z){return y^(x|~z)}function FF(a,b,c,d,x,s,ac){return a=AddUnsigned(a,AddUnsigned(AddUnsigned(F(b,c,d),x),ac)),AddUnsigned(RotateLeft(a,s),b)}function GG(a,b,c,d,x,s,ac){return a=AddUnsigned(a,AddUnsigned(AddUnsigned(G(b,c,d),x),ac)),AddUnsigned(RotateLeft(a,s),b)}function HH(a,b,c,d,x,s,ac){return a=AddUnsigned(a,AddUnsigned(AddUnsigned(H(b,c,d),x),ac)),AddUnsigned(RotateLeft(a,s),b)}function II(a,b,c,d,x,s,ac){return a=AddUnsigned(a,AddUnsigned(AddUnsigned(I(b,c,d),x),ac)),AddUnsigned(RotateLeft(a,s),b)}function ConvertToWordArray(string){for(var lWordCount,lMessageLength=string.length,lNumberOfWords_temp1=lMessageLength+8,lNumberOfWords_temp2=(lNumberOfWords_temp1-lNumberOfWords_temp1%64)/64,lNumberOfWords=16*(lNumberOfWords_temp2+1),lWordArray=Array(lNumberOfWords-1),lBytePosition=0,lByteCount=0;lMessageLength>lByteCount;)lWordCount=(lByteCount-lByteCount%4)/4,lBytePosition=lByteCount%4*8,lWordArray[lWordCount]=lWordArray[lWordCount]|string.charCodeAt(lByteCount)<<lBytePosition,lByteCount++;return lWordCount=(lByteCount-lByteCount%4)/4,lBytePosition=lByteCount%4*8,lWordArray[lWordCount]=lWordArray[lWordCount]|128<<lBytePosition,lWordArray[lNumberOfWords-2]=lMessageLength<<3,lWordArray[lNumberOfWords-1]=lMessageLength>>>29,lWordArray}function WordToHex(lValue){var lByte,lCount,WordToHexValue="",WordToHexValue_temp="";for(lCount=0;3>=lCount;lCount++)lByte=lValue>>>8*lCount&255,WordToHexValue_temp="0"+lByte.toString(16),WordToHexValue+=WordToHexValue_temp.substr(WordToHexValue_temp.length-2,2);return WordToHexValue}function Utf8Encode(string){string=string.replace(/\r\n/g,"\n");for(var utftext="",n=0;n<string.length;n++){var c=string.charCodeAt(n);128>c?utftext+=String.fromCharCode(c):c>127&&2048>c?(utftext+=String.fromCharCode(c>>6|192),utftext+=String.fromCharCode(63&c|128)):(utftext+=String.fromCharCode(c>>12|224),utftext+=String.fromCharCode(c>>6&63|128),utftext+=String.fromCharCode(63&c|128))}return utftext}var k,AA,BB,CC,DD,a,b,c,d,x=Array(),S11=7,S12=12,S13=17,S14=22,S21=5,S22=9,S23=14,S24=20,S31=4,S32=11,S33=16,S34=23,S41=6,S42=10,S43=15,S44=21;for(string=Utf8Encode(string),x=ConvertToWordArray(string),a=1732584193,b=4023233417,c=2562383102,d=271733878,k=0;k<x.length;k+=16)AA=a,BB=b,CC=c,DD=d,a=FF(a,b,c,d,x[k+0],S11,3614090360),d=FF(d,a,b,c,x[k+1],S12,3905402710),c=FF(c,d,a,b,x[k+2],S13,606105819),b=FF(b,c,d,a,x[k+3],S14,3250441966),a=FF(a,b,c,d,x[k+4],S11,4118548399),d=FF(d,a,b,c,x[k+5],S12,1200080426),c=FF(c,d,a,b,x[k+6],S13,2821735955),b=FF(b,c,d,a,x[k+7],S14,4249261313),a=FF(a,b,c,d,x[k+8],S11,1770035416),d=FF(d,a,b,c,x[k+9],S12,2336552879),c=FF(c,d,a,b,x[k+10],S13,4294925233),b=FF(b,c,d,a,x[k+11],S14,2304563134),a=FF(a,b,c,d,x[k+12],S11,1804603682),d=FF(d,a,b,c,x[k+13],S12,4254626195),c=FF(c,d,a,b,x[k+14],S13,2792965006),b=FF(b,c,d,a,x[k+15],S14,1236535329),a=GG(a,b,c,d,x[k+1],S21,4129170786),d=GG(d,a,b,c,x[k+6],S22,3225465664),c=GG(c,d,a,b,x[k+11],S23,643717713),b=GG(b,c,d,a,x[k+0],S24,3921069994),a=GG(a,b,c,d,x[k+5],S21,3593408605),d=GG(d,a,b,c,x[k+10],S22,38016083),c=GG(c,d,a,b,x[k+15],S23,3634488961),b=GG(b,c,d,a,x[k+4],S24,3889429448),a=GG(a,b,c,d,x[k+9],S21,568446438),d=GG(d,a,b,c,x[k+14],S22,3275163606),c=GG(c,d,a,b,x[k+3],S23,4107603335),b=GG(b,c,d,a,x[k+8],S24,1163531501),a=GG(a,b,c,d,x[k+13],S21,2850285829),d=GG(d,a,b,c,x[k+2],S22,4243563512),c=GG(c,d,a,b,x[k+7],S23,1735328473),b=GG(b,c,d,a,x[k+12],S24,2368359562),a=HH(a,b,c,d,x[k+5],S31,4294588738),d=HH(d,a,b,c,x[k+8],S32,2272392833),c=HH(c,d,a,b,x[k+11],S33,1839030562),b=HH(b,c,d,a,x[k+14],S34,4259657740),a=HH(a,b,c,d,x[k+1],S31,2763975236),d=HH(d,a,b,c,x[k+4],S32,1272893353),c=HH(c,d,a,b,x[k+7],S33,4139469664),b=HH(b,c,d,a,x[k+10],S34,3200236656),a=HH(a,b,c,d,x[k+13],S31,681279174),d=HH(d,a,b,c,x[k+0],S32,3936430074),c=HH(c,d,a,b,x[k+3],S33,3572445317),b=HH(b,c,d,a,x[k+6],S34,76029189),a=HH(a,b,c,d,x[k+9],S31,3654602809),d=HH(d,a,b,c,x[k+12],S32,3873151461),c=HH(c,d,a,b,x[k+15],S33,530742520),b=HH(b,c,d,a,x[k+2],S34,3299628645),a=II(a,b,c,d,x[k+0],S41,4096336452),d=II(d,a,b,c,x[k+7],S42,1126891415),c=II(c,d,a,b,x[k+14],S43,2878612391),b=II(b,c,d,a,x[k+5],S44,4237533241),a=II(a,b,c,d,x[k+12],S41,1700485571),d=II(d,a,b,c,x[k+3],S42,2399980690),c=II(c,d,a,b,x[k+10],S43,4293915773),b=II(b,c,d,a,x[k+1],S44,2240044497),a=II(a,b,c,d,x[k+8],S41,1873313359),d=II(d,a,b,c,x[k+15],S42,4264355552),c=II(c,d,a,b,x[k+6],S43,2734768916),b=II(b,c,d,a,x[k+13],S44,1309151649),a=II(a,b,c,d,x[k+4],S41,4149444226),d=II(d,a,b,c,x[k+11],S42,3174756917),c=II(c,d,a,b,x[k+2],S43,718787259),b=II(b,c,d,a,x[k+9],S44,3951481745),a=AddUnsigned(a,AA),b=AddUnsigned(b,BB),c=AddUnsigned(c,CC),d=AddUnsigned(d,DD);var temp=WordToHex(a)+WordToHex(b)+WordToHex(c)+WordToHex(d);return temp.toLowerCase()}}}),define("common/module/comment",function(require,exports,module){require("common/extend/validator/validator");var Template=require("common/extend/template");return require("component/jquery.atwho/dist/css/jquery.atwho.min.css"),require("component/Caret.js/dist/jquery.caret.min"),require("component/jquery.atwho/dist/js/jquery.atwho.min"),Template.helper("friendlyDate",Util.friendlyDate),Class({_options:{pageSize:10,wrapEle:null,listPath:null,votePath:null,onePath:null,postParam:{},delParam:{},itemTpl:['<p class="info">','<a href="/@<%=username%>" class="name"><%=nickname%></a>','<span class="date"><%=friendlyDate(create_time)%>评论</span>',"</p>",'<div class="content">',"<%=#resolveCode(content)%>","</div>",'<p class="util">','<span class="vote">','<a class="agree e-agree" data-href="<%=votePath%>" data-id="<%=id%>" title="赞成"><i class="icon icon-thumbs-up"></i></a>','<b class="count"><%=(vote)||0%></b>','<a class="oppose e-oppose" data-href="<%=votePath%>" data-id="<%=id%>" title="反对"><i class="icon icon-thumbs-down"></i></a>',"</span>","<%if(username){%>",'<a class="reply e-reply" data-username="<%=username%>" >回复</a>',"<%}%>",'<span class="operate<%if(is_delete){%> toggle<%}%>">',"<%if(is_delete == 1){%>",'<a class="delete e-delete" data-id="<%=id%>" data-href="<%=delPath%>"><i class="icon icon-cross"></i></a>',"<%}%>",'<span class="number"><%=number%>#</span>',"</span>","</p>"].join(""),emptyTpl:'<i class="image"></i><b class="text">暂无相关评论</b>',disabledPost:!1,hidePost:!1,disabledTemp:['<div class="comment-post-disabeld">','<span>没有登录不能发表评论，请 <a class="login" href="/user/login" target="_blank">登录</a> 或 <a class="register" target="_blank" href="/user/register">注册</a></span>',"</div>"].join(""),delPath:null,addPath:null,onDelItem:null,onAddItem:null,onLoadList:null,onCreate:null,is_delete:1},listParam:{},items:[],isEnterFocus:!1,initLoadData:!1,initial:function(options){function error(){self.postEnterEle.parent().addClass("textarea-error"),self.postTipEle.text(this.msg).removeClass("fragment-tip").addClass("fragment-error")}function success(){self.postEnterEle.parent().removeClass("textarea-error"),self.postTipEle.text(self.postTipEle.data("defaultText")).addClass("fragment-tip").removeClass("fragment-error")}var self=this;this.options=$.extend({},this._options,options),this.wrapEle=this.options.wrapEle,this.comemntEle=this.createBase(),this.comemntEle.appendTo(this.wrapEle),this.postFormEle=this.wrapEle.find(".comment-post form"),this.options.disabledPost&&this.wrapEle.addClass("comment-disabled")&&this.wrapEle.append(this.options.disabledTemp),this.options.hidePost&&this.postFormEle.parent().hide(),this.postEnterEle=this.postFormEle.find("textarea"),this.postFormEle.attr("action",this.options.addPath),this.postTipEle=this.postFormEle.find(".form-tip"),this.listEle=this.wrapEle.find(".comment-list"),this.emptyEle=$('<div class="comment-empty">'+this.options.emptyTpl+"</div>").appendTo(this.listEle),this.codeEle=this.postFormEle.find(".comment-code"),this.totalEle=this.wrapEle.find(".comment-total"),this.listEle.delegate(".delete","click",function(){var _ele=$(this);return $.dialog.confirm("确定删除评论吗？",function(action){1==action&&self.delItem(_ele)}),!1}),this.listEle.delegate(".reply","click",function(){var _value=self.postEnterEle.val();return _value=_value?_value+"@"+$(this).data("username")+" ":"@"+$(this).data("username")+" ",self.postEnterEle.val(_value).focus(),!1}),this.listEle.delegate(".agree","click",function(){return self.agree($(this)),!1}),this.listEle.delegate(".oppose","click",function(){return self.oppose($(this)),!1}),Template.helper("resolveCode",function(content){return self.resolveCode(content)}),Template.setData({votePath:this.options.votePath,delPath:this.options.delPath}),this.textareaHeightAuto(this.postEnterEle),this.postFormEle.submitForm({data:this.options.postParam,validate:[{name:"content",rule:"require",msg:"评论内容不能为空！",onBefore:function(data){var reg=/\[code\](.*?)\[\/code\]/gi,codes=[],code=!0,length=0,max=0,data=data.replace(/\s/g,"");data=data.replace(reg,function(r1,r2,i,s){return codes.push(r2),""}),length=codes.length,max=length-1;for(var i=0;length>i;i++){if(codes[i]&&"/*填写代码*/"!=codes[i])return!0;i>=max&&(code=!1)}return""!=data||code?void 0:!1},onAfter:function(status,data){status||error.call(this)}}],autoValidate:!1,onAfter:function(data,options){data.status?(self.resetForm(),data.data.number=self.getTotal()+1,data.data.is_delete=self.options.is_delete,self.addItem(data.data,!0),success(),self.postEnterEle.focus()):$.dialog.error(data.info)}}),self.postEnterEle.focus(function(){self.isEnterFocus=!0,success()}).blur(function(){self.isEnterFocus=!1}),$(document).keyup(function(event){self.isEnterFocus&&event.ctrlKey&&13==event.which&&self.postFormEle.submit()}),self.postTipEle.data("defaultText",self.postTipEle.text()),this.postEnterEle.atwho({at:"@",displayTpl:'<li><img class="avatar" src="${avatar}" /> ${name} <small>${username}</small></li>',insertTpl:"${atwho-at}${username}",callbacks:{sorter:function(query,items,searchKey){var _results,i,item,len;if(!query)return items;for(_results=[],i=0,len=items.length;len>i;i++)item=items[i],item.atwho_order=new String(item.name).toLowerCase().indexOf(query.toLowerCase())+new String(item.username).toLowerCase().indexOf(query.toLowerCase()),item.atwho_order>-2&&_results.push(item);return _results.sort(function(a,b){return b.atwho_order-a.atwho_order})},filter:function(query,data,searchKey){var _results,i,item,len;for(_results=[],i=0,len=data.length;len>i;i++)item=data[i],(new String(item.name).toLowerCase().indexOf(query.toLowerCase())>-1||new String(item.username).toLowerCase().indexOf(query.toLowerCase())>-1)&&_results.push(item);return _results},remoteFilter:function(query,callback){$.getJSON("/autocomplete/user",{search:query},function(data){callback(data)})}}}),this.codeEle.click(function(){var _value=self.postEnterEle.val();_value=_value?_value+"\n[code]\n/*填写代码*/\n[/code]":"[code]\n/*填写代码*/\n[/code]",self.postEnterEle.val(_value).focus()}),this.setPage(this.options.page||1),this.setPageSize(this.options.pageSize),this.getLoadMoreEle(),$.isFunction(this.options.onCreate)&&this.options.onCreate.call(this)},loadList:function(param,callback){return $.extend(this.listParam,param),this.emptyEle.removeClass("empty-active"),this.listEle.loading("评论加载中","loading-ripple-empty"),this.getLoadMoreEle().removeClass("more-active"),$.ajax({url:this.options.listPath,data:this.listParam,type:"post",context:this,success:function(data){this.initLoadData||this.setTotal(data.data.count),this.initLoadData=!0,$.isFunction(callback)&&callback.call(this,data.data.list)},complete:function(){this.listEle.loading("hide")}})},loadOne:function(param,callback){return this.emptyEle.removeClass("empty-active"),this.getLoadMoreEle().removeClass("more-active"),this.listEle.loading("评论加载中","loading-ripple-empty"),$.ajax({url:this.options.onePath,data:param,type:"post",context:this,success:function(data){data.status||$.dialog.error(data.info),$.isFunction(callback)&&callback.call(this,data)},complete:function(){this.listEle.loading("hide")}})},assignList:function(param,callback){this.empty(),this.initLoadData=!1,this._replaceEle&&this._replaceEle.remove(),this.loadList(param,function(data){$.isFunction(callback)&&callback.call(this,data),this._addItem(data),this.find()})},moreList:function(param){this.setPage(Math.min(this.getPage()+1,this.getPageTotal())),this.loadList(param,function(data){this._addItem(data),this.find()})},agree:function(element,callback){var _vote=element.parent();_vote.hasClass("disabled")||element.hasClass("loading")||(element.addClass("loading"),$.ajax({url:element.data("href"),type:"post",data:{comm_id:element.data("id"),type:1},success:function(data){var _count=_vote.find(".count");data.status?_count.text(Number(_count.text())+1):$.dialog.error(data.info),"投票成功"!=data.info&&"已经投过票了"!=data.info||(_vote.addClass("disabled"),_vote.find("a").attr("title","你已投过票！"))},complete:function(){element.removeClass("loading")}}))},oppose:function(element,callback){var _vote=element.parent();_vote.hasClass("disabled")||element.hasClass("loading")||(element.addClass("loading"),$.ajax({url:element.data("href"),type:"post",data:{comm_id:element.data("id"),type:0},success:function(data){var _count=_vote.find(".count");data.status?_count.text(Number(_count.text())-1):$.dialog.error(data.info),"投票成功"!=data.info&&"已经投过票了"!=data.info||(_vote.addClass("disabled"),_vote.find("a").attr("title","你已投过票！"))},complete:function(){element.removeClass("loading")}}))},getPageTotal:function(){return Math.ceil(this.getTotal()/this.getPageSize())},setPageSize:function(size){return $.isNumeric(size)&&(this._pageSize=size,this.listParam.pageSize=this._pageSize),this},getPageSize:function(){return this._pageSize},setPage:function(page){return $.isNumeric(page)&&(this._page=page,this.listParam.page=this._page),this},getPage:function(){return this._page},setTotal:function(total){return $.isNumeric(total)&&(this._total=Number(total),this.totalEle.text(this._total)),this},getTotal:function(){return this._total||0},getItemAt:function(id){for(var i=0;i<this.items.length;i++)if(this.items[i].data("id")==id)return i;return-1},_addItem:function(data,prepend,sumTotal){var _data=$.isArray(data)?data:[data],_length=0,_i=0,_item=null,_temp='<div class="comment-item" data-id="<%=id%>">'+this.options.itemTpl+"</div>",_callback=$.isFunction(this.options.onAddItem)?this.options.onAddItem:$.noop,_items=[],_prepend=!!prepend;for(_data=this.formartData(this.removeRepeat(_data)),_length=_data.length;_length>_i;_i++){_data[_i].is_delete=this.options.is_delete,_item=Template.parseTemp(_temp,_data[_i]),_item=$(_item),_items.push(_item),this.listEle[_prepend?"prepend":"append"](_item),_callback.call(this,_item)}return this.items=this.items.concat(_items),sumTotal===!1?0:_data.length},addItem:function(data,prepend,sumTotal){var _num=this._addItem.apply(this,arguments);return this.setTotal(this._total+_num),this},delItem:function(element,callback){element.hasClass("loading")||(element.addClass("loading"),$.ajax({url:element.data("href"),data:$.extend({id:element.data("id")},this.options.delParam),type:"post",context:this,success:function(data){if(data.status){var _index=this.getItemAt(element.data("id")),_prev=this.items[_index].prevAll(".comment-item");"undefined"!=typeof _index&&(this.items[_index].remove(),this.items.splice(_index,1),this.setTotal(Math.max(--this._total,0)),_prev.each(function(){var _text=$(this).find(".number").text().replace("#","");$(this).find(".number").html(_text-1+"#")}),this.find())}else $.dialog.error(data.info);$.isFunction(callback)&&callback.call(this,data)},complete:function(){element.removeClass("loading")}}))},setDelParam:function(param){this.options.delParam=$.extend(this.options.delParam||{},param)},empty:function(){for(var i=this.items.length-1;i>=0;i--)this.items[i].remove(),this.items.splice(i,1);this.setTotal(0),this.setPage(1),this.find()},find:function(){var _total=this.getTotal(),_length=this.items.length||0,_differ=Math.max(_total-_length,0);_length?this.emptyEle.removeClass("empty-active"):this.options.hidePost&&this.emptyEle.addClass("empty-active"),_differ?this.getLoadMoreEle(_differ).addClass("more-active"):this.getLoadMoreEle(_differ).removeClass("more-active")},resetForm:function(){return this.postEnterEle.val("").blur(),this},createBase:function(){var _tpl=['<div class="comment-result">','<strong class="title">相关评论(<b class="comment-total">0</b>)</strong>','<div class="comment-post">','<form class="form" action="#" method="post">','<label class="enter w-textarea textarea-full"><textarea class="textarea-input" name="content" placeholder="文明上网，理性发言"></textarea></label>','<div class="util cf">','<div class="left">','<span class="comment-code"><b class="e-code icon-embed2" title="插入代码"></b></span>',"</div>",'<div class="right">','<span class="form-tip w-fragment fragment-tip">Ctrl + Enter快速发布</span>','<label class="form-submit w-btn btn-success btn-m"><button class="btn-input" type="submit">发布</button></label>',"</div>","</div>","</form>","</div>",'<div class="comment-list"></div>',"</div>"].join("");return $(_tpl)},getLoadMoreEle:function(differ){var self=this;return this._loadMoreEle||(this._loadMoreEle=$('<div class="comment-more"><span class="more-inner">加载剩余<b class="number">0</b>条评论</span></div>'),this.listEle.after(this._loadMoreEle),this._loadMoreEle.children().click(function(){self.moreList()})),$.isNumeric(differ)&&this._loadMoreEle.find(".number").text(differ),this._loadMoreEle},formartData:function(data){for(var data=$.isArray(data)?data:[data],_data=[],_count=this.items.length,_total=this.getTotal(),i=0;i<data.length;i++)"undefined"==typeof data[i].number&&(data[i].number=_total-_count-i),_data.push(data[i]);return _data},removeRepeat:function(data){for(var data1=$.isArray(data)?data:[data],data2=[],i=0;i<data1.length;i++)this.getItemAt(data1[i].id)<0&&data2.push(data1[i]);return data2},resolveCode:function(content){var cnum=0,arrcode=[],reg=/(\[code\])([\s \S]*?)(\[\/code\])/gi,res=content.replace(reg,function(r1,r2,r3,r4,n,s){var str="";return"[code]"==r2&&(str+="<pre><code>"),str+=$.trim(r3),"[/code]"==r4&&(str+="</code></pre>"),cnum++,arrcode[cnum]=str,"[	codeplace_"+cnum+"	]"});res=res.replace(/\n/g,"<br />");for(var i=1;cnum>=i;i++)res=res.replace("[	codeplace_"+i+"	]",function(){return arrcode[i]});return res},textareaHeightAuto:function(element){function autoHeight(elem){var _pt=parseInt(element.css("paddingTop")),_pb=parseInt(element.css("paddingBottom"));elem.style.height="auto",elem.scrollTop=0,elem.style.height=Math.max(elem.scrollHeight-_pt-_pb,0)+"px"}element=element||this.postEnterEle,autoHeight(element[0]),arguments.callee._inited||(element.on("keyup focus cut paste",function(){autoHeight(this)}),arguments.callee._inited=!0)},instantiation:!1},function(){this.resolveCode=function(content){var reg=/(\[code\])([\s \S]*?)(\[\/code\])/gi;return res=content.replace(reg,function(r1,r2,r3,r4,n,s){var str="";return"[code]"==r2&&(str+="<pre><code>"),str+=$.trim(r3),"[/code]"==r4&&(str+="</code></pre>"),str}),res},this.replaceCode=function(content,replaceString){var _replaceString=replaceString||'<span class="code-placehoder" title="查看代码"></span>',reg=/(\[code\])([\s \S]*?)(\[\/code\])/gi;return res=content.replace(reg,function(r1,r2,r3,r4,n,s){var str='<div class="m-replace-code">';return str+='<div class="code-show">',str+=_replaceString,str+="</div>",str+='<div class="code-hide">',"[code]"==r2&&(str+="<pre><code>"),str+=$.trim(r3),"[/code]"==r4&&(str+="</code></pre>"),str+="</div>",str+="</div>"}),res}})}),define("common/module/config",function(require,exports,module){var Cache=require("common/library/cache");return window.Config={set:function(name,data){return"string"==typeof name?Cache.set("CONFIG."+name,data):$.isPlainObject(name)?Cache.set({CONFIG:name}):void 0},get:function(name){return"string"==typeof name?Cache.get("CONFIG."+name):void 0},del:function(name){return"string"==typeof name?Cache.del("CONFIG."+name):void 0}}}),define("common/module/customerService",function(){Class({serviceEle:$("#w-intercom-launcher-button"),initial:function(){var iX,iY,dragging=!1;this.serviceEle.mousedown(function(e){return dragging=!0,iX=e.clientX-this.offsetLeft,iY=e.clientY-this.offsetTop,!1}),document.onmousemove=function(e){if(dragging){var e=e||window.event,oX=e.clientX-iX,oY=e.clientY-iY;return $("#w-intercom-launcher-button").css({left:oX+"px",top:oY+"px"}),$("#w-intercom-launcher-button").data("w-intercom-launcher-button",1),!1}},$(document).mouseup(function(e){dragging=!1,e.cancelBubble=!0,setTimeout(function(){$("#w-intercom-launcher-button").data("w-intercom-launcher-button",0)},100)}),this.serviceEle.click(function(){return 1==$("#w-intercom-launcher-button").data("w-intercom-launcher-button")?!1:void 0}),this.serviceEle.hover(function(){$(this).find(".icon-circle-cross").show()},function(){$(this).find(".icon-circle-cross").hide()}),this.serviceEle.find(".icon-circle-cross").click(function(){$(this).parent("#w-intercom-launcher-button").hide()})}})}),define("common/module/cutImage",function(require,exports,module){require("component/jcrop/css/jquery.Jcrop.css"),require("component/jcrop/js/jquery.Jcrop"),require("component/jquery.form");var Template=require("common/extend/template");return Class({_options:{cls:null,boxWidth:0,boxHeight:0,cutWidth:0,cutHeight:0,uploadUrl:null,uploadParam:null,saveCutUrl:null,saveCutParam:null,onUploadStart:null,onUploadEnd:null,onSuccess:null},cutImageData:{},cutImageKey:"",initial:function(options){var self=this;this.options=$.extend({},this._options,options),this.createTemp(),this.wrapEle.addClass(this.options.cls),this.setUploadUrl(this.options.uploadUrl),this.setUploadParam(this.options.uploadParam),this.setSaveCutUrl(this.options.saveCutUrl),this.setSaveCutParam(this.options.saveCutParam),this.uploadFileEle.change(function(){self.uploadFormEle.submit()}),this.cropImage=null,self.cropImage=$.Jcrop(this.cropImageEle,{aspectRatio:this.options.cutWidth/this.options.cutHeight,bgOpacity:.5,boxWidth:this.options.boxWidth,boxHeight:this.options.boxHeight,onSelect:function(c){self.cutImageData=c},onRelease:function(){self.cutImageData={x:0,y:0,w:self.options.cutWidth,h:self.options.cutHeight}}}),this.uploadFormEle.submit(function(){return self.uploadFileEle.hasClass("disabled")||($(this).ajaxSubmit({data:self._uploadParam,beforesend:self.options.onUploadStart,success:function(data){if("string"==typeof data&&(data=$.parseJSON(data)),data.status){self.wrapEle.addClass("cutimg-enable");var _src=data.data.url.indexOf("?")>=0?data.data.url+"&v="+(new Date).getTime():data.data.url+"?v="+(new Date).getTime();self.cutImageKey=data.data.key,self.cropImage.setImage(_src,function(){var _ar=this.getOptions().aspectRatio,_is=this.getBounds(),_ms=Math.min(_is[0],_is[1]),_hw=Math.floor(.8*_ms),_hh=Math.floor(_hw/_ar),_x=(_is[0]-_hw)/2,_y=(_is[1]-_hh)/2;self.cropImage.setSelect([_x,_y,_hw+_x,_hh+_y])})}else $.dialog.error(data.info);$.isFunction(self.options.onUploadEnd)&&self.options.onUploadEnd.call(this,data);
},complete:function(){self.uploadBtnEle.removeClass("btn-loading"),self.uploadBtnEle.find("button").text("选择图片"),self.uploadFileEle.removeClass("disabled"),self.uploadFileEle.show()}}),self.uploadBtnEle.addClass("btn-loading"),self.uploadBtnEle.find("button").text("正在上传"),self.uploadFileEle.addClass("disabled"),self.uploadFileEle.hide()),!1}),this.saveCutFormEle.submitForm({data:this._saveCutParam,onBefore:function(options){self.cropImage&&(options.data.key=self.cutImageKey,options.data.x=self.cutImageData.x,options.data.y=self.cutImageData.y,options.data.w=self.cutImageData.w,options.data.h=self.cutImageData.h)},onAfter:function(data){data.status?(self.cropImage.release(),$.dialog.success(data.info),$.isFunction(self.options.onSuccess)&&self.options.onSuccess.call(this,data)):$.dialog.error(data.info)}}),this.reuploadEle.click(function(){self.reupload()})},getHtml:function(){return this.wrapEle},createTemp:function(){var _html=['<div class="m-cutimg-work">','<div class="work-area">','<div class="work-upload">','<form class="w-form" id="uploadForm" method="post" enctype="multipart/form-data">','<div class="upload-input">','<input name="cover" class="file" type="file">','<i class="icon icon-cloud-storage"></i>','<label class="w-btn btn-success btn-l">','<button type="button" class="btn-input">选择图片</button>',"</label>","</div>",'<p class="upload-tip">图片大小不能超过5M，且只允许为png、gif、jpg格式图片</p>',"</form>","</div>",'<div class="work-crop">','<form class="w-form" id="saveCutForm" method="post" enctype="multipart/form-data">','<div class="crop-image">','<div class="image-inner">','<img width="200">',"</div>","</div>",'<div class="crop-util">','<span class="util-left">','<a class="reupload e-link"><i class="icon-undo2"></i>重新上传</a>',"</span>",'<span class="util-right">','<label class="w-btn btn-success btn-m">','<button class="btn-input" type="submit">保存裁剪</button>',"</label>","</span>","</div>","</form>","</div>","</div>","</div>"].join("");this.wrapEle=$(Template.parseTemp(_html)),this.uploadFileEle=this.wrapEle.find("[type=file]"),this.uploadWorkEle=this.wrapEle.find(".work-upload"),this.uploadBtnEle=this.uploadWorkEle.find(".w-btn"),this.cropWorkEle=this.wrapEle.find(".work-crop"),this.cropImageEle=this.wrapEle.find(".crop-image img"),this.uploadFormEle=this.wrapEle.find("#uploadForm"),this.saveCutFormEle=this.wrapEle.find("#saveCutForm"),this.reuploadEle=this.wrapEle.find(".reupload")},setUploadUrl:function(url){return this.uploadFormEle.attr("action",url),this},setUploadParam:function(param){return this._uploadParam=param,this},setSaveCutUrl:function(url){return this.saveCutFormEle.attr("action",url),this},setSaveCutParam:function(param){return this._saveCutParam=param,this},reupload:function(){return this.wrapEle.removeClass("cutimg-enable"),this},instantiation:!1})}),define("common/module/editor",function(require){require("component/ace/src-min/ace");var previewTimer,showdown=require("component/showdown/dist/showdown.min"),xss=require("common/extend/showdown/xss"),editor=function(id,options){return new editor.fn.init(id,options)};editor.defaults={items:"h1,h2,h3,h4,h5,h6,-,link,image,-,bold,italic,code,-,ul,ol,blockquote,hr,-,fullscreen,save",extraItems:"",width:"100%",height:"100%",uploader:{url:"",data:null,name:"images"},tools:{},onSave:$.noop,mode:"markdown",lang:{h1:"标题一",h2:"标题二",h3:"标题三",h4:"标题四",h5:"标题五",h6:"标题六",link:"链接",image:"图片",bold:"加粗",italic:"斜体",code:"代码",ul:"无序列表",ol:"有序列表",blockquote:"引用",hr:"分割线",table:"表格",preview:"预览",help:"帮助",undo:"撤销",redo:"重做",fullscreen:"全屏编辑",save:"保存","table-title":"插入表格","link-title":"插入链接","image-title":"插入图片","image-text":"拖动图片到这里上传"},preview:!1,extensions:[]},editor.$ace=null,editor.$marked=null,editor.$preview=!1,editor.prototype=editor.fn={init:function(id,options){options=this.options=$.extend({},editor.defaults,options||{}),this.lang=$.extend({},editor.defaults.lang,options.lang||{});var $textarea;$textarea="string"==typeof id?$("#"+id):id,$textarea.wrap("<div/>").parent().wrap("<div/>");var $editor=this.$editor=$textarea.parent().parent();$editor.addClass("thinkeditor"),$editor.children("div").addClass("thinkeditor-textarea");var _textareaParent=$textarea.closest(".thinkeditor-textarea"),_mainWorkArea=$('<div class="thinkeditor-main"></div>'),_previewArea=$('<div class="thinkeditor-preview"><div class="thinkeditor-preview-inner"><div class="thinkeditor-preview-content think-editor-content"></div></div></div>');_textareaParent.after(_mainWorkArea),_mainWorkArea.append(_textareaParent).append(_previewArea),_textareaParent.wrap('<div class="thinkeditor-textarea-wrap"></div>'),this.preview=_previewArea.find(".thinkeditor-preview-inner"),this.previewContainer=_previewArea.find(".thinkeditor-preview-content"),$editor.css({width:options.width,height:options.height}),this.setAce($textarea[0]).setToolbar().setMarkdown().syncScroll(),this.setMode(options.mode);var self=this;return this.$ace.on("change",function(){self.$preview&&self.setPreviewContent(self.getValue())}),this.setPreviewContent(this.getValue()),this.initValue=this.getValue(),this.preview.on("click","a",function(){return $(this).data("internal")?void 0:(window.open($(this).attr("href")),!1)}),this},isChanged:function(){return this.initValue!==this.getValue()},reset:function(){this.initValue=this.getValue(),this.getToolbar("save").attr("disabled","disabled").removeClass("warning")},setPreviewContent:function(content){var self=this;previewTimer&&clearTimeout(previewTimer),previewTimer=setTimeout(function(){self.previewContainer.html(self.$marked.makeHtml(content))},300)},setMarkdown:function(){var options={omitExtraWLInCodeBlocks:!0,noHeaderId:!1,simplifiedAutoLink:!0,literalMidWordUnderscores:!0,tables:!0,ghCodeBlocks:!0,tasklists:!0,extensions:[xss,"toc"].concat(this.options.extensions)};return this.$marked=new showdown.Converter(options),this},setAce:function(textarea){return this.$ace=ace.edit(textarea),window.$ace=this.$ace,this.$ace.setTheme("ace/theme/dawn"),this.$ace.renderer.setScrollMargin(5,10,5,10),this.$ace.renderer.setPadding(10),this.$ace.renderer.setShowGutter(!1),this.$ace.renderer.setShowPrintMargin(!1),this.$ace.setDisplayIndentGuides(!1),this.$ace.setOption("wrap","free"),this.$ace.setOption("scrollPastEnd",!0),this.$ace.setHighlightActiveLine(!1),this.$ace.session.setUseSoftTabs(!0),this.$ace.$blockScrolling=1/0,this},setToolbar:function(){var items,$group,groups=this.options.items.split(",-,"),$tools=$("<div/>"),self=this;this.options.extraItems&&groups.splice(-1,0,this.options.extraItems);var isMac=Util.isMac(),tools=this.getToolbarHandlers();for(var i in groups){items=groups[i].split(","),$group=$("<div/>").addClass("thinkeditor-tools-group").appendTo($tools);for(var j in items)if(items[j]){var hint=this.lang[items[j]];tools[items[j]]&&tools[items[j]].bindKey&&(hint+=isMac&&tools[items[j]].bindKey.mac?" ("+tools[items[j]].bindKey.mac.toUpperCase()+")":" ("+(tools[items[j]].bindKey.win?tools[items[j]].bindKey.win.toUpperCase():tools[items[j]].bindKey.toUpperCase())+")"),$("<a/>").addClass("hint--bottom "+items[j]).attr({href:"javascript:;","data-hint":hint}).data("name",items[j]).append("<i>").appendTo($group)}}return $tools.addClass("thinkeditor-tools").prependTo(this.$editor),this.toolbar=$tools,$tools.on("click",".thinkeditor-tools-group a:not([disabled])",function(event){event.stopPropagation(),tools[$(this).data("name")].exec.call(self)}),$.each(tools,function(k,v){if(v.init&&v.init.call(self),v.bindKey){v.name=k;var exec=v.exec;v.exec=function(){return v.markdown&&"markdown"!=self.$mode?!1:void exec.call(self)},self.addCommand(v)}}),this.$ace.getSession().on("changeMode",function(){for(var i in tools)tools[i].markdown&&("markdown"!=self.$mode?self.getToolbar(i).attr("disabled","disabled"):self.getToolbar(i).removeAttr("disabled"))}),this},getToolbarHandlers:function(){return $.extend(editor.toolbarHandlers,this.options.tools||{})},insert:function(text){var start,_start,end,length,range=this.$ace.getSelectionRange(),_text=this.$ace.session.getTextRange(range),line=0;this.$ace.focus();var row=this.$ace.getSelectionRange().end.row;if(this.$ace.isRowVisible(row)||this.$ace.renderer.scrollToLine(row),arguments.length>1)if(start=arguments[0],end=arguments[1],arguments[2]){text=_text.split("\n"),length=_text.length;for(var i in text)length&&!$.trim(text[i])||(_start=start.replace("{$line}",++line).replace("{$i}",i),text[i]=_start+text[i]+end);this.$ace.insert(text.join("\n")),length||(range={start:{row:range.start.row,column:range.start.column+start.length},end:{row:range.start.row,column:range.start.column+start.length}},this.$ace.getSelection().setSelectionRange(range))}else this.$ace.insert(start+_text+end);else this.$ace.insert(text)},getValue:function(){return this.$ace.session.getValue()},setValue:function(content){this.$ace.session.setValue(content),this.$ace.focus()},addCommand:function(command){this.$ace.commands.addCommand(command)},getToolbar:function(name){var $toolbar=this.toolbar;return name?$toolbar.find(".thinkeditor-tools-group ."+name):$toolbar},syncScroll:function(){var self=this;return this.$ace.session.on("changeScrollTop",function(){var contentDom=self.$ace.renderer.scrollBarV.element,scrollTop=self.$ace.renderer.getScrollTop()/(contentDom.scrollHeight-contentDom.offsetHeight)*(self.preview[0].scrollHeight-self.preview[0].offsetHeight);self.preview.scrollTop(scrollTop)}),this},setMode:function(mode){mode!=this.$mode&&(this.$mode=mode,this.$ace.getSession().setMode("ace/mode/"+mode))}},editor.fn.init.prototype=editor.fn,editor.toolbarHandlers={undo:{bindKey:{win:"ctrl+z",mac:"command+z"},exec:function(){this.$ace.undo(!0)},init:function(){var self=this;this.getToolbar("undo").attr("disabled","disabled"),this.$ace.on("change",function(){setTimeout(function(){var undoManager=self.$ace.session.getUndoManager();undoManager.hasUndo()?self.getToolbar("undo").removeAttr("disabled"):self.getToolbar("undo").attr("disabled","disabled")},0)})}},redo:{bindKey:{win:"ctrl+y",mac:"command+y"},exec:function(){this.$ace.redo(!0)},init:function(){var self=this;this.getToolbar("redo").attr("disabled","disabled"),this.$ace.on("change",function(){setTimeout(function(){var undoManager=self.$ace.session.getUndoManager();undoManager.hasRedo()?self.getToolbar("redo").removeAttr("disabled"):self.getToolbar("redo").attr("disabled","disabled")},0)})}},h1:{bindKey:{win:"ctrl+1",mac:"command+1"},exec:function(){this.insert("# ","",!1)},markdown:!0},h2:{bindKey:{win:"ctrl+2",mac:"command+2"},exec:function(){this.insert("## ","",!1)},markdown:!0},h3:{bindKey:{win:"ctrl+3",mac:"command+3"},exec:function(){this.insert("### ","",!1)},markdown:!0},h4:{bindKey:{win:"ctrl+4",mac:"command+4"},exec:function(){this.insert("#### ","",!1)},markdown:!0},h5:{bindKey:{win:"ctrl+5",mac:"command+5"},exec:function(){this.insert("##### ","",!1)},markdown:!0},h6:{bindKey:{win:"ctrl+6",mac:"command+6"},exec:function(){this.insert("###### ","",!1)},markdown:!0},link:{bindKey:{win:"ctrl+l",mac:"command+l"},exec:function(){var $html,range=this.$ace.getSelectionRange(),text=this.$ace.session.getTextRange(range),editor=this;$html=$("<div/>").addClass("thinkeditor-plugin-link").html('<div class="w-form form-horizon dialog-form"><div class="form-item"><span class="form-label">链接地址</span><div class="form-target"><label class="w-text text-m"><input class="text-input" type="text" name="link" value=""  /></label></div></div><div class="form-item"><span class="form-label">链接标题</span><div class="form-target"><label class="w-text text-m"><input class="text-input" type="text" name="title" value="" /></label></div></div></div>');var $link=$html.find('[name="link"]'),$title=$html.find('[name="title"]');text.length&&$title.val(text),$.dialog.open($html,{title:this.lang["link-title"],onOpen:function(){$link.focus(),$link.val("http://")},onOk:function(){var link=$link.val();if("http://"===link)return void alert("请输入链接地址");var title=$title.val();title||(title=link);var str="["+title+"]("+link+")";editor.insert(str),this.close()}})},markdown:!0},image:{bindKey:{win:"ctrl+g",mac:"command+g"},exec:function(){var $file=$('<input type="file"/>'),editor=this;$file.attr("name",this.options.uploader.name||"images"),this.$editor.append($file.hide()),$file.click(),$file.on("change",function(){new uploader($file[0].files,editor.options.uploader,editor),$file.remove()})},init:function(){var self=this;$(this.$ace.renderer.textarea).on("paste",function(e){var file,clipboard=e.originalEvent.clipboardData,files=[];for(var i in clipboard.items)"file"==clipboard.items[i].kind&&(file=clipboard.items[i].getAsFile(),files.push(new File([file],"image.png",{type:clipboard.items[i].type})));files.length&&new uploader(files,self.options.uploader,self)})},markdown:!0},bold:{bindKey:{win:"ctrl+b",mac:"command+b"},exec:function(){this.insert("**","**",!0)},markdown:!0},italic:{bindKey:{win:"ctrl+i",mac:"command+i"},exec:function(){this.insert("*","*",!0)},markdown:!0},code:{bindKey:{win:"ctrl+d",mac:"command+d"},exec:function(){var range=this.$ace.getSelectionRange(),text=this.$ace.session.getTextRange(range);text.length?text.split("\n").length>1?this.insert("~~~\n","\n~~~",!1):this.insert("`","`",!1):0==range.start.column?this.insert("~~~\n","\n~~~",!0):this.insert("`","`",!0)},markdown:!0},ul:{bindKey:{win:"ctrl+u",mac:"command+u"},exec:function(){this.insert("* ","",!0)},markdown:!0},ol:{bindKey:{win:"ctrl+o",mac:"command+o"},exec:function(){this.insert("{$line}. ","",!0)},markdown:!0},blockquote:{bindKey:{win:"ctrl+q",mac:"command+q"},exec:function(){this.insert("> ","",!0)},markdown:!0},hr:{bindKey:{win:"ctrl+h",mac:"command+h"},exec:function(){this.insert("\n* * * * *\n","",!1)},markdown:!0},table:{exec:function(){var $html,self=this;$html=$("<div/>").addClass("thinkeditor-plugin-table").html('<div class="w-form form-horizon dialog-form"><div class="form-item"><span class="form-label">行</span><div class="form-target"><label class="w-text text-m"><input class="text-input" type="number" name="rows" value="2" step="1" min="2" max="10000" /></label></div></div><div class="form-item"><span class="form-label">列</span><div class="form-target"><label class="w-text text-m"><input class="text-input" type="number" name="columns" value="2" step="1" min="1" max="10000" /></label></div></div></div>'),$.dialog.open($html,{title:this.lang["table-title"],onOk:function(){var rows=parseInt($html.find('[name="rows"]').val()),columns=parseInt($html.find('[name="columns"]').val()),table="\n";if(rows>1&&columns>1)for(var i=1;rows>=i;i++)table+="|"+new Array(columns+1).join("    |")+"\n",1===i&&(table+="|"+new Array(columns+1).join(" -- |")+"\n");self.insert(table),this.close()}})},markdown:!0},fullscreen:{exec:function(){var $body=$("body");this.$editor.hasClass("thinkeditor-fullscreen")?($body.css("overflow",""),this.$editor.removeClass("thinkeditor-fullscreen"),this.getToolbar("fullscreen").removeClass("active")):($body.css("overflow","hidden"),this.$editor.addClass("thinkeditor-fullscreen"),this.getToolbar("fullscreen").addClass("active")),this.$ace.resize()}},preview:{exec:function(){this.$preview?(this.$editor.removeClass("thinkeditor-preview-active"),this.getToolbar("preview").removeClass("active"),this.$preview=!1):(this.$editor.addClass("thinkeditor-preview-active"),this.getToolbar("preview").addClass("active"),this.$preview=!0,this.setPreviewContent(this.getValue())),this.$ace.resize()},init:function(){var self=this,preview=!1;this.options.preview&&(this.$preview=!0,this.$editor.addClass("thinkeditor-preview-active"),this.getToolbar("preview").addClass("active"),this.$ace.resize(),preview=!0),this.$ace.getSession().on("changeMode",function(){"markdown"!=self.$mode?self.$preview&&(self.$editor.removeClass("thinkeditor-preview-active"),self.getToolbar("preview").removeClass("active"),self.$preview=!1,self.$ace.resize()):!self.$preview&&self.options.preview&&(self.$editor.addClass("thinkeditor-preview-active"),self.getToolbar("preview").addClass("active"),self.$preview=!0,self.setPreviewContent(self.getValue()),self.$ace.resize())})},markdown:!0},help:{exec:function(){window.open("http://help.kancloud.cn/41501")}}};var uploader=function(files,options,editor){this.data=new FormData,this.editor=editor,this.$progress=$("<span>图片上传中...</span>").addClass("thinkeditor-upload-progress"),this.options=options,this.upload(files)};return uploader.prototype={message:function(msg,status,callback){$.isFunction(callback)&&callback("error"==status?0:1,msg)},progress:function(progress){var $progress=this.$progress;switch(progress){case"start":$progress.text("0%"),this.editor.$editor.append($progress);break;case"end":$progress.remove();break;default:$progress.text(progress+"%")}},insert:function(imgs){var img,alt,range=this.editor.$ace.getSelectionRange(),_text=this.editor.$ace.session.getTextRange(range),text=[];for(var name in imgs)img=imgs[name],alt=_text.length?_text:"",text.push("!["+alt+"]("+img.src+")");this.editor.insert(text.join("\n"))},upload:function(files){var msg,self=this,xhr=new XMLHttpRequest,FILES=[];if(!xhr.upload)return msg="您的浏览器不支持AJAX上传文件！",void self.message(msg,"error",this.options.callback);for(var file,i=0;file=files[i];i++)if(file.type.match(/^image\/(?:png|jpeg|jpg|gif)$/))if(file.size>10485760)msg="忽略超过大小限制的文件："+file.name,self.message(msg,"error",this.options.callback);else{if(!(FILES.length<3)){msg="最多同时上传3个文件，",msg+="已忽略"+(files.length-i)+"个",self.message(msg,"error",this.options.callback);break}FILES.push(files[i])}else msg="忽略非图片文件："+file.name,self.message(msg,"error",this.options.callback);if(!FILES.length)return msg="没有可以上传的文件！",void self.message(msg,"error",this.options.callback);for(i in FILES)this.data.append(this.options.name+""+i,FILES[i]);this.addEvent(xhr.upload,"progress",function(event){var progress=Math.round(event.loaded/event.total);self.progress(progress)},!1),xhr.onreadystatechange=function(){var data;4==xhr.readyState&&(self.progress("end"),200==xhr.status?(data=$.parseJSON(xhr.responseText),data.status?self.insert(data.files):self.message(data.info,"error",self.options.callback)):self.message("文件上传失败！","error",self.options.callback))};var data=this.options.data;if($.isFunction(this.options.data)&&(data=this.options.data()),$.isPlainObject(data))for(var i in data)this.data.append(i,data[i]);this.progress("start"),xhr.open("POST",this.options.url,!0),xhr.setRequestHeader("X-Requested-With","XMLHttpRequest"),xhr.send(this.data)},addEvent:function(elm,evType,fn,useCapture){if(elm.addEventListener)return elm.addEventListener(evType,fn,useCapture||!1),!0;if(elm.attachEvent){var r=elm.attachEvent("on"+evType,fn);return r}elm["on"+evType]=fn}},editor}),define("common/module/order",function(require){var Template=require("common/extend/template");return Class({_options:{type:"",title:"",infoTpl:"",coin:0,coupon:!1,price:0,style:"",data:{}},price:0,coupon_price:0,initial:function(options){var self=this;this.options=$.extend({},this._options,options),this.createTemp(),this.freshPrice(),this.options.coin&&this.useCoinEle.change(function(){self.freshPrice()}),this.options.coupon&&$("input[name=coupon]",this.wrapEle).on("keyup input propertychange blur",function(){var $this=$(this);return self.coupon_code=$(this).val(),8!==self.coupon_code.length?(self.coupon_code.length>0?($this.next().text("无效的优惠券"),$this.parents(".form-item").addClass("has-error")):$this.parents(".form-item").removeClass("has-error"),self.coupon_code="",self.coupon_price=0,void self.freshPrice()):void $.post("/order/coupon",{code:self.coupon_code,price:self.price,type:self.options.type},function(result){result.status?(self.coupon_price=result.info,$this.parents(".form-item").removeClass("has-error")):(self.coupon_code="",self.coupon_price=0,$this.next().text(result.info),$this.parents(".form-item").addClass("has-error")),self.freshPrice()})}),this.options.onInit&&this.options.onInit.call(this),this.payBtnEle.click(function(){var that=$(this);if(!that.attr("disabled")){that.attr("disabled","disabled"),that.children(".btn-input").text("正在创建订单...");var data;data=$.isFunction(self.options.data)?self.options.data.call(self):self.options.data,data.type=self.options.type,$.post("/order",data,function(result){if(result.status){var qr_url="/pay",pay_data={coupon_code:self.coupon_code,order_id:result.info,pay_type:self.wrapEle.find("[name=pay_type]:checked").val(),use_coin:self.options.coin&&self.useCoinEle.is(":checked")?1:0};$.get(qr_url,pay_data,function(result){if("object"==typeof result)$.dialog.error(result.info),that.removeAttr("disabled"),that.children(".btn-input").text("确认支付");else if("success"==result)$.dialog.success("支付成功",function(){$.isFunction(self.options.onSuccess)&&self.options.onSuccess.call(self)});else{"wx_pub_qr"==pay_data.pay_type?self.wrapEle.html('<div class="qrcode">'+result+"<p>使用微信扫一扫支付</p></div>"):window.open("/pay?order_id="+pay_data.order_id+"&pay_type="+pay_data.pay_type);var timer=setInterval(function(){$.get("/order/check",{order_id:pay_data.order_id},function(result){result.status&&(clearInterval(timer),self.options.onSuccess.call(self))})},2e3)}})}else $.dialog.error(result.info),that.removeAttr("disabled"),that.children(".btn-input").text("确认支付")})}}),$.dialog(this.wrapEle,{title:this.options.title})},freshPrice:function(){$.isFunction(this.options.price)?this.price=this.options.price.call(this):this.price=this.options.price;var pay_price=this.price-this.coupon_price;this.options.coin&&this.useCoinEle.is(":checked")&&(pay_price-=this.options.coin),0>pay_price&&(pay_price=0),this.payPriceEle.html((pay_price/100).toFixed(2)+"元")},createTemp:function(){var self=this,_html=['<div class="order-from <%=style%>">','<form class="w-form form-horizon dialog-form" method="post">',"<%=#infoTpl%>","<%if (coupon){%>",'<div class="form-item">','<span class="form-label"></span>','<div class="form-target"><a href="javascript:;" class="w-static use-coupon">使用优惠券</a> </div>',"</div>",'<div class="form-item" style="display: none;">','<span class="form-label">优惠券：</span>','<div class="form-target coupon">','<label class="w-text text-m">','<input class="text-input coupon-input" type="text" name="coupon" />','<span class="field-msg"></span></label>','<label class="w-select select-m create">','　<select name="select-coupon" class="select-input select-coupon" id="select-coupon">','<option value="">可用优惠券</option>',"</select>","</label>","</div>","</div>","<%}%>","<%if (coin>0){%>",'<div class="form-item">','<span class="form-label">使用云币：</span>','<div class="form-target">','<label class="w-radio" style=" width: 150px; margin-right: 5px;">','<input class="radio-input" type="checkbox" name="use_coin" value="1" checked="checked" />','<span class="radio-text">可用 ¥<%=coin%></span>',"</label>","</div>","</div>","<%}%>",'<div class="form-item">','<span class="form-label">实付款：</span>','<div class="form-target">','<span class="w-static pay_price">0元</span>',"</div>","</div>",'<div class="form-item">','<span class="form-label">支付方式：</span>','<div class="">','<label class="w-radio">','<input class="radio-input" type="radio" name="pay_type" value="wx_pub_qr" checked="checked" />','<span class="radio-text">微信支付</span>',"</label>","</div>","</div>",'<div class="pay-btn">','<a href="javascript:;" class="btn-success btn-l w-btn"><span class="btn-input">立即支付</span></a>',"</div>","</form></div>"].join("");this.wrapEle=$(Template.parseTemp(_html,{coin:(this.options.coin/100).toFixed(2),infoTpl:this.options.infoTpl,style:this.options.style,coupon:this.options.coupon})),this.wrapEle.find(".use-coupon").click(function(){$(this).parents(".form-item").next().show(),$(this).parents(".form-item").remove(),self.options.coupon&&$.get("/autocomplete/coupon",{type:self.options.type}).success(function(data){if(data.length){$(".user-coupon-list").html("");for(var i in data)$(".select-coupon").append('<option value="'+data[i]+'">'+data[i]+"</option>")}else $(".select-coupon").append('<option value="">无可用优惠券</option>');$(".select-coupon").change(function(){$("[name=coupon]").val($(this).val()),$("[name=coupon]").blur()}),$("[name=coupon]").keyup(function(){""==$(this).val()?$(".select-coupon").show():$(".select-coupon").hide()})})}),this.payPriceEle=this.wrapEle.find(".pay_price"),this.useCoinEle=this.wrapEle.find("[name=use_coin]"),this.payBtnEle=this.wrapEle.find(".pay-btn .w-btn")},instantiation:!1})}),define("common/module/sharing",function(){return Class({options:{url:location.href,title:null,summary:null,cover:null},initial:function(options){var self=this;this.options=$.extend({},this.options,options),$(document).on("click","a[data-sharing],button[data-sharing]",function(e){e&&e.preventDefault();var type=$(this).data("sharing");self.social[type](self.options)})},config:function(options){this.options=$.extend({},this.options,options)},social:{qq:function(options){var param=["url="+options.url,"desc=刚看到这篇文章不错，推荐给你看看～","summary="+options.summary,"site=看云","title="+options.title];options.cover&&param.push("pics="+encodeURIComponent(options.cover)),param=param.join("&"),window.open("http://connect.qq.com/widget/shareqq/index.html?"+param)},wechat:function(options){$.dialog('<img src="http://www.kancloud.cn/qrcode?url='+options.url+'" width="300" height="300" style="margin:15px;" />',{title:"分享到微信",cache:!0})},weibo:function(options){var param=["url="+options.url,"title=【"+options.title+"】"+options.summary];options.cover&&param.push("pic="+encodeURIComponent(options.cover)),param=param.join("&"),window.open("http://service.weibo.com/share/share.php?"+param)}},instantiation:!1})}),define("common/module/tagCreate",function(require,exports,module){var Template=require("common/extend/template");return Class({_options:{appendEle:$(),data:null,maxNumber:null,maxEnterLength:7,hiddenName:"tag",itemTpl:['<span class="text"><%=name%></span>'].join(""),onAdd:null,onDel:null,onRepeat:null,onChange:null,onCreate:null,onMaxLimit:null},tagList:[],wranTimer:null,wranEle:$(),initial:function(options){var self=this;this.options=$.extend({},this._options,options),this.appendEle=this.options.appendEle.addClass("m-tag-create"),this.createEle=this.createHtml(),this.tagListEle=this.createEle.filter(".tag-list"),this.enterEle=this.createEle.filter(".tag-enter"),this.hiddenEle=this.createEle.filter(".tag-hidden"),this.setTpl(this.options.itemTpl),this.setMaxNumber(this.options.maxNumber),this.setMaxEnterLength(this.options.maxEnterLength);var _prevValue=this.enterEle.val();this.enterEle.keydown(function(event){return 32!=event.which&&13!=event.which||!_prevValue?void 0:(self.addItem(_prevValue),_prevValue="",$(this).val(""),!1)}).keyup(function(event){var _value=$.trim($(this).val());return Util.cnstrlen(_value)>self._maxEnter?(_value=_prevValue,$(this).val(_value),!1):($(this).val(_value),void(_prevValue=_value))}).blur(function(){var _value=$.trim($(this).val());_value&&(self.addItem($(this).val()),$(this).val(""))}),this.appendEle.click(function(){self.enterEle.focus()}),this.addItem(this.options.data),this.createEle.appendTo(this.appendEle),$(document).trigger("onCompatible",["placeholder",this.enterEle]),$.isFunction(this.options.onCreate)&&this.options.onCreate.call(this)},addItem:function(data){$.isFunction(data)&&(data=data.call(this));var _self=this,_data=$.isArray(data)?data:[data],_text=[];if(null===this._maxNumber||this.tagList.length<this._maxNumber){for(var i=0;i<_data.length;i++)if(_data[i]){var _name=_data[i].replace(/\s/g,"");if(!this.isRepeat(_name)){var _item=$(Template.parseTemp(this._itemTpl,{name:_name}));_item.find(".close").click(function(item){return function(){_self.delItem(item)}}(_item)),this.tagList.push(_item),this.tagListEle.append(_item),$.isFunction(this.options.onItem)&&this.options.onItem.call(this,_item)}}for(var i=0;i<this.tagList.length;i++)_text.push(this.tagList[i].find(".text").text());this.hiddenEle.val(_text.join(",")),$.isFunction(this.options.onChange)&&this.options.onChange.call(this)}else $.isFunction(this.options.onMaxLimit)&&this.options.onMaxLimit.call(this,this._maxNumber)},delItem:function(item){var _text=[],_index=this.inItem(item);if(_index>=0){item.remove(),this.tagList.splice(_index,1);for(var i=0;i<this.tagList.length;i++)_text.push(this.tagList[i].find(".text").text());this.hiddenEle.val(_text.join(",")),$.isFunction(this.options.onChange)&&this.options.onChange.call(this),$.isFunction(this.options.onDel)&&this.options.onDel.call(this,_index)}},inItem:function(item){for(var i=0;i<this.tagList.length;i++)if(this.tagList[i].is(item))return i;return-1},isRepeat:function(text){for(var _self=this,_step=0,i=0;i<this.tagList.length;i++)if(this.tagList[i].find(".text").text()==text)return clearTimeout(this.wranTimer),this.wranEle.removeClass("tag-wran"),this.wranTimer=setInterval(function(){6>_step?_self.tagList[i].toggleClass("tag-wran"):clearInterval(_self.wranTimer),++_step},200),this.wranEle=this.tagList[i],$.isFunction(this.options.onRepeat)&&this.options.onRepeat.call(this,this.tagList[i],text),!0;return!1},setTpl:function(tpl){return this._itemTpl='<span class="tag-item">'+tpl+'<b class="close icon-cross"></b></span>',this},setMaxNumber:function(number){return"number"==$.type(number)?this._maxNumber=parseInt(number,10):this._maxNumber=null,this},setMaxEnterLength:function(number){return"number"==$.type(number)?this._maxEnter=parseInt(number,10):this._maxEnter=null,this},createHtml:function(){var _html=['<span class="tag-list"></span>','<input class="tag-enter" type="text" placeholder="点击空白处输入标签" />','<input class="tag-hidden" type="hidden" name="'+this.options.hiddenName+'" />'].join("");return $(_html)},instantiation:!1})});
//# sourceMappingURL=app.min.js.map